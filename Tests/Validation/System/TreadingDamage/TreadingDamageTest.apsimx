{
  "$type": "Models.Core.Simulations, Models",
  "Version": 204,
  "Name": "Simulations",
  "ResourceName": null,
  "Children": [
    {
      "$type": "Models.Memo, Models",
      "Text": "# Treading Effects Test\n\nVal Snow and Mike Dodd (New Zealand Bioeconomy Science Institute) and Dean Holzworth (CSIRO, Australia)\n\n(Last updated 30 October 2025)\n\n\nThe heavier the cow LW the greater the treading effect and reduction in pasture production. \n\nThis test is against a benchmark loaded as 'observed' data so the statics should look perfect.",
      "Name": "Explanation",
      "ResourceName": null,
      "Children": [],
      "Enabled": true,
      "ReadOnly": false
    },
    {
      "$type": "Models.Storage.DataStore, Models",
      "CustomFileName": null,
      "Name": "DataStore",
      "ResourceName": null,
      "Children": [
        {
          "$type": "Models.PostSimulationTools.ExcelInput, Models",
          "FileNames": [
            "TreadingDamageTestOBS.xlsx"
          ],
          "SheetNames": [
            "Benchmark"
          ],
          "Name": "ExcelInput",
          "ResourceName": null,
          "Children": [],
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.PostSimulationTools.PredictedObserved, Models",
          "PredictedTableName": "Report",
          "ObservedTableName": "Benchmark",
          "FieldNameUsedForMatch": "Liveweight",
          "FieldName2UsedForMatch": null,
          "FieldName3UsedForMatch": null,
          "FieldName4UsedForMatch": null,
          "AllColumns": false,
          "Name": "PredictedObserved",
          "ResourceName": null,
          "Children": [],
          "Enabled": true,
          "ReadOnly": false
        }
      ],
      "Enabled": true,
      "ReadOnly": false
    },
    {
      "$type": "Models.Factorial.Experiment, Models",
      "DisabledSimNames": null,
      "Name": "GrazingExample",
      "ResourceName": null,
      "Children": [
        {
          "$type": "Models.Factorial.Factors, Models",
          "Name": "Factors",
          "ResourceName": null,
          "Children": [
            {
              "$type": "Models.Factorial.Factor, Models",
              "Specification": "[TreadingDamage].Script.CowLiveweight = 0, 250, 500, 750, 1000, 1500",
              "Name": "LW",
              "ResourceName": null,
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            }
          ],
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Core.Simulation, Models",
          "Descriptors": null,
          "Name": "Base",
          "ResourceName": null,
          "Children": [
            {
              "$type": "Models.Clock, Models",
              "Start": "2000-07-01T00:00:00",
              "End": "2003-06-30T00:00:00",
              "Name": "Clock",
              "ResourceName": null,
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Climate.Weather, Models",
              "ConstantsFile": null,
              "FileName": "%root%/Examples/WeatherFiles/NZ_Hamilton.met",
              "ExcelWorkSheetName": "",
              "Name": "Weather",
              "ResourceName": null,
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.MicroClimate, Models",
              "a_interception": 0.0,
              "b_interception": 1.0,
              "c_interception": 0.0,
              "d_interception": 0.0,
              "SoilHeatFluxFraction": 0.4,
              "MinimumHeightDiffForNewLayer": 0.0,
              "NightInterceptionFraction": 0.5,
              "ReferenceHeight": 2.0,
              "Name": "MicroClimate",
              "ResourceName": "MicroClimate",
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Soils.Arbitrator.SoilArbitrator, Models",
              "Name": "SoilArbitrator",
              "ResourceName": null,
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.ForageDigestibility.Forages, Models",
              "Parameters": [
                {
                  "$type": "Models.ForageDigestibility.ForageMaterialParameters, Models",
                  "Name": "SurfaceOrganicMatter.Residue",
                  "LiveDigestibility": "0.7",
                  "DeadDigestibility": "0.3",
                  "LiveFractionConsumable": 0.0,
                  "DeadFractionConsumable": 0.0,
                  "LiveMinimumBiomass": 0.0,
                  "DeadMinimumBiomass": 0.0
                },
                {
                  "$type": "Models.ForageDigestibility.ForageMaterialParameters, Models",
                  "Name": "AGPRyegrass.Leaf",
                  "LiveDigestibility": "FromModel",
                  "DeadDigestibility": "FromModel",
                  "LiveFractionConsumable": 1.0,
                  "DeadFractionConsumable": 1.0,
                  "LiveMinimumBiomass": 25.0,
                  "DeadMinimumBiomass": 0.0
                },
                {
                  "$type": "Models.ForageDigestibility.ForageMaterialParameters, Models",
                  "Name": "AGPRyegrass.Stem",
                  "LiveDigestibility": "FromModel",
                  "DeadDigestibility": "FromModel",
                  "LiveFractionConsumable": 1.0,
                  "DeadFractionConsumable": 1.0,
                  "LiveMinimumBiomass": 10.0,
                  "DeadMinimumBiomass": 0.0
                },
                {
                  "$type": "Models.ForageDigestibility.ForageMaterialParameters, Models",
                  "Name": "AGPRyegrass.Stolon",
                  "LiveDigestibility": "FromModel",
                  "DeadDigestibility": "FromModel",
                  "LiveFractionConsumable": 1.0,
                  "DeadFractionConsumable": 1.0,
                  "LiveMinimumBiomass": 0.0,
                  "DeadMinimumBiomass": 0.0
                },
                {
                  "$type": "Models.ForageDigestibility.ForageMaterialParameters, Models",
                  "Name": "AGPWhiteClover.Leaf",
                  "LiveDigestibility": "FromModel",
                  "DeadDigestibility": "FromModel",
                  "LiveFractionConsumable": 1.0,
                  "DeadFractionConsumable": 1.0,
                  "LiveMinimumBiomass": 15.0,
                  "DeadMinimumBiomass": 0.0
                },
                {
                  "$type": "Models.ForageDigestibility.ForageMaterialParameters, Models",
                  "Name": "AGPWhiteClover.Stem",
                  "LiveDigestibility": "FromModel",
                  "DeadDigestibility": "FromModel",
                  "LiveFractionConsumable": 1.0,
                  "DeadFractionConsumable": 1.0,
                  "LiveMinimumBiomass": 5.0,
                  "DeadMinimumBiomass": 0.0
                },
                {
                  "$type": "Models.ForageDigestibility.ForageMaterialParameters, Models",
                  "Name": "AGPWhiteClover.Stolon",
                  "LiveDigestibility": "FromModel",
                  "DeadDigestibility": "FromModel",
                  "LiveFractionConsumable": 1.0,
                  "DeadFractionConsumable": 1.0,
                  "LiveMinimumBiomass": 5.0,
                  "DeadMinimumBiomass": 0.0
                }
              ],
              "Name": "Forages",
              "ResourceName": null,
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Summary, Models",
              "Verbosity": 100,
              "Name": "Summary",
              "ResourceName": null,
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Core.Zone, Models",
              "Area": 1.0,
              "Slope": 0.0,
              "AspectAngle": 0.0,
              "Altitude": 50.0,
              "CanopyType": null,
              "Name": "Field",
              "ResourceName": null,
              "Children": [
                {
                  "$type": "Models.AgPasture.SimpleGrazing, Models",
                  "GrazingRotationType": 0,
                  "SimpleGrazingFrequencyString": "21",
                  "SimpleMinGrazable": 0.0,
                  "SimpleGrazingResidual": 1500.0,
                  "PreGrazeDMArray": [
                    1000.0,
                    1000.0,
                    1000.0,
                    1000.0,
                    1000.0,
                    1000.0,
                    1000.0,
                    1000.0,
                    1000.0,
                    1000.0,
                    1000.0,
                    1000.0
                  ],
                  "PostGrazeDMArray": [
                    2000.0,
                    2000.0,
                    2000.0,
                    2000.0,
                    2000.0,
                    2000.0,
                    2000.0,
                    2000.0,
                    2000.0,
                    2000.0,
                    2000.0,
                    2000.0
                  ],
                  "FlexibleExpressionForTimingOfGrazing": null,
                  "FlexibleGrazePostDM": 0.0,
                  "MaximumRotationLengthArray": null,
                  "MinimumRotationLengthArray": null,
                  "NoGrazingStartString": null,
                  "NoGrazingEndString": null,
                  "IsCutAndCarry": false,
                  "FractionClippingsReturned": 0.0,
                  "FractionIntakeNToAnimal": [
                    0.0
                  ],
                  "DungNConc": 2.6,
                  "FractionOfDungUrineOffPaddock": [
                    0.3
                  ],
                  "DepthUrineIsAdded": 150.0,
                  "ShowAdvancedExcretaOptions": false,
                  "SendDungElsewhere": 0.0,
                  "SendUrineElsewhere": 0.0,
                  "UsePatching": false,
                  "PseudoPatches": true,
                  "ZoneCount": 25,
                  "UrineReturnPattern": 2,
                  "PseudoRandomSeed": 666,
                  "MaxEffectiveNConcentration": 3.5,
                  "FractionPopulationDecline": 0.0,
                  "TramplingOn": false,
                  "MaximumPropLitterMovedToSoil": 0.1,
                  "PastureConsumedAtMaximumRateOfLitterRemoval": 1200.0,
                  "Name": "SimpleGrazing",
                  "ResourceName": null,
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Manager, Models",
                  "CodeArray": [
                    "using Newtonsoft.Json;",
                    "using APSIM.Shared.Utilities;",
                    "using Models.Utilities;",
                    "using Models.Soils;",
                    "using Models.PMF;",
                    "using Models.Core;",
                    "using System;",
                    "using System.Linq;",
                    "using Models.AgPasture;",
                    "using System.Diagnostics;",
                    "",
                    "namespace Models",
                    "{",
                    "\t[Serializable]",
                    "\tpublic class Script : Model",
                    "\t{",
                    "\t\t[Link] private Clock clock;",
                    "\t\t",
                    "\t\t[Link] private ISummary summary;",
                    "\t\t[Link] private SimpleGrazing simpleGrazing;",
                    "\t\t[Link] private IPhysical physical;",
                    "\t\t[Link] private Swim3 swim3;",
                    "\t\t",
                    "\t\t",
                    "        [Separator(\"This Manager must be placed after SimpleGrazing. See the tutorial for information about this manager.\")]",
                    "        [Separator(\"Chose if the damage will be based on grazing events or on specified days\")]",
                    "",
                    "\t\t[Description(\"Damage based on grazing events (true/ticked)? The alternative (false) will be based on specifed days\")]",
                    "\t\tpublic bool GrazingMode {get; set;}",
                    "\t\t",
                    "\t\t[Description(\"Damageable grazing on the same day(s) each year? If no, then must include the year below\")]",
                    "\t\tpublic bool EachYear {get; set;}",
                    "\t\t",
                    "\t\t[Description(\"Dates for one or more grazing pressure events (dd-mmm or dd-mmm-yyyy)\")]",
                    "\t\tpublic string[] Dates {get; set;}",
                    "\t\t",
                    "        [Separator(\"Stock characteristics\")]",
                    "\t\t",
                    "\t\t[Description(\"Cow liveweight (kg)\")]",
                    "\t\tpublic double CowLiveweight {get; set;}",
                    "",
                    "\t\t[Description(\"Assumed stocking density by month (cows /ha /24-hours)\")]",
                    "\t\tpublic double[] CowStockingDensityByMonth {get; set;}",
                    " ",
                    "\t\tpublic double CowStockingDensity {get; set;}",
                    "",
                    "",
                    "",
                    "        [Separator(\"Calculation of the damage effect from grazing pressure\")]",
                    "",
                    "\t\t[Description(\"Multiplier on grazing pressure (*10^-3) - see the documentation for an explanation\")]",
                    "\t\tpublic double PressureMultiplier {get; set;}",
                    "\t\t",
                    "\t\t[Description(\"Damage ryegrass?\")]",
                    "\t\tpublic bool DamageRyegrass {get; set;}",
                    "\t\t",
                    "\t\t[Description(\"Damage clover?\")]",
                    "\t\tpublic bool DamageClover {get; set;}",
                    "\t\t",
                    "\t\t[Description(\"Damage soil?\")]",
                    "\t\tpublic bool DamageSoil {get; set;}",
                    "\t\t",
                    "\t\t",
                    "",
                    "        [Separator(\"Effect of the damage on the plants. Damage is 1:1 on the GLFGeneric.\")]",
                    "",
                    "\t\t[Description(\"Grass species\")] public PastureSpecies Grass {get; set;}",
                    "",
                    "\t\t[Description(\"Recovery rate for grass (/d)\")]",
                    "\t\tpublic double RecoveryRateGrass {get; set;}",
                    "",
                    "\t\t[Description(\"Clover species\")] public PastureSpecies Clover {get; set;}",
                    "\t\t",
                    "\t\t[Description(\"Recovery rate for clover (/d)\")]",
                    "\t\tpublic double RecoveryRateClover {get; set;}",
                    "",
                    "        [Separator(\"Effect of the damage on the soil properties\")]",
                    "",
                    "\t\t[Description(\"Depth in the soil before damage starts decreasing (mm)\")]",
                    "\t\tpublic double DepthDamage100Soil {get; set;}",
                    "",
                    "\t\t[Description(\"Depth in the soil where damage is <5% of surface damage (mm)\")]",
                    "\t\tpublic double DepthDamage005Soil {get; set;}",
                    "",
                    "\t\t[Description(\"Recovery rate for soil - applies to both Ks and macroporosity (/d)\")]",
                    "\t\tpublic double RecoveryRateSoil {get; set;}",
                    "",
                    "",
                    "",
                    "        // outputs",
                    "\t\tpublic double DamageUnitsGrass {get; set;}",
                    "\t\tpublic double DamageUnitsClover {get; set;}",
                    "\t\tpublic double DamageUnitsSoil {get; set;}",
                    "\t\t",
                    "\t\tpublic double[] MaxPossChangeMacroporosity {get; set;}",
                    "\t\tpublic double[] MaxPossChangeConductivity {get; set;}",
                    "\t\tpublic double[] DepthFunctionForDamage {get; set;}",
                    "\t\t",
                    "\t\tpublic double GrazingPressure {get; set;}",
                    "\t\tpublic double EffectiveGrazingPressure {get; set;}",
                    "\t\tpublic double WaterFactor {get; set;}",
                    "\t\tpublic double TreadingEffect {get; set;}",
                    "\t\tpublic double[] DepthDamageFunction {get; set;}",
                    "\t\t",
                    "\t\tpublic double MinimumMacroporosity {get; set;}",
                    "\t\t",
                    "\t\tpublic double[] UndamagedKSat {get; set;}",
                    "\t\tpublic double[] UndamagedMacroporosity {get; set;}",
                    "\t\tpublic double[] UndamagedSAT {get; set;}",
                    "\t\tpublic double[] UndamagedDUL {get; set;}",
                    "\t\t",
                    "\t\t",
                    "        [EventSubscribe(\"StartOfSimulation\")]",
                    "        private void OnStartOfSimulation(object sender, EventArgs e)",
                    "\t\t{",
                    "\t\t\t//Debugger.Break();",
                    "",
                    "            MaxPossChangeConductivity = new double[physical.Thickness.Length];",
                    "            MaxPossChangeMacroporosity = new double[physical.Thickness.Length];",
                    "            DepthFunctionForDamage = new double[physical.Thickness.Length];",
                    "            DepthDamageFunction = new double[physical.Thickness.Length];",
                    "",
                    "            MinimumMacroporosity = 0.02;",
                    "            UndamagedSAT = (double[]) physical.SAT.Clone();",
                    "            UndamagedDUL = (double[]) physical.DUL.Clone();",
                    "            UndamagedKSat = (double[]) physical.KS.Clone();",
                    "",
                    "\t\t\t",
                    "\t\t\t// get the maximum possible changes in soil properties by depth",
                    "            for (int i = 0; i < physical.Thickness.Length; i++)",
                    "            {",
                    "                // Assume that the minimum Ks is twice the K at DUL",
                    "                MaxPossChangeConductivity[i] = physical.KS[i] - 2.0 * swim3.KDul;  // we are assuming that the change in soil physical propoerties is above DUL",
                    "",
                    "                // Macroporosity is taken as the pore space from Saturation to DUL  ",
                    "                MaxPossChangeMacroporosity[i] = physical.SAT[i] - physical.DUL[i] - MinimumMacroporosity;  ",
                    "",
                    "                // set up the depth function for damage to the soil",
                    "                DepthFunctionForDamage[i] = Math.Min(1.0,Math.Max(0.0,1.0 - (DepthDamage005Soil - physical.DepthMidPoints[i])/(DepthDamage005Soil-DepthDamage100Soil)));",
                    "                DepthFunctionForDamage[i] = Math.Exp(-4.0 * DepthFunctionForDamage[i]);",
                    "                if (DepthFunctionForDamage[i] < 0.02)",
                    "                    DepthFunctionForDamage[i] = 0.0;",
                    "            }",
                    "\t\t}",
                    "",
                    "\t\t",
                    "\t\t[EventSubscribe(\"DoManagement\")]",
                    "\t\tprivate void OnDoManagement(object sender, EventArgs e)",
                    "\t\t{",
                    "",
                    "            // water factor for the damage effect",
                    "            WaterFactor = 0.0;",
                    "            double SatTo100mm = 0.0;",
                    "            double DulTo100mm = 0.0;",
                    "            double ThetaTo100mm = 0.0;",
                    "            for (int i = 0; physical.DepthMidPoints[i] < DepthDamage100Soil; i++)",
                    "            {",
                    "                SatTo100mm += physical.SATmm[i];",
                    "                DulTo100mm += physical.DULmm[i];",
                    "                ThetaTo100mm += swim3.SWmm[i];",
                    "            }",
                    "            WaterFactor += Math.Max(0.0, (ThetaTo100mm - DulTo100mm) / (SatTo100mm - DulTo100mm));",
                    "",
                    "            // do some damage if there is a grazing event or a specified day",
                    "            if ((simpleGrazing.GrazedToday && GrazingMode) || (OnApplicationDate()  && !GrazingMode))",
                    "            {",
                    "                // calculate the grazing pressures",
                    "\t\t        CowStockingDensity = CowStockingDensityByMonth[clock.Today.Month - 1]; ",
                    "                GrazingPressure = CowLiveweight * CowStockingDensity * 24.0 / 1000.0;   // t LW /ha /hour",
                    "                EffectiveGrazingPressure = GrazingPressure * WaterFactor;",
                    "                TreadingEffect = 1.0 - Math.Exp(EffectiveGrazingPressure * PressureMultiplier / 1000.0);",
                    "",
                    "                // finally add this into the dynamic damage units ",
                    "    \t        if (DamageRyegrass)",
                    "        \t\t\tDamageUnitsGrass = Math.Max(Math.Min(DamageUnitsGrass + TreadingEffect, 1.0), 0.0);",
                    "    \t\t\tif (DamageClover)",
                    "        \t\t\tDamageUnitsClover = Math.Max(Math.Min(DamageUnitsClover + TreadingEffect, 1.0), 0.0);",
                    "    \t\t\tif (DamageSoil)",
                    "    \t\t\t{",
                    "    \t\t\t    DamageUnitsSoil = Math.Max(Math.Min(DamageUnitsSoil + TreadingEffect, 1.0), 0.0);",
                    "                       for (int i = 0; i < physical.Thickness.Length; i++)",
                    "                           DepthDamageFunction[i] = DamageUnitsSoil * DepthFunctionForDamage[i];",
                    "                }",
                    "",
                    "        \t\t// now have the damage units affect the plants and soil",
                    "        \t\tGrass.GlfGeneric = 1.0 - DamageUnitsGrass;",
                    "    \t\t\tClover.GlfGeneric = 1.0 - DamageUnitsClover;",
                    "            \tfor (int i = 0; i < physical.Thickness.Length; i++)",
                    "                {",
                    "                    physical.KS[i] = UndamagedKSat[i] - MaxPossChangeConductivity[i] * DepthDamageFunction[i];",
                    "                    physical.DUL[i] = UndamagedDUL[i] + MaxPossChangeMacroporosity[i] * DepthDamageFunction[i];",
                    "                }",
                    "            }",
                    "            else  // add a test for some minimum level of damage?",
                    "            {",
                    "\t\t        // not a damage day so zero out the damaging variables",
                    "\t\t        CowStockingDensity = 0.0; ",
                    "                GrazingPressure = 0.0;",
                    "                EffectiveGrazingPressure = 0.0;",
                    "                TreadingEffect = 0.0;",
                    "",
                    "\t\t    \t// no recovery on the damage day so the recover sits here",
                    "    \t\t    DamageUnitsGrass -= DamageUnitsGrass * RecoveryRateGrass;",
                    "\t\t\t    DamageUnitsClover -= DamageUnitsClover * RecoveryRateClover;",
                    "\t\t\t    DamageUnitsSoil -= DamageUnitsSoil * RecoveryRateSoil;",
                    "\t\t\t\t",
                    "\t\t\t\tfor (int i = 0; i < physical.Thickness.Length; i++)",
                    "                    DepthDamageFunction[i] = DamageUnitsSoil * DepthFunctionForDamage[i];",
                    "",
                    "        \t\t// now have the damage units affect the plants and soil",
                    "        \t\tGrass.GlfGeneric = 1.0 - DamageUnitsGrass;",
                    "\t    \t\tClover.GlfGeneric = 1.0 - DamageUnitsClover;",
                    "            \tfor (int i = 0; i < physical.Thickness.Length; i++)",
                    "                {",
                    "                    physical.KS[i] = UndamagedKSat[i] - MaxPossChangeConductivity[i] * DepthDamageFunction[i];",
                    "                    physical.DUL[i] = UndamagedDUL[i] + MaxPossChangeMacroporosity[i] * DepthDamageFunction[i];",
                    "                }",
                    "",
                    "",
                    "            }",
                    "                ",
                    "\t\t}",
                    "\t\t",
                    "\t\t",
                    "        // Checks if today's date is one of the specified dates",
                    "        private bool OnApplicationDate()",
                    "        {",
                    "            if (EachYear)",
                    "                return Dates.Any(d => DateUtilities.DatesEqual(d, clock.Today));",
                    "            ",
                    "            DateTime[] dates = Dates.Select(d => DateTime.ParseExact(d, \"d-MMM-yyyy\", null)).ToArray();",
                    "            return dates.Any(d => SameDate(d, clock.Today));",
                    "        }",
                    "        ",
                    "        private bool SameDate(DateTime d1, DateTime d2)",
                    "        {",
                    "            return d1.Year == d2.Year && d1.DayOfYear == d2.DayOfYear;",
                    "        }",
                    "",
                    "",
                    "\t}",
                    "}"
                  ],
                  "Parameters": [
                    {
                      "Key": "GrazingMode",
                      "Value": "True"
                    },
                    {
                      "Key": "EachYear",
                      "Value": "True"
                    },
                    {
                      "Key": "Dates",
                      "Value": "1-jan"
                    },
                    {
                      "Key": "CowLiveweight",
                      "Value": "450"
                    },
                    {
                      "Key": "CowStockingDensityByMonth",
                      "Value": "100, 100, 100, 100, 100, 300, 300, 100, 100, 100, 100, 100"
                    },
                    {
                      "Key": "PressureMultiplier",
                      "Value": "-0.639471"
                    },
                    {
                      "Key": "DamageRyegrass",
                      "Value": "True"
                    },
                    {
                      "Key": "DamageClover",
                      "Value": "True"
                    },
                    {
                      "Key": "DamageSoil",
                      "Value": "True"
                    },
                    {
                      "Key": "Grass",
                      "Value": "[AGPRyegrass]"
                    },
                    {
                      "Key": "RecoveryRateGrass",
                      "Value": "0.015"
                    },
                    {
                      "Key": "Clover",
                      "Value": "[AGPWhiteClover]"
                    },
                    {
                      "Key": "RecoveryRateClover",
                      "Value": "0.015"
                    },
                    {
                      "Key": "DepthDamage100Soil",
                      "Value": "100"
                    },
                    {
                      "Key": "DepthDamage005Soil",
                      "Value": "250"
                    },
                    {
                      "Key": "RecoveryRateSoil",
                      "Value": "0.015"
                    }
                  ],
                  "Name": "TreadingDamage",
                  "ResourceName": null,
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Manager, Models",
                  "CodeArray": [
                    "using APSIM.Core;",
                    "using System;",
                    "using Models.Core;",
                    "using Models.Soils.Nutrients;",
                    "using Models.Soils;",
                    "using Models.PMF;",
                    "using APSIM.Shared.Utilities;",
                    "using System.Linq;",
                    "using Models.Interfaces;",
                    "",
                    "namespace Models",
                    "{",
                    "    [Serializable]",
                    "    public class Script : Model, IStructureDependency",
                    "    {",
                    "        [Link] private Clock clock;",
                    "        [Link] private Fertiliser fertiliser;",
                    "        [Link] private ISummary summary;",
                    "        [Link] private Soil soil;",
                    "        private Nutrient nutrient;",
                    "        private Nutrient soilN;",
                    "        [Link]",
                    "        private IPhysical soilPhysical;",
                    "        [Link]",
                    "        private Nutrient Nutrient;",
                    "        [Link(Path=\"[SurfaceOrganicMatter].SurfaceResidue.Decomposition\")]",
                    "        private OrganicFlow ResidueDecomposition;",
                    "        public IStructure Structure { private get; set; }",
                    "        ",
                    "        ",
                    "",
                    "",
                    "        [Separator(\"Fertiliser will be applied on the date(s) below\")]",
                    "        [Description(\"Apply fertiliser on the same day(s) each year? If no, then must include the year of application below\")]",
                    "        public bool EachYear { get; set; }",
                    "",
                    "        [Description(\"Dates for one or more fertiliser applications (dd-mmm or dd-mmm-yyyy) as a list with a comma between dates\")]",
                    "        public string[] Dates { get; set; }",
                    "",
                    "        [Separator(\"Test for the mineral N in the soil and don't apply the fertiliser if greater than X kgN/ha is stored in the soil above a depth of Y mm\")]",
                    "        [Description(\"Use a critical soil mineral N to prevent application above a threshold?\")]",
                    "        public bool UseCritNThreshold { get; set; }",
                    "",
                    "        [Description(\"Don't add fertiliser if N in the soil to the depth below exceeds (kg/ha)\")]",
                    "        public double CritNThreshold { get; set; }",
                    "",
                    "        [Description(\"Depth to which the amount of N in the soil should be calculated (mm)\")]",
                    "        public double CritNDepth { get; set; }",
                    "",
                    "        [Separator(\"Fertiliser application details\")]",
                    "        [Description(\"Depth at which to apply the fertiliser (mm)\")]",
                    "        public double Depth { get; set; }",
                    "",
                    "        [Description(\"Amount of fertiliser to apply (kg N /ha) per application\")]",
                    "        public double Amount { get; set; }",
                    "",
                    "        [Description(\"Fertiliser type - select from the list\")]",
                    "        [Display(Type = DisplayType.FertiliserType)]public string FertiliserType { get; set; }",
                    "",
                    "",
                    "        [EventSubscribe(\"StartOfSimulation\")]",
                    "        private void FindSoilNOrNutrient(object sender, EventArgs e)",
                    "        {",
                    "            nutrient =  Structure.Find<Nutrient>() as Nutrient;",
                    "            soilN =  Structure.Find<Nutrient>() as Nutrient;",
                    "",
                    "            if (nutrient == null && soilN == null)",
                    "                throw new Exception(string.Format(\"Error in script {0}: Unable to find nutrient or soilN.\", Name));",
                    "        }",
                    "",
                    "        [EventSubscribe(\"DoManagement\")]",
                    "        private void OnDoManagement(object sender, EventArgs e)",
                    "        {",
                    "            if (OnApplicationDate())",
                    "            {",
                    "                if (NContentBelowThreshold())",
                    "                    fertiliser.Apply(Amount, FertiliserType, Depth);",
                    "                else",
                    "                    summary.WriteMessage(this, \"Skipping fertiliser application due to soil mineral N content being above critical threshold.\", MessageType.Diagnostic);",
                    "            }",
                    "        }",
                    "",
                    "        /// <summary>Checks if today's date is one of the specified fertiliser application dates.</summary>",
                    "        private bool OnApplicationDate()",
                    "        {",
                    "            if (EachYear)",
                    "                return Dates.Any(d => DateUtilities.DatesEqual(d, clock.Today));",
                    "            ",
                    "            DateTime[] dates = Dates.Select(d => DateTime.ParseExact(d, \"d-MMM-yyyy\", null)).ToArray();",
                    "            return dates.Any(d => SameDate(d, clock.Today));",
                    "        }",
                    "",
                    "        /// <summary>Checks if N content in soil is below critical threshold.</summary>",
                    "        private bool NContentBelowThreshold()",
                    "        {",
                    "            if (!UseCritNThreshold)",
                    "                return true;",
                    "            ",
                    "            double[] weights = GetLayerWeights();",
                    "            double cumSoilN = 0;",
                    "",
                    "            for (int i = 0; i < soilPhysical.Thickness.Length; i++)",
                    "            {",
                    "                if (nutrient != null)",
                    "                    cumSoilN += weights[i] * nutrient.MineralN[i];",
                    "                else if (soilN != null)",
                    "                    cumSoilN += weights[i] * soilN.MineralN[i];",
                    "            }",
                    "",
                    "            return cumSoilN <= CritNThreshold;",
                    "        }",
                    "",
                    "        private double[] GetLayerWeights()",
                    "        {",
                    "            double[] weights = new double[soilPhysical.Thickness.Length];",
                    "            double cumDepth = 0;",
                    "",
                    "            for (int i = 0; i < soilPhysical.Thickness.Length; i++)",
                    "            {",
                    "                cumDepth += soilPhysical.Thickness[i];",
                    "                if (cumDepth < CritNDepth)",
                    "                    weights[i] = 1;",
                    "                else if (cumDepth - soilPhysical.Thickness[i] <= CritNDepth)",
                    "                    weights[i] = (CritNDepth - (cumDepth - soilPhysical.Thickness[i])) / soilPhysical.Thickness[i];",
                    "                else",
                    "                    weights[i] = 0;",
                    "            }",
                    "",
                    "            return weights;",
                    "        }",
                    "",
                    "        private bool SameDate(DateTime d1, DateTime d2)",
                    "        {",
                    "            return d1.Year == d2.Year && d1.DayOfYear == d2.DayOfYear;",
                    "        }",
                    "    }",
                    "}"
                  ],
                  "Parameters": [
                    {
                      "Key": "EachYear",
                      "Value": "True"
                    },
                    {
                      "Key": "Dates",
                      "Value": "5-jan, 5-feb, 5-mar, 5-apr, 5-aug, 5-sep, 5-oct, 5-nov, 5-dec"
                    },
                    {
                      "Key": "UseCritNThreshold",
                      "Value": "False"
                    },
                    {
                      "Key": "CritNThreshold",
                      "Value": "50"
                    },
                    {
                      "Key": "CritNDepth",
                      "Value": "75"
                    },
                    {
                      "Key": "Depth",
                      "Value": "50"
                    },
                    {
                      "Key": "Amount",
                      "Value": "15"
                    },
                    {
                      "Key": "FertiliserType",
                      "Value": "UreaN"
                    }
                  ],
                  "Name": "FertiliseFixedDates",
                  "ResourceName": null,
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Manager, Models",
                  "CodeArray": [
                    "using Newtonsoft.Json;",
                    "using APSIM.Shared.Utilities;",
                    "using System.Xml.Serialization;",
                    "using Models.Soils;",
                    "using Models.PMF;",
                    "using Models.Core;",
                    "using System;",
                    "using System.Linq;",
                    "using Models.Interfaces;",
                    "",
                    "",
                    "",
                    "        ",
                    "namespace Models",
                    "{",
                    "    [Serializable] ",
                    "    [System.Xml.Serialization.XmlInclude(typeof(Model))]",
                    "    public class Script : Model",
                    "    {",
                    "        [Link] private ISummary summary;",
                    "        [Link] private Irrigation Irrigation;",
                    "        [Link] private Clock Clock;",
                    "        [Link] private Soil Soil;",
                    "        [Link(IsOptional = true)] private IPlant existingCrop;",
                    "        private DateTime StartDate;",
                    "        private DateTime EndDate;",
                    "        private double TopDUL;",
                    "        private double TopLL;",
                    "        private int nLayers;",
                    "        [Link]",
                    "        private IPhysical soilPhysical;",
                    "        [Link]",
                    "        private ISoilWater waterBalance;",
                    "        //Communication to other modules",
                    "       ",
                    "        //User inputs from properties tab",
                    "        [Description(\"Turn irrigation on?\")]",
                    "        public bool allowIrrigation { get; set; }",
                    "        [Description(\"Start of irrigation season (dd-MMM)\")]",
                    "        public string seasonStart { get; set; }",
                    "        [Description(\"End of irrigation season (dd-MMM)\")]",
                    "        public string seasonEnd { get; set; }",
                    "        [Description(\"Season allocation (mm)\")]",
                    "        public double seasonsAllocation { get; set; }",
                    "        [Description(\"Deficit to trigger irrigation (% PAWC)\")]",
                    "        public double triggerDeficit { get; set; }",
                    "        [Description(\"Deficit to stop irrigaton (% PAWC)\")]",
                    "        public double targetDeficit { get; set; }",
                    "        [Description(\"Minimum days for irrigation to return\")]",
                    "        public double returndays { get; set; }",
                    "        [Description(\"Maximum irrigation application (mm/day)\")]",
                    "        public double maximumAmount { get; set; }",
                    "        [Description(\"Depth to calculate PAWC (mm)\")]",
                    "        public double depthPAWC { get; set; }",
                    "",
                    "        //Class members",
                    "        [JsonIgnore] public double TopSWdeficit { get; set; }",
                    "        [JsonIgnore] public double TopSWC { get; set; }",
                    "        [JsonIgnore] public double DaysSinceIrrigation { get; set; }",
                    "        [JsonIgnore] public double AmountToApply { get; set; }",
                    "        [JsonIgnore] public double SeasonAppliedAmount { get; set; }",
                    "        ",
                    "        private bool IrrigationIsAllowed { get; set; }",
                    "        private bool SeasonIsOpen { get; set; }",
                    "        private bool CropIsActive { get; set; }",
                    "        private bool IrrigatorIsAvailable { get; set; }",
                    "        private bool SoilIsDry { get; set; }",
                    "",
                    "    ",
                    "        //Calculate static soil variables",
                    "        [EventSubscribe(\"StartOfSimulation\")]",
                    "        private void OnStartOfSimulation(object sender, EventArgs e)",
                    "        {   ",
                    "            //Set the season dates",
                    "            StartDate = DateTime.Parse(seasonStart + \"-\" + Clock.Today.Year.ToString());",
                    "            EndDate = DateTime.Parse(seasonEnd + \"-\" + Clock.Today.Year.ToString());",
                    "            ",
                    "            //Can we irrigate at all?",
                    "            IrrigationIsAllowed = false; ",
                    "            if (allowIrrigation)",
                    "                IrrigationIsAllowed = true; ",
                    "",
                    "            //Calculate soil water variables",
                    "            double depthFromSurface = 0.0;",
                    "            double fracLayer = 0.0;",
                    "            nLayers = soilPhysical.Thickness.Length;",
                    "            for (int layer = 0; layer < nLayers; layer++)",
                    "            {",
                    "                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / soilPhysical.Thickness[layer]);",
                    "                TopLL += soilPhysical.LL15mm[layer] * fracLayer;",
                    "                TopDUL += soilPhysical.DULmm[layer] * fracLayer;",
                    "                depthFromSurface += soilPhysical.Thickness[layer];",
                    "                if (depthFromSurface >= depthPAWC)",
                    "                    layer = nLayers;",
                    "            }",
                    "        }",
                    "             ",
                    "        //Determine daily requirement for irrigation",
                    "        [EventSubscribe(\"StartOfDay\")]",
                    "        private void OnStartOfDay(object sender, EventArgs e)",
                    "        {",
                    "            //Can we irrigate today?          ",
                    "            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);",
                    "            if (!SeasonIsOpen)",
                    "                SeasonAppliedAmount = 0;",
                    "",
                    "            //Is there a crop in the ground that needs irrigation?",
                    "            CropIsActive = false;",
                    "            if ((existingCrop != null) && (existingCrop.IsAlive))",
                    "                CropIsActive = true;",
                    "            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))",
                    "          ",
                    "            //Is the irrigator available?",
                    "            IrrigatorIsAvailable = false;",
                    "            DaysSinceIrrigation += 1;",
                    "            if (DaysSinceIrrigation >= returndays)",
                    "                IrrigatorIsAvailable = true;",
                    "          ",
                    "            //Is the soil dry enough to require irrigation?",
                    "            SoilIsDry = false;",
                    "            double depthFromSurface = 0.0;",
                    "            double fracLayer = 0.0;",
                    "            TopSWC = 0.0;",
                    "            for (int layer = 0; layer < nLayers; layer++)",
                    "            //for (int layer = 0; depthFromSurface < depthPAWC + soilPhysical.Thickness[layer]; layer++)",
                    "            {",
                    "                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / soilPhysical.Thickness[layer]);",
                    "                TopSWC += waterBalance.SWmm[layer] * fracLayer;",
                    "                depthFromSurface += soilPhysical.Thickness[layer];",
                    "                if (depthFromSurface >= depthPAWC)",
                    "                    layer = nLayers;",
                    "            }",
                    "            ",
                    "            TopSWdeficit = TopSWC - TopDUL;",
                    "            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)",
                    "                SoilIsDry = true;",
                    "                ",
                    "            //Are all the conditions ratifying irrigation",
                    "            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)",
                    "            {",
                    "                //Lets bloody well irrigate then!!!!",
                    "                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;",
                    "                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));",
                    "                AmountToApply = Math.Min(AmountToApply,maximumAmount);",
                    "                Irrigation.Apply(AmountToApply);",
                    "                DaysSinceIrrigation = 0;",
                    "                SeasonAppliedAmount += AmountToApply;",
                    "            }",
                    "        }",
                    "        ",
                    "        ///Checks whether theDate is between iniDate and endDate (non-year specific)",
                    "        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)",
                    "        {",
                    "            bool result = false;",
                    "            if (iniDate.DayOfYear < endDate.DayOfYear)",
                    "            {",
                    "                // period is within one year, ex: summer in the northern hemisphere",
                    "                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))",
                    "                    result = true;",
                    "            }",
                    "            else",
                    "            {",
                    "                // period goes over the end of the year, ex: summer in the southern hemisphere",
                    "                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))",
                    "                    result = true;",
                    "            }",
                    "            ",
                    "            return result;",
                    "        }",
                    "    }",
                    "}"
                  ],
                  "Parameters": [
                    {
                      "Key": "allowIrrigation",
                      "Value": "False"
                    },
                    {
                      "Key": "seasonStart",
                      "Value": "1-sep"
                    },
                    {
                      "Key": "seasonEnd",
                      "Value": "30-apr"
                    },
                    {
                      "Key": "seasonsAllocation",
                      "Value": "10000"
                    },
                    {
                      "Key": "triggerDeficit",
                      "Value": "25"
                    },
                    {
                      "Key": "targetDeficit",
                      "Value": "100"
                    },
                    {
                      "Key": "returndays",
                      "Value": "3"
                    },
                    {
                      "Key": "maximumAmount",
                      "Value": "30"
                    },
                    {
                      "Key": "depthPAWC",
                      "Value": "300"
                    }
                  ],
                  "Name": "Irrigate",
                  "ResourceName": null,
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Irrigation, Models",
                  "Name": "Irrigation",
                  "ResourceName": null,
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Fertiliser, Models",
                  "Name": "Fertiliser",
                  "ResourceName": "Fertiliser",
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Surface.SurfaceOrganicMatter, Models",
                  "SurfOM": [],
                  "Canopies": [],
                  "InitialResidueName": "Sward",
                  "InitialResidueType": "grass",
                  "InitialResidueMass": 1000.0,
                  "InitialStandingFraction": 0.0,
                  "InitialCPR": 0.0,
                  "InitialCNR": 15.0,
                  "Name": "SurfaceOrganicMatter",
                  "ResourceName": "SurfaceOrganicMatter",
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.AgPasture.PastureSpecies, Models",
                  "doyGermination": 275,
                  "daysEmergenceToAnthesis": 120,
                  "daysAnthesisToMaturity": 85,
                  "degreesDayForAnthesis": 1100.0,
                  "degreesDayForMaturity": 900.0,
                  "daysAnnualsFactor": 45,
                  "FVPDFunction": {
                    "$type": "Models.Functions.LinearInterpolationFunction, Models",
                    "Name": "LinearInterpolationFunction",
                    "ResourceName": null,
                    "Children": [],
                    "Enabled": true,
                    "ReadOnly": false
                  },
                  "CanopyType": "PastureSpecies",
                  "LightProfile": null,
                  "InitialShootDM": 1500.0,
                  "InitialRootDM": 450.0,
                  "InitialRootDepth": 750.0,
                  "initialDMFractionsGrasses": [
                    0.15,
                    0.25,
                    0.25,
                    0.05,
                    0.05,
                    0.1,
                    0.1,
                    0.05,
                    0.0,
                    0.0,
                    0.0
                  ],
                  "initialDMFractionsLegumes": [
                    0.16,
                    0.23,
                    0.22,
                    0.05,
                    0.03,
                    0.05,
                    0.05,
                    0.01,
                    0.04,
                    0.08,
                    0.08
                  ],
                  "initialDMFractionsForbs": [
                    0.2,
                    0.2,
                    0.15,
                    0.05,
                    0.1,
                    0.15,
                    0.1,
                    0.05,
                    0.0,
                    0.0,
                    0.0
                  ],
                  "PhotosyntheticEfficiency": 0.01,
                  "PhotosynthesisCurveFactor": 0.8,
                  "FractionPAR": 0.5,
                  "ReferenceCO2": 380.0,
                  "CO2EffectScaleFactor": 700.0,
                  "CO2EffectOffsetFactor": 600.0,
                  "CO2EffectMinimum": 0.7,
                  "CO2EffectExponent": 2.0,
                  "ReproSeasonDurationCoeff": 2.0,
                  "ReproSeasonShouldersLengthFactor": 1.0,
                  "ReproSeasonOnsetDurationFactor": 0.6,
                  "RelativeTurnoverEmerging": 2.0,
                  "DetachmentDroughtCoefficient": 3.0,
                  "DetachmentDroughtEffectMin": 0.1,
                  "TurnoverStockFactor": 0.01,
                  "TurnoverDefoliationEffectMin": 0.025,
                  "MinimumGreenLeafProp": 0.8,
                  "MinimumGreenRootProp": 0.5,
                  "Name": "AGPRyegrass",
                  "ResourceName": "AGPRyegrass",
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.AgPasture.PastureSpecies, Models",
                  "doyGermination": 275,
                  "daysEmergenceToAnthesis": 120,
                  "daysAnthesisToMaturity": 85,
                  "degreesDayForAnthesis": 1100.0,
                  "degreesDayForMaturity": 900.0,
                  "daysAnnualsFactor": 45,
                  "FVPDFunction": {
                    "$type": "Models.Functions.LinearInterpolationFunction, Models",
                    "Name": "LinearInterpolationFunction",
                    "ResourceName": null,
                    "Children": [],
                    "Enabled": true,
                    "ReadOnly": false
                  },
                  "CanopyType": "PastureSpecies",
                  "LightProfile": null,
                  "InitialShootDM": 500.0,
                  "InitialRootDM": 150.0,
                  "InitialRootDepth": 350.0,
                  "initialDMFractionsGrasses": [
                    0.15,
                    0.25,
                    0.25,
                    0.05,
                    0.05,
                    0.1,
                    0.1,
                    0.05,
                    0.0,
                    0.0,
                    0.0
                  ],
                  "initialDMFractionsLegumes": [
                    0.16,
                    0.23,
                    0.22,
                    0.05,
                    0.03,
                    0.05,
                    0.05,
                    0.01,
                    0.04,
                    0.08,
                    0.08
                  ],
                  "initialDMFractionsForbs": [
                    0.2,
                    0.2,
                    0.15,
                    0.05,
                    0.1,
                    0.15,
                    0.1,
                    0.05,
                    0.0,
                    0.0,
                    0.0
                  ],
                  "PhotosyntheticEfficiency": 0.01,
                  "PhotosynthesisCurveFactor": 0.8,
                  "FractionPAR": 0.5,
                  "ReferenceCO2": 380.0,
                  "CO2EffectScaleFactor": 700.0,
                  "CO2EffectOffsetFactor": 600.0,
                  "CO2EffectMinimum": 0.7,
                  "CO2EffectExponent": 2.0,
                  "ReproSeasonDurationCoeff": 2.0,
                  "ReproSeasonShouldersLengthFactor": 1.0,
                  "ReproSeasonOnsetDurationFactor": 0.6,
                  "RelativeTurnoverEmerging": 2.0,
                  "DetachmentDroughtCoefficient": 3.0,
                  "DetachmentDroughtEffectMin": 0.1,
                  "TurnoverStockFactor": 0.01,
                  "TurnoverDefoliationEffectMin": 0.025,
                  "MinimumGreenLeafProp": 0.8,
                  "MinimumGreenRootProp": 0.5,
                  "Name": "AGPWhiteClover",
                  "ResourceName": "AGPWhiteClover",
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Report, Models",
                  "VariableNames": [
                    "[Clock].Today as Date",
                    "[TreadingDamage].Script.CowLiveweight as Liveweight",
                    "Sum of ([AGPRyegrass].HarvestedWt + [AGPWhiteClover].HarvestedWt) from 1-Jul-2000 to [Clock].Today as HarvestedWt   //the amount harvested (kg DM /ha)"
                  ],
                  "EventNames": [
                    "[Clock].EndOfSimulation"
                  ],
                  "GroupByVariableName": null,
                  "Name": "Report",
                  "ResourceName": null,
                  "Children": [],
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Soils.Soil, Models",
                  "RecordNumber": 1259,
                  "ASCOrder": "Gley",
                  "ASCSubOrder": null,
                  "SoilType": "Silt loam",
                  "LocalName": "Taho (Silt loam (Opotiki No1347))",
                  "Site": "Crooked Rd, south of junction with Dickenson Rd",
                  "NearestTown": "Opotiki",
                  "Region": "BayOfPlenty",
                  "State": null,
                  "Country": "New Zealand",
                  "NaturalVegetation": "long term grass",
                  "ApsoilNumber": "1347",
                  "Latitude": -38.031,
                  "Longitude": 177.25,
                  "LocationAccuracy": "+/-50 m",
                  "YearOfSampling": "1983",
                  "DataSource": "The database of New Zealand soils was compiled by AgResearch (www.agresearch.co.nz) and based on soil properties gathered, mainly from publications, in the course of conducting several simulation-based research projects but particularly from the Pastoral 21 Environment program which was funded by the New Zealand Ministry for Business, Innovation and Employment,  Dairy NZ, Fonterra and Meat & Wool NZ.",
                  "Comments": "The data is a combination of published or supplied measurements, pedotransfer functions, and expert opinion. See Cichota et al. (2013; Soil Research 51: 92-111, http://dx.doi.org/10.1071/SR12338) for a description of the pedotransfer functions. The soil carbon and fresh organic matter settings have been set as those broadly appropriate for permanent productive pastoral systems, see Cichota el al. (2012; Soil Research 50: 694-707, http://dx.doi.org/10.1071/SR12208). Users should take care to adapt these to local conditions before using the data in simulations. FOM values estimated to be 900 kg/ha of FOM in top 600mm of soil and another 100 kg/ha below.",
                  "Name": "Soil",
                  "ResourceName": null,
                  "Children": [
                    {
                      "$type": "Models.Soils.Physical, Models",
                      "Thickness": [
                        150.0,
                        250.0,
                        250.0,
                        200.0,
                        300.0,
                        1850.0
                      ],
                      "ParticleSizeSand": [
                        34.0,
                        22.0,
                        32.0,
                        25.0,
                        52.0,
                        50.0
                      ],
                      "ParticleSizeSilt": [
                        52.0,
                        51.0,
                        53.0,
                        45.0,
                        36.0,
                        38.0
                      ],
                      "ParticleSizeClay": [
                        14.0,
                        27.0,
                        15.0,
                        30.0,
                        12.0,
                        12.0
                      ],
                      "Rocks": [
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        2.0
                      ],
                      "Texture": null,
                      "BD": [
                        1.03,
                        1.08,
                        0.89,
                        1.16,
                        1.14,
                        1.176
                      ],
                      "AirDry": [
                        0.056,
                        0.074,
                        0.048,
                        0.09,
                        0.06,
                        0.056
                      ],
                      "LL15": [
                        0.17,
                        0.224,
                        0.144,
                        0.273,
                        0.183,
                        0.171
                      ],
                      "DUL": [
                        0.411,
                        0.4,
                        0.375,
                        0.43,
                        0.378,
                        0.356
                      ],
                      "SAT": [
                        0.531,
                        0.533,
                        0.59,
                        0.504,
                        0.493,
                        0.47
                      ],
                      "KS": [
                        3186.27,
                        358.981,
                        795.543,
                        135.676,
                        2876.485,
                        2676.044
                      ],
                      "BDMetadata": [
                        "Field measured and checked for sensibility",
                        "Field measured and checked for sensibility",
                        "Field measured and checked for sensibility",
                        "Field measured and checked for sensibility",
                        "Field measured and checked for sensibility",
                        "Field measured and checked for sensibility"
                      ],
                      "AirDryMetadata": [
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge"
                      ],
                      "LL15Metadata": [
                        "Laboratory measured",
                        "Laboratory measured",
                        "Laboratory measured",
                        "Laboratory measured",
                        "Laboratory measured",
                        "Laboratory measured"
                      ],
                      "DULMetadata": [
                        "Laboratory measured",
                        "Laboratory measured",
                        "Laboratory measured",
                        "Laboratory measured",
                        "Laboratory measured",
                        "Laboratory measured"
                      ],
                      "SATMetadata": [
                        "Calculated from measured, estimated or calculated BD",
                        "Calculated from measured, estimated or calculated BD",
                        "Calculated from measured, estimated or calculated BD",
                        "Calculated from measured, estimated or calculated BD",
                        "Calculated from measured, estimated or calculated BD",
                        "Calculated from measured, estimated or calculated BD"
                      ],
                      "KSMetadata": null,
                      "RocksMetadata": [
                        null,
                        null,
                        null,
                        null,
                        null,
                        null
                      ],
                      "TextureMetadata": null,
                      "ParticleSizeSandMetadata": [
                        null,
                        null,
                        null,
                        null,
                        null,
                        null
                      ],
                      "ParticleSizeSiltMetadata": [
                        null,
                        null,
                        null,
                        null,
                        null,
                        null
                      ],
                      "ParticleSizeClayMetadata": [
                        null,
                        null,
                        null,
                        null,
                        null,
                        null
                      ],
                      "Name": "Physical",
                      "ResourceName": null,
                      "Children": [
                        {
                          "$type": "Models.Soils.SoilCrop, Models",
                          "LL": [
                            0.17,
                            0.224,
                            0.144,
                            0.273,
                            0.183,
                            0.171
                          ],
                          "KL": [
                            0.06,
                            0.06,
                            0.056,
                            0.04,
                            0.04,
                            0.023
                          ],
                          "XF": [
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0
                          ],
                          "LLMetadata": [
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge"
                          ],
                          "KLMetadata": [
                            null,
                            null,
                            null,
                            null,
                            null,
                            null
                          ],
                          "XFMetadata": [
                            null,
                            null,
                            null,
                            null,
                            null,
                            null
                          ],
                          "Name": "AGPRyegrassSoil",
                          "ResourceName": null,
                          "Children": [],
                          "Enabled": true,
                          "ReadOnly": false
                        },
                        {
                          "$type": "Models.Soils.SoilCrop, Models",
                          "LL": [
                            0.17,
                            0.224,
                            0.144,
                            0.273,
                            0.183,
                            0.171
                          ],
                          "KL": [
                            0.06,
                            0.06,
                            0.056,
                            0.04,
                            0.04,
                            0.023
                          ],
                          "XF": [
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0,
                            1.0
                          ],
                          "LLMetadata": [
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge",
                            "Estimated based on local knowledge"
                          ],
                          "KLMetadata": [
                            null,
                            null,
                            null,
                            null,
                            null,
                            null
                          ],
                          "XFMetadata": [
                            null,
                            null,
                            null,
                            null,
                            null,
                            null
                          ],
                          "Name": "AGPWhiteCloverSoil",
                          "ResourceName": null,
                          "Children": [],
                          "Enabled": true,
                          "ReadOnly": false
                        }
                      ],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.Swim3, Models",
                      "Salb": 0.13,
                      "CN2Bare": 0.0,
                      "CNRed": 0.0,
                      "CNCov": 0.8,
                      "KDul": 1.0,
                      "PSIDul": -100.0,
                      "VC": true,
                      "DTMin": 0.0,
                      "DTMax": 1440.0,
                      "MaxWaterIncrement": 10.0,
                      "SpaceWeightingFactor": 0.0,
                      "SoluteSpaceWeightingFactor": 1.0,
                      "Dis": 0.0,
                      "Disp": 1.0,
                      "A": 2.0,
                      "DTHC": 0.1,
                      "DTHP": 2.0,
                      "vcon1": 7.28E-09,
                      "vcon2": 7.26E-07,
                      "eo_time": "06:00",
                      "eo_durn": 720.0,
                      "default_rain_time": "00:00",
                      "default_rain_duration": 720.0,
                      "Diagnostics": false,
                      "Name": "Swim3",
                      "ResourceName": null,
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.Organic, Models",
                      "FOMCNRatio": 40.0,
                      "Thickness": [
                        150.0,
                        250.0,
                        250.0,
                        200.0,
                        300.0,
                        1850.0
                      ],
                      "Carbon": [
                        3.6,
                        1.0,
                        0.5,
                        0.4,
                        0.5,
                        0.5
                      ],
                      "CarbonUnits": 0,
                      "SoilCNRatio": [
                        11.25,
                        11.25,
                        11.25,
                        11.25,
                        11.25,
                        11.25
                      ],
                      "FBiom": [
                        0.078,
                        0.017,
                        0.008,
                        0.008,
                        0.008,
                        0.008
                      ],
                      "FInert": [
                        0.497,
                        0.514,
                        0.911,
                        0.963,
                        0.99,
                        0.994
                      ],
                      "FOM": [
                        92.83909909067731,
                        56.30976001859504,
                        34.15359589233852,
                        22.893839970834982,
                        12.56440577086876,
                        6.239299256685404
                      ],
                      "CarbonMetadata": null,
                      "FOMMetadata": null,
                      "Name": "Organic",
                      "ResourceName": null,
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.Chemical, Models",
                      "Thickness": [
                        150.0,
                        250.0,
                        250.0,
                        200.0,
                        300.0,
                        1850.0
                      ],
                      "PH": [
                        6.5,
                        6.5,
                        6.5,
                        6.5,
                        6.5,
                        6.5
                      ],
                      "PHUnits": 0,
                      "EC": null,
                      "ESP": null,
                      "CEC": [
                        12.6,
                        9.2,
                        6.7,
                        7.9,
                        5.8,
                        5.8
                      ],
                      "ECMetadata": null,
                      "CLMetadata": null,
                      "CECMetadata": null,
                      "ESPMetadata": null,
                      "PHMetadata": [
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge",
                        "Estimated based on local knowledge"
                      ],
                      "Name": "Chemical",
                      "ResourceName": null,
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.Nutrients.Nutrient, Models",
                      "Name": "Nutrient",
                      "ResourceName": "Nutrient",
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.Solute, Models",
                      "Thickness": [
                        150.0,
                        250.0,
                        250.0,
                        200.0,
                        300.0,
                        1850.0
                      ],
                      "InitialValues": [
                        6.0,
                        2.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0
                      ],
                      "InitialValuesUnits": 0,
                      "WaterTableConcentration": 0.0,
                      "D0": 0.0,
                      "Exco": [
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0
                      ],
                      "FIP": [
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0
                      ],
                      "DepthConstant": 0.0,
                      "MaxDepthSoluteAccessible": 0.0,
                      "RunoffEffectivenessAtMovingSolute": 0.0,
                      "MaxEffectiveRunoff": 0.0,
                      "ConcInSolution": null,
                      "Name": "NO3",
                      "ResourceName": null,
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.Solute, Models",
                      "Thickness": [
                        150.0,
                        250.0,
                        250.0,
                        200.0,
                        300.0,
                        1850.0
                      ],
                      "InitialValues": [
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0
                      ],
                      "InitialValuesUnits": 0,
                      "WaterTableConcentration": 0.0,
                      "D0": 0.0,
                      "Exco": [
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0
                      ],
                      "FIP": [
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0
                      ],
                      "DepthConstant": 0.0,
                      "MaxDepthSoluteAccessible": 0.0,
                      "RunoffEffectivenessAtMovingSolute": 0.0,
                      "MaxEffectiveRunoff": 0.0,
                      "ConcInSolution": null,
                      "Name": "NH4",
                      "ResourceName": null,
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.Solute, Models",
                      "Thickness": [
                        150.0,
                        250.0,
                        250.0,
                        200.0,
                        300.0,
                        1850.0
                      ],
                      "InitialValues": [
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0
                      ],
                      "InitialValuesUnits": 1,
                      "WaterTableConcentration": 0.0,
                      "D0": 0.0,
                      "Exco": [
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0,
                        0.0
                      ],
                      "FIP": [
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0
                      ],
                      "DepthConstant": 0.0,
                      "MaxDepthSoluteAccessible": 0.0,
                      "RunoffEffectivenessAtMovingSolute": 0.0,
                      "MaxEffectiveRunoff": 0.0,
                      "ConcInSolution": null,
                      "Name": "Urea",
                      "ResourceName": null,
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.Water, Models",
                      "Thickness": [
                        150.0,
                        250.0,
                        250.0,
                        200.0,
                        300.0,
                        1850.0
                      ],
                      "InitialValues": [
                        0.411,
                        0.4,
                        0.375,
                        0.43,
                        0.378,
                        0.356
                      ],
                      "FilledFromTop": false,
                      "Name": "Water",
                      "ResourceName": null,
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.LayerStructure, Models",
                      "Thickness": [
                        10.0,
                        20.0,
                        30.0,
                        40.0,
                        50.0,
                        50.0,
                        50.0,
                        50.0,
                        200.0,
                        250.0,
                        250.0,
                        500.0,
                        500.0,
                        500.0,
                        300.0,
                        100.0,
                        100.0
                      ],
                      "Name": "LayerStructure",
                      "ResourceName": null,
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    },
                    {
                      "$type": "Models.Soils.SoilTemp.SoilTemperature, Models",
                      "Thickness": null,
                      "InitialValues": null,
                      "Name": "Temperature",
                      "ResourceName": null,
                      "Children": [],
                      "Enabled": true,
                      "ReadOnly": false
                    }
                  ],
                  "Enabled": true,
                  "ReadOnly": false
                }
              ],
              "Enabled": true,
              "ReadOnly": false
            }
          ],
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Graph, Models",
          "Caption": null,
          "Axis": [
            {
              "$type": "APSIM.Shared.Graphing.Axis, APSIM.Shared",
              "Title": null,
              "Position": 3,
              "Inverted": false,
              "CrossesAtZero": false,
              "LabelOnOneLine": false,
              "Minimum": "NaN",
              "Maximum": null,
              "Interval": null
            },
            {
              "$type": "APSIM.Shared.Graphing.Axis, APSIM.Shared",
              "Title": null,
              "Position": 0,
              "Inverted": false,
              "CrossesAtZero": false,
              "LabelOnOneLine": false,
              "Minimum": null,
              "Maximum": null,
              "Interval": null
            }
          ],
          "LegendPosition": 3,
          "LegendOrientation": 0,
          "AnnotationLocation": 0,
          "DisabledSeries": [],
          "LegendOutsideGraph": false,
          "Name": "CowLW effect on Production",
          "ResourceName": null,
          "Children": [
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": 0,
              "FactorToVaryColours": "SimulationName",
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 0,
              "MarkerSize": 0,
              "Line": 4,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Liveweight",
              "YFieldName": "HarvestedWt",
              "X2FieldName": null,
              "Y2FieldName": null,
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Series",
              "ResourceName": null,
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            }
          ],
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Graph, Models",
          "Caption": null,
          "Axis": [
            {
              "$type": "APSIM.Shared.Graphing.Axis, APSIM.Shared",
              "Title": null,
              "Position": 3,
              "Inverted": false,
              "CrossesAtZero": false,
              "LabelOnOneLine": false,
              "Minimum": "NaN",
              "Maximum": null,
              "Interval": null
            },
            {
              "$type": "APSIM.Shared.Graphing.Axis, APSIM.Shared",
              "Title": null,
              "Position": 0,
              "Inverted": false,
              "CrossesAtZero": false,
              "LabelOnOneLine": false,
              "Minimum": null,
              "Maximum": null,
              "Interval": null
            }
          ],
          "LegendPosition": 5,
          "LegendOrientation": 0,
          "AnnotationLocation": 0,
          "DisabledSeries": [],
          "LegendOutsideGraph": false,
          "Name": "Current vs Benchmark",
          "ResourceName": null,
          "Children": [
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": 0,
              "FactorToVaryColours": "SimulationName",
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 0,
              "MarkerSize": 0,
              "Line": 4,
              "LineThickness": 0,
              "TableName": "PredictedObserved",
              "XFieldName": "Observed.HarvestedWt",
              "YFieldName": "Predicted.HarvestedWt",
              "X2FieldName": null,
              "Y2FieldName": null,
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Series",
              "ResourceName": null,
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Regression, Models",
              "ForEachSeries": false,
              "showOneToOne": false,
              "showEquation": true,
              "Name": "Regression",
              "ResourceName": null,
              "Children": [],
              "Enabled": true,
              "ReadOnly": false
            }
          ],
          "Enabled": true,
          "ReadOnly": false
        }
      ],
      "Enabled": true,
      "ReadOnly": false
    }
  ],
  "Enabled": true,
  "ReadOnly": false
}