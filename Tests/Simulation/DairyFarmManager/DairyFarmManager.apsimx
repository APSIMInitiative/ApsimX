<?xml version="1.0" encoding="utf-8"?>
<Simulations xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Version="28">
  <Name>Simulations</Name>
  <Simulation>
    <Name>SinglePaddockForRV</Name>
    <Clock>
      <Name>Clock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <StartDate>2000-08-01T00:00:00</StartDate>
      <EndDate>2001-07-31T00:00:00</EndDate>
    </Clock>
    <Summary>
      <Name>SummaryFile</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
    </Summary>
    <SoilArbitrator>
      <Name>SoilArbitrator</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
    </SoilArbitrator>
    <Weather>
      <Name>Weather</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <FileName>%root%\Examples\WeatherFiles\lincoln.met</FileName>
      <ExcelWorkSheetName />
    </Weather>
    <Stock>
      <Name>Stock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <RandSeed>9999</RandSeed>
      <GenoTypes />
      <Sheep />
      <Cattle />
      <PaddockList>
        <PaddockInit>
          <Forages />
          <Name />
          <Area>1</Area>
          <Slope>0</Slope>
        </PaddockInit>
      </PaddockList>
      <EnterpriseList />
      <GrazingPeriods />
    </Stock>
    <Manager>
      <Name>CreateStock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Script>
        <StockingRate>3</StockingRate>
        <CurrentLocation>
        </CurrentLocation>
        <NumCows>3</NumCows>
        <FarmArea>0</FarmArea>
      </Script>
      <Code><![CDATA[using System;
using Models.Core;
using Models.Utilities;
using Models.GrazPlan;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;
using Models.PMF;
using Models.Soils;
using System.Collections;
using System.Collections.Generic;
using Models.AgPasture;
using System.Diagnostics;

namespace Models
{

    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Stock Cows;
        [Link] Supplement Feed;
        [Link] Zone[] Paddocks;
        [Link] ISummary summary = null;

        [Serializable]
        public class PaddockInfo
        {
            public string paddockName;
            public double harvestableBiomass;
            public int paddockNum;
            public double paddockArea;
        }


        [Description("Whole-farm stocking rate (head/ha): ")] public double StockingRate { get; set; }
        [Description("Initial location of the cows (paddock name): ")] public string CurrentLocation { get; set; }


        public int NumCows { get; set; } // number of cows on the whole farm
        public double FarmArea { get; set; }

        private int group_count; // how many groups are there in the simulation
        private int g = 1;      // index to the groups of animals
        private int CurrentLocationNum; 
        private int NumPaddocks = 1;

        public event BiomassRemovedDelegate BiomassRemoved;
        List<PaddockInfo> listOfPaddockInfo = new List<PaddockInfo>();


        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            summary.WriteMessage(this, "Initialising the paddock information");

            GetFarmAreaAndOtherInfo();

            NumCows = (int)(Math.Round(StockingRate * FarmArea, 0));

            SetInitialCowStuff();

            Cows.Move(g, CurrentLocation);

            summary.WriteMessage(this, "     The number of animals has been rounded to " + NumCows + " from " + (StockingRate * FarmArea));
            summary.WriteMessage(this, "     The animals will begin in " + CurrentLocation + " which is paddock number " + CurrentLocationNum + " in the simulation");
            summary.WriteMessage(this, "     The area of the whole farm is " + FarmArea + " ha");

        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            if (Cows.NumberAll > 0)
            {
                Feed.Feed("Silage", 15.0 * Cows.NumberAll, CurrentLocation);
                // remove some biomass
                UpdatePaddockInfo();

                foreach (Zone paddock in Paddocks)
                {
                    if (paddock.Name == CurrentLocation)
                    {
                        foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                        {
                            //Debugger.Break();
                            double totalAmountToRemove = 15.0 * Cows.NumberAll;
                            double amountToRemove = (15.0 * Cows.NumberAll) * (plant.HarvestableWt / listOfPaddockInfo[CurrentLocationNum].harvestableBiomass);
                            if (amountToRemove >= plant.HarvestableWt)
                            {
                                amountToRemove = plant.HarvestableWt;
                            }
                            else
                            {
                                //double propToRemove = plant.AboveGroundWt /  plantWeights[0].totalWt;
                                plant.Graze(amount: amountToRemove, type: "SetRemoveAmount");
                                //DefoliatedWt += species.HarvestedWt;
                                //DefoliatedN += species.HarvestedN;
                            }
                        }
                    }
                }
            }
        }


        public void SetInitialCowStuff()
        {
            g = Cows.NoGroups + 1;

            StockBuy purchase = new StockBuy();
            purchase.Genotype = "Friesian";
            purchase.Number = NumCows;
            purchase.Sex = "heifers";
            purchase.Age = 24;       // age in months
            purchase.Weight = 550.0;  // live weight in kg
            purchase.UseTag = g + 1;
            purchase.MatedTo = "Friesian";
            purchase.Pregnant = 0;  // days pregnant, 0 = non pregnant, 1 = pregnant
            purchase.Lactating = 1;  // 0 for dry, 1 for lactating
            purchase.NumYoung = 2;
            purchase.YoungWt = 45;

            Cows.Buy(purchase);
        }

        public void GetFarmAreaAndOtherInfo()
        {
            NumPaddocks = 0;
            FarmArea = 0.0;
            CurrentLocationNum = 0;

            foreach (Zone paddock in Paddocks)
            {
                NumPaddocks += 1;

                PaddockInfo paddockInfo = new PaddockInfo();

                paddockInfo.paddockName = paddock.Name;
                paddockInfo.paddockNum = NumPaddocks - 1;
                paddockInfo.paddockArea = paddock.Area;

                foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                    paddockInfo.harvestableBiomass += plant.HarvestableWt;

                listOfPaddockInfo.Add(paddockInfo);

                FarmArea += paddock.Area;
                if (paddock.Name == CurrentLocation)
                    CurrentLocationNum = paddockInfo.paddockNum;

                summary.WriteMessage(this, "     Paddock " + NumPaddocks + " is called " + paddock.Name + ", has an area of " + paddock.Area + " ha and an initial harvestable biomass of " + paddockInfo.harvestableBiomass + " kg DM / ha");

            }

        }

        public void UpdatePaddockInfo()
        {
            int ii = -1;

            foreach (Zone paddock in Paddocks)
            {
                ii += 1;
                listOfPaddockInfo[ii].harvestableBiomass = 0.0;
                foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                    listOfPaddockInfo[ii].harvestableBiomass += plant.HarvestableWt;

            }

        }


    }
}
]]></Code>
    </Manager>
    <Supplement>
      <Name>Supplement</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <SpoilageTime>0</SpoilageTime>
      <stores>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>0.85</DMContent>
          <DMD>0</DMD>
          <MEContent>0</MEContent>
          <CPConc>0</CPConc>
          <ProtDg>0</ProtDg>
          <PConc>0</PConc>
          <SConc>0</SConc>
          <EEConc>0</EEConc>
          <ADIP2CP>0</ADIP2CP>
          <AshAlk>0</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>fodder</Name>
          <Stored>0</Stored>
        </StoreType>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>0.25</DMContent>
          <DMD>0.75</DMD>
          <MEContent>12</MEContent>
          <CPConc>0.18</CPConc>
          <ProtDg>0.8</ProtDg>
          <PConc>0.0032</PConc>
          <SConc>0.0024</SConc>
          <EEConc>0.02</EEConc>
          <ADIP2CP>0.06</ADIP2CP>
          <AshAlk>0.6</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>silage</Name>
          <Stored>200000</Stored>
        </StoreType>
      </stores>
      <PaddockList />
    </Supplement>
    <Report>
      <Name>Report</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <ExperimentFactorNames />
      <ExperimentFactorValues />
      <VariableNames>
        <string>[Clock].Today</string>
        <string>[Stock].NumberAll as NumCows</string>
        <string>[Stock].IntakeAll.Weight as AveDMI</string>
        <string>[Stock].MEIntakeAll as AveMEIntake</string>
        <string>[Stock].WeightAll as AveBodyWeight</string>
        <string>[Stock].CondScoreAll as AveCS</string>
        <string>[Stock].MilkWtAll as AveMilkWeight</string>
      </VariableNames>
      <EventNames>
        <string>[Clock].EndOfDay</string>
      </EventNames>
    </Report>
    <Folder>
      <Name>Folder</Name>
      <Graph>
        <Name>Live Cows</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.NumberAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>BodyWt and Milk Production</Name>
        <Series>
          <Name>BodyWeight</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Right</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.WeightAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>MilkProduction</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16736653</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.MilkWtAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Right</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>Condition Score</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.CondScoreAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>Supplement Stores</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Supplement.stores2.Stored</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <ShowPageOfGraphs>true</ShowPageOfGraphs>
    </Folder>
    <Zone>
      <Name>OneBigPaddock</Name>
      <Folder>
        <Name>Managers</Name>
        <Manager>
          <Name>AutomaticFertiliser</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <AllowFertiliser>yes</AllowFertiliser>
            <Depth2SoilN>500</Depth2SoilN>
            <CriticalSoilN>5</CriticalSoilN>
            <FertNAmount>25</FertNAmount>
            <FertType>UreaN</FertType>
            <FertApplicationDepth>1</FertApplicationDepth>
            <FertMinimumDays>15</FertMinimumDays>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Fertiliser fertiliser;
        [Link] ISummary summary = null;
        [Link] Soil Soil;

        //User inputs from properties tab
        [Description("Turn ferliser applications on? ")]
        public yesnoType AllowFertiliser { get; set; }
        
        [Description("Depth to calculate available soil N (mm): ")]
        public double Depth2SoilN { get; set; }

        [Description("Minimum available N, triggers an application (kgN/ha): ")]
        public double CriticalSoilN { get; set; }

        [Description("Amount of N fertiliser for each application (kgN/ha): ")]
        public double FertNAmount { get; set; }

        [Description("Type of N fertiliser to apply: ")]
        public Fertiliser.Types FertType { get; set; }

        [Description("Depth at which to apply the fertiliser (mm): ")]
        public double FertApplicationDepth { get; set; }
       
        [Description("Minimum period between applications (days): ")]
        public double FertMinimumDays { get; set; }
       
        public enum yesnoType
        {
            /// <summary>a positive answer</summary>
            yes,
            /// <summary>a negative answer</summary>
            no
        }

        [XmlIgnore] public double TopMineralN { get; set; }
        
        private DateTime lastApplicationDate;
        private bool fertiliserIsAllowed;
        private int nLayers;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            fertiliserIsAllowed = (AllowFertiliser == yesnoType.yes);
            nLayers = Soil.Thickness.Length;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            double daysSinceLastApplication = (Clock.Today - lastApplicationDate).TotalDays;
            
            // get the N stored in the soil
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopMineralN = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (Depth2SoilN - depthFromSurface) / Soil.Thickness[layer]);
                TopMineralN += (Soil.SoilNitrogen.NO3[layer]
                + Soil.SoilNitrogen.NH4[layer]
                + Soil.SoilNitrogen.urea[layer])
                * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= Depth2SoilN)
                    layer = nLayers;
            }

            if (fertiliserIsAllowed && (daysSinceLastApplication >= FertMinimumDays) && (TopMineralN <= CriticalSoilN))
            {
                fertiliser.Apply(FertNAmount, FertType, FertApplicationDepth);
                lastApplicationDate = Clock.Today;
            }
        }
    }
}
]]></Code>
        </Manager>
        <Manager>
          <Name>AutomaticIrrigation</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <allowIrrigation>True</allowIrrigation>
            <seasonStart>15-Aug</seasonStart>
            <seasonEnd>30-May</seasonEnd>
            <seasonsAllocation>10000</seasonsAllocation>
            <triggerDeficit>75</triggerDeficit>
            <targetDeficit>99</targetDeficit>
            <returndays>1</returndays>
            <maximumAmount>30</maximumAmount>
            <depthPAWC>300</depthPAWC>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using System.Xml.Serialization;
using Models.PMF;
using APSIM.Shared.Utilities;

        
namespace Models
{
    [Serializable] 
    [System.Xml.Serialization.XmlInclude(typeof(Model))]
    public class Script : Model
    {
        //Communication to other modules
        [Link] ISummary summary = null;
        [Link] Irrigation Irrigation;
        [Link] Clock Clock;
        [Link] Soil Soil;
        [Link(IsOptional = true)] IPlant existingCrop;
       
        //User inputs from properties tab
        [Description("Turn irrigation on?")]
        public bool allowIrrigation { get; set; }
        [Description("Start of irrigation season (dd-MMM)")]
        public string seasonStart { get; set; }
        [Description("End of irrigation season (dd-MMM)")]
        public string seasonEnd { get; set; }
        [Description("Season allocation (mm)")]
        public double seasonsAllocation { get; set; }
        [Description("Deficit to trigger irrigation (% PAWC)")]
        public double triggerDeficit { get; set; }
        [Description("Deficit to stop irrigaton (% PAWC)")]
        public double targetDeficit { get; set; }
        [Description("Minimum days for irrigation to return")]
        public double returndays { get; set; }
        [Description("Maximum irrigation application (mm/day)")]
        public double maximumAmount { get; set; }
        [Description("Depth to calculate PAWC (mm)")]
        public double depthPAWC { get; set; }

        //Class members
        [XmlIgnore] public double TopSWdeficit { get; set; }
        [XmlIgnore] public double TopSWC { get; set; }
        [XmlIgnore] public double DaysSinceIrrigation { get; set; }
        [XmlIgnore] public double AmountToApply { get; set; }
        [XmlIgnore] public double SeasonAppliedAmount { get; set; }
        
        private bool IrrigationIsAllowed { get; set; }
        private bool SeasonIsOpen { get; set; }
        private bool CropIsActive { get; set; }
        private bool IrrigatorIsAvailable { get; set; }
        private bool SoilIsDry { get; set; }

        private DateTime StartDate;
        private DateTime EndDate;
        private double TopDUL;
        private double TopLL;
        private int nLayers;
    
        //Calculate static soil variables
        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {   
            //Set the season dates
            StartDate = DateTime.Parse(seasonStart + "-" + Clock.Today.Year.ToString());
            EndDate = DateTime.Parse(seasonEnd + "-" + Clock.Today.Year.ToString());
            
            //Can we irrigate at all?
            IrrigationIsAllowed = false; 
            if (allowIrrigation)
                IrrigationIsAllowed = true; 

            //Calculate soil water variables
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            nLayers = Soil.Thickness.Length;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopLL += Soil.LL15mm[layer] * fracLayer;
                TopDUL += Soil.DULmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
        }
             
        //Determine daily requirement for irrigation
        [EventSubscribe("StartOfDay")]
        private void OnStartOfDay(object sender, EventArgs e)
        {
            //Can we irrigate today?          
            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);

            //Is there a crop in the ground that needs irrigation?
            CropIsActive = false;
            if ((existingCrop != null) && (existingCrop.IsAlive))
                CropIsActive = true;
            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))
          
            //Is the irrigator available?
            IrrigatorIsAvailable = false;
            DaysSinceIrrigation += 1;
            if (DaysSinceIrrigation >= returndays)
                IrrigatorIsAvailable = true;
          
            //Is the soil dry enough to require irrigation?
            SoilIsDry = false;
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopSWC = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            //for (int layer = 0; depthFromSurface < depthPAWC + Soil.Thickness[layer]; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopSWC += Soil.SoilWater.SWmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
            
            TopSWdeficit = TopSWC - TopDUL;
            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)
                SoilIsDry = true;
                
            //Are all the conditions ratifying irrigation
            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)
            {
                //Lets bloody well irrigate then!!!!
                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;
                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));
                Irrigation.Apply(AmountToApply);
                DaysSinceIrrigation = 0;
                SeasonAppliedAmount += AmountToApply;
            }
        }
        
        ///Checks whether theDate is between iniDate and endDate (non-year specific)
        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)
        {
            bool result = false;
            if (iniDate.DayOfYear < endDate.DayOfYear)
            {
                // period is within one year, ex: summer in the northern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            else
            {
                // period goes over the end of the year, ex: summer in the southern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            
            return result;
        }
    }
}
]]></Code>
        </Manager>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ShowPageOfGraphs>true</ShowPageOfGraphs>
      </Folder>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <a_interception>0</a_interception>
        <b_interception>0</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.29366217672824863</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Fertiliser>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ReportAdditions>no</ReportAdditions>
        <ReportRemovals>no</ReportRemovals>
        <ResidueTypes>
          <Name>ResidueTypes</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <LoadFromResource>ResidueTypes</LoadFromResource>
        </ResidueTypes>
        <TillageTypes>
          <Name>TillageTypesList</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <TillageType />
        </TillageTypes>
        <Pools>
          <Pool>
            <PoolName>Sward</PoolName>
            <ResidueType>grass</ResidueType>
            <Mass>1000</Mass>
            <CNRatio>15</CNRatio>
            <CPRatio>NaN</CPRatio>
            <StandingFraction>0</StandingFraction>
          </Pool>
        </Pools>
        <PoolName>Sward</PoolName>
        <type>grass</type>
        <mass>1000</mass>
        <standing_fraction>0</standing_fraction>
        <cpr />
        <cnr>15</cnr>
        <CriticalResidueWeight>2000</CriticalResidueWeight>
        <OptimumDecompTemp>20</OptimumDecompTemp>
        <MaxCumulativeEOS>20</MaxCumulativeEOS>
        <CNRatioDecompCoeff>0.277</CNRatioDecompCoeff>
        <CNRatioDecompThreshold>25</CNRatioDecompThreshold>
        <TotalLeachRain>25</TotalLeachRain>
        <MinRainToLeach>10</MinRainToLeach>
        <CriticalMinimumOrganicC>0.004</CriticalMinimumOrganicC>
        <DefaultCPRatio>0</DefaultCPRatio>
        <DefaultStandingFraction>0</DefaultStandingFraction>
        <StandingExtinctCoeff>0.5</StandingExtinctCoeff>
        <FractionFaecesAdded>0.5</FractionFaecesAdded>
      </SurfaceOrganicMatter>
      <PastureSpecies>
        <Name>Ryegrass</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Grass</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>2500</InitialShootDM>
        <InitialRootDM>450</InitialRootDM>
        <InitialRootDepth>750</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.5</LightExtinctionCoefficient>
        <GrowthTminimum>1</GrowthTminimum>
        <GrowthToptimum>20</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>28</HeatOnsetTemperature>
        <HeatFullTemperature>35</HeatFullTemperature>
        <HeatRecoverySumDD>30</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>1</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>25</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.03</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.04</double>
          <double>0.012</double>
          <double>0.05</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.7</FractionLeafMaximum>
        <FractionLeafMinimum>0.7</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0</FractionToStolon>
        <SpecificLeafArea>25</SpecificLeafArea>
        <SpecificRootLength>100</SpecificRootLength>
        <StolonEffectOnLAI>0</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>1000</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>1</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.08</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0</MinimumNFixation>
        <MaximumNFixation>0</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>0.25</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>600</PlantHeightMaximum>
        <PlantHeightMassForMax>10000</PlantHeightMassForMax>
        <PlantHeightExponent>2.8</PlantHeightExponent>
        <RootDepthMinimum>50</RootDepthMinimum>
        <RootDepthMaximum>750</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>90</RootDistributionDepthParam>
        <RootDistributionExponent>3.2</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>100</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <PastureSpecies>
        <Name>WhiteClover</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Legume</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>500</InitialShootDM>
        <InitialRootDM>150</InitialRootDM>
        <InitialRootDepth>350</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
        <GrowthTminimum>2</GrowthTminimum>
        <GrowthToptimum>22</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>30</HeatOnsetTemperature>
        <HeatFullTemperature>36</HeatFullTemperature>
        <HeatRecoverySumDD>20</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>2</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>30</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.045</double>
          <double>0.02</double>
          <double>0.055</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.56</FractionLeafMaximum>
        <FractionLeafMinimum>0.28</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0.2</FractionToStolon>
        <SpecificLeafArea>30</SpecificLeafArea>
        <SpecificRootLength>45</SpecificRootLength>
        <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.11</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0.2</MinimumNFixation>
        <MaximumNFixation>0.6</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>1</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>350</PlantHeightMaximum>
        <PlantHeightMassForMax>7500</PlantHeightMassForMax>
        <PlantHeightExponent>2.5</PlantHeightExponent>
        <RootDepthMinimum>30</RootDepthMinimum>
        <RootDepthMaximum>350</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>70</RootDistributionDepthParam>
        <RootDistributionExponent>2.5</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>50</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <Soil>
        <Name>LismoreSoil</Name>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>10</double>
            <double>40</double>
            <double>60</double>
            <double>70</double>
            <double>70</double>
          </Rocks>
          <Texture />
          <MunsellColour />
          <PH>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
          </PH>
          <CEC>
            <double>12.5</double>
            <double>10</double>
            <double>9</double>
            <double>5</double>
            <double>4</double>
            <double>4</double>
            <double>4</double>
          </CEC>
          <ParticleSizeSand>
            <double>15</double>
            <double>20</double>
            <double>25</double>
            <double>35</double>
            <double>40</double>
            <double>40</double>
            <double>40</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>65</double>
            <double>65</double>
            <double>63</double>
            <double>57</double>
            <double>54</double>
            <double>55</double>
            <double>55</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>20</double>
            <double>15</double>
            <double>12</double>
            <double>8</double>
            <double>6</double>
            <double>5</double>
            <double>5</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>SwardSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>RyegrassSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>WhiteCloverSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>Ryegrass1Soil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.3</double>
            <double>1.35</double>
            <double>1</double>
            <double>0.53</double>
            <double>0.31</double>
            <double>0.3</double>
            <double>0.3</double>
          </BD>
          <AirDry>
            <double>0.05</double>
            <double>0.12</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </AirDry>
          <LL15>
            <double>0.15</double>
            <double>0.14</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </LL15>
          <DUL>
            <double>0.36</double>
            <double>0.34</double>
            <double>0.19</double>
            <double>0.065</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.03</double>
          </DUL>
          <SAT>
            <double>0.45</double>
            <double>0.43</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.11</double>
          </SAT>
          <KS>
            <double>5000</double>
            <double>2500</double>
            <double>3000</double>
            <double>10000</double>
            <double>17500</double>
            <double>20000</double>
            <double>20000</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>6</SummerU>
          <SummerCona>3.5</SummerCona>
          <WinterDate>1-apr</WinterDate>
          <WinterU>2</WinterU>
          <WinterCona>2</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.5</double>
            <double>0.52</double>
            <double>0.55</double>
            <double>0.6</double>
            <double>0.65</double>
            <double>0.65</double>
            <double>0.65</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <residueinterception>0</residueinterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-50</string>
            <string>50-65</string>
            <string>65-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3</double>
            <double>1</double>
            <double>0.6</double>
            <double>0.4</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.7</double>
            <double>0.83</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <InitialWater>
          <Name>Initial water</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>0.95</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Initial nitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2.5</double>
            <double>1</double>
            <double>0.75</double>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.5</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <RecordNumber>0</RecordNumber>
        <SoilType>NZ_Sedimentary</SoilType>
        <LocalName>Lismore</LocalName>
        <Site>Winchmore</Site>
        <NearestTown>Ashburton</NearestTown>
        <Region>Canterbury</Region>
        <Country>New Zealand</Country>
        <NaturalVegetation />
        <Latitude>-48.48</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </SoluteManager>
      <Report>
        <Name>ReportPaddock</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today</string>
          <string>[Ryegrass].AboveGroundWt</string>
          <string>[Ryegrass].HarvestableWt</string>
          <string>[WhiteClover].AboveGroundWt</string>
          <string>[WhiteClover].HarvestableWt</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].EndOfDay</string>
        </EventNames>
      </Report>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Area>160</Area>
      <Slope>0</Slope>
    </Zone>
    <IncludeInDocumentation>true</IncludeInDocumentation>
  </Simulation>
  <Simulation>
    <Name>FeedlotForNeville</Name>
    <Clock>
      <Name>Clock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <StartDate>1999-01-01T00:00:00</StartDate>
      <EndDate>2000-12-31T00:00:00</EndDate>
    </Clock>
    <Summary>
      <Name>SummaryFile</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
    </Summary>
    <Weather>
      <Name>Weather</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <FileName>%root%\Examples\WeatherFiles\lincoln.met</FileName>
      <ExcelWorkSheetName />
    </Weather>
    <Zone>
      <Name>Feedlot</Name>
      <Report>
        <Name>Report</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today</string>
        </VariableNames>
        <EventNames>
          <string />
        </EventNames>
      </Report>
      <Soil>
        <Name>Soil</Name>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>WheatSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.261</double>
              <double>0.248</double>
              <double>0.28</double>
              <double>0.306</double>
              <double>0.36</double>
              <double>0.392</double>
              <double>0.446</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.01056473311131</double>
            <double>1.07145631083388</double>
            <double>1.09393858528057</double>
            <double>1.15861335018721</double>
            <double>1.17301160318016</double>
            <double>1.16287303586874</double>
            <double>1.18749547755906</double>
          </BD>
          <AirDry>
            <double>0.130250054518252</double>
            <double>0.198689390775399</double>
            <double>0.28</double>
            <double>0.28</double>
            <double>0.28</double>
            <double>0.28</double>
            <double>0.28</double>
          </AirDry>
          <LL15>
            <double>0.260500109036505</double>
            <double>0.248361738469248</double>
            <double>0.28</double>
            <double>0.28</double>
            <double>0.28</double>
            <double>0.28</double>
            <double>0.28</double>
          </LL15>
          <DUL>
            <double>0.52100021807301</double>
            <double>0.496723476938497</double>
            <double>0.488437607673005</double>
            <double>0.480296969355493</double>
            <double>0.471583596524955</double>
            <double>0.457070570557793</double>
            <double>0.452331759845006</double>
          </DUL>
          <SAT>
            <double>0.588654817693846</double>
            <double>0.565676863836273</double>
            <double>0.557192986686577</double>
            <double>0.532787415023694</double>
            <double>0.527354112007486</double>
            <double>0.531179986464627</double>
            <double>0.521888499034317</double>
          </SAT>
          <KS>
            <double>20</double>
            <double>20</double>
            <double>20</double>
            <double>20</double>
            <double>20</double>
            <double>20</double>
            <double>20</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>5</SummerU>
          <SummerCona>5</SummerCona>
          <WinterDate>1-Apr</WinterDate>
          <WinterU>5</WinterU>
          <WinterCona>5</WinterCona>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>NaN</slope>
          <discharge_width>NaN</discharge_width>
          <catchment_area>NaN</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
          <residueinterception>0</residueinterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-60</string>
            <string>60-90</string>
            <string>90-120</string>
            <string>120-150</string>
            <string>150-180</string>
          </Depth>
          <OC>
            <double>1.2</double>
            <double>0.96</double>
            <double>0.6</double>
            <double>0.3</double>
            <double>0.18</double>
            <double>0.12</double>
            <double>0.12</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8</double>
            <double>8</double>
            <double>8</double>
            <double>8</double>
            <double>8</double>
            <double>8</double>
            <double>8</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <InitialWater>
          <Name>InitialWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>1</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>InitialN</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <SW>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
          </SW>
          <OC>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
          </OC>
          <EC>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <CL>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
          </CL>
          <ESP>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
          </ESP>
          <PH>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
            <double>NaN</double>
          </PH>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <RecordNumber>0</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder>Black</ASCSubOrder>
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Norwin</Site>
        <NearestTown>Norwin</NearestTown>
        <Region>Darling Downs and Granite Belt</Region>
        <State>Queensland</State>
        <Country>Australia</Country>
        <NaturalVegetation>Qld. Bluegrass, possible Qld. Blue gum</NaturalVegetation>
        <ApsoilNumber>900</ApsoilNumber>
        <Latitude>-27.581836</Latitude>
        <Longitude>151.320206</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <DataSource>CSIRO Sustainable Ecosystems, Toowoomba; Characteriesd as part of the GRDC funded project"Doing it better, doing it smarter, managing soil water in Australian agriculture' 2011</DataSource>
        <Comments>OC, CLL for all crops estimated-based on Bongeen Mywybilla Soil No1</Comments>
      </Soil>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ResidueTypes>
          <Name>ResidueTypes</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <LoadFromResource>ResidueTypes</LoadFromResource>
        </ResidueTypes>
        <Pools>
          <Pool>
            <PoolName>wheat_stubble</PoolName>
            <ResidueType>wheat</ResidueType>
            <Mass>0</Mass>
            <CNRatio>100</CNRatio>
            <CPRatio>NaN</CPRatio>
            <StandingFraction>0</StandingFraction>
          </Pool>
        </Pools>
        <PoolName>wheat_stubble</PoolName>
        <type>wheat</type>
        <mass>0</mass>
        <standing_fraction>0</standing_fraction>
        <cpr />
        <cnr>100</cnr>
        <CriticalResidueWeight>2000</CriticalResidueWeight>
        <OptimumDecompTemp>20</OptimumDecompTemp>
        <MaxCumulativeEOS>20</MaxCumulativeEOS>
        <CNRatioDecompCoeff>0.277</CNRatioDecompCoeff>
        <CNRatioDecompThreshold>25</CNRatioDecompThreshold>
        <TotalLeachRain>25</TotalLeachRain>
        <MinRainToLeach>10</MinRainToLeach>
        <CriticalMinimumOrganicC>0.004</CriticalMinimumOrganicC>
        <DefaultCPRatio>0</DefaultCPRatio>
        <DefaultStandingFraction>0</DefaultStandingFraction>
        <StandingExtinctCoeff>0.5</StandingExtinctCoeff>
        <FractionFaecesAdded>0.5</FractionFaecesAdded>
      </SurfaceOrganicMatter>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <a_interception>0</a_interception>
        <b_interception>1</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.3</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.15</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </SoluteManager>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Area>10</Area>
      <Slope>0</Slope>
    </Zone>
    <Supplement>
      <Name>Supplement</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <SpoilageTime>0</SpoilageTime>
      <stores>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>0.85</DMContent>
          <DMD>0</DMD>
          <MEContent>0</MEContent>
          <CPConc>0</CPConc>
          <ProtDg>0</ProtDg>
          <PConc>0</PConc>
          <SConc>0</SConc>
          <EEConc>0</EEConc>
          <ADIP2CP>0</ADIP2CP>
          <AshAlk>0</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>fodder</Name>
          <Stored>0</Stored>
        </StoreType>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>0.25</DMContent>
          <DMD>0.75</DMD>
          <MEContent>12</MEContent>
          <CPConc>0.18</CPConc>
          <ProtDg>0.8</ProtDg>
          <PConc>0.0032</PConc>
          <SConc>0.0024</SConc>
          <EEConc>0.02</EEConc>
          <ADIP2CP>0.06</ADIP2CP>
          <AshAlk>0.6</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>silage</Name>
          <Stored>200000</Stored>
        </StoreType>
      </stores>
      <PaddockList />
    </Supplement>
    <Stock>
      <Name>Stock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <RandSeed>9999</RandSeed>
      <GenoTypes />
      <Sheep />
      <Cattle />
      <PaddockList>
        <PaddockInit>
          <Forages />
          <Name />
          <Area>1</Area>
          <Slope>0</Slope>
        </PaddockInit>
      </PaddockList>
      <EnterpriseList />
      <GrazingPeriods />
    </Stock>
    <Manager>
      <Name>ManageStock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Script />
      <Code><![CDATA[using System;
using Models.Core;
using Models.Utilities;
using Models.GrazPlan;
using APSIM.Shared.Utilities;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Stock Cows;
        [Link] Supplement Feed;

        private double sale_age = 3.0;
        private int no_to_buy;
        private int group_count;
        private int g;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
                g = Cows.NoGroups + 1;
                no_to_buy = 30;
                
                StockBuy purchase = new StockBuy();
                purchase.Genotype = "Friesian";
                purchase.Number = no_to_buy;
                purchase.Sex = "heifers";
                purchase.Age = 24;
                purchase.Weight = 550.0;
                purchase.UseTag = g + 1;
                purchase.MatedTo = "Friesian";
                purchase.Pregnant = 0;  // days pregnant
                purchase.Lactating = 1;
                purchase.NumYoung = 1;
                purchase.YoungWt = 45;
                
                Cows.Buy(purchase);
                Cows.Move(g, "Feedlot");
        }
                                
        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            // purchase animals annually
            if (DateUtilities.DatesEqual("01 JAN", Clock.Today))
            {
            }

            if (Cows.NumberAll > 0)
                Feed.Feed("Silage", 20.0 * Cows.NumberAll, "Feedlot");
        }
    }
}
]]></Code>
    </Manager>
    <Report>
      <Name>Report1</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <ExperimentFactorNames />
      <ExperimentFactorValues />
      <VariableNames>
        <string>[Clock].Today</string>
        <string>[Stock].NumberAll</string>
        <string>[Stock].WeightAll</string>
        <string>[Stock].CondScoreAll</string>
        <string>[Stock].IntakeAll.Weight</string>
        <string>[Stock].IntakeAll.N</string>
        <string>[Stock].UrineNAll</string>
        <string>[Stock].FaecesAll.N</string>
        <string>[Stock].MilkWtAll</string>
        <string>[Supplement].stores[2].Name</string>
        <string>[Supplement].stores[2].Stored</string>
      </VariableNames>
      <EventNames>
        <string>[Clock].EndOfDay</string>
      </EventNames>
    </Report>
    <Graph>
      <Name>NumbersAll</Name>
      <Series>
        <Name>Series1</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <Checkpoint>Current</Checkpoint>
        <TableName>Report1</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Stock.NumberAll</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <IncludeInDocumentation>false</IncludeInDocumentation>
      <Axis>
        <Type>Bottom</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Left</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <LegendPosition>TopLeft</LegendPosition>
      <DisabledSeries />
    </Graph>
    <Graph>
      <Name>WeightAll</Name>
      <Series>
        <Name>Series1</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Right</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <Checkpoint>Current</Checkpoint>
        <TableName>Report1</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Stock.WeightAll</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>Series11</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16736653</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <Checkpoint>Current</Checkpoint>
        <TableName>Report1</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Stock.MilkWtAll</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <IncludeInDocumentation>false</IncludeInDocumentation>
      <Axis>
        <Type>Bottom</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Left</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Right</Type>
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <LegendPosition>TopLeft</LegendPosition>
      <DisabledSeries />
    </Graph>
    <Graph>
      <Name>CondScoreAll</Name>
      <Series>
        <Name>Series1</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <Checkpoint>Current</Checkpoint>
        <TableName>Report1</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Stock.CondScoreAll</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <IncludeInDocumentation>false</IncludeInDocumentation>
      <Axis>
        <Type>Bottom</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Left</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <LegendPosition>TopLeft</LegendPosition>
      <DisabledSeries />
    </Graph>
    <Graph>
      <Name>FleeceWt1</Name>
      <Series>
        <Name>Weight</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <Checkpoint>Current</Checkpoint>
        <TableName>Report1</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Stock.FleeceWt1</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <Series>
        <Name>Micron</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Right</YAxis>
        <ColourArgb>-16736653</ColourArgb>
        <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <Checkpoint>Current</Checkpoint>
        <TableName>Report1</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Stock.FibreDiam1</YFieldName>
        <ShowInLegend>false</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <IncludeInDocumentation>false</IncludeInDocumentation>
      <Axis>
        <Type>Bottom</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Left</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Right</Type>
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <LegendPosition>TopLeft</LegendPosition>
      <DisabledSeries />
    </Graph>
    <IncludeInDocumentation>true</IncludeInDocumentation>
  </Simulation>
  <Simulation>
    <Name>GetCowsMilking</Name>
    <Clock>
      <Name>Clock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <StartDate>2000-08-01T00:00:00</StartDate>
      <EndDate>2001-07-31T00:00:00</EndDate>
    </Clock>
    <Summary>
      <Name>SummaryFile</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
    </Summary>
    <Weather>
      <Name>Weather</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <FileName>%root%\Examples\WeatherFiles\lincoln.met</FileName>
      <ExcelWorkSheetName />
    </Weather>
    <Stock>
      <Name>Stock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <RandSeed>9999</RandSeed>
      <GenoTypes />
      <Sheep />
      <Cattle />
      <PaddockList>
        <PaddockInit>
          <Forages />
          <Name />
          <Area>1</Area>
          <Slope>0</Slope>
        </PaddockInit>
      </PaddockList>
      <EnterpriseList />
      <GrazingPeriods />
    </Stock>
    <Manager>
      <Name>ManageStock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Script />
      <Code><![CDATA[using System;
using Models.Core;
using Models.Utilities;
using Models.GrazPlan;
using APSIM.Shared.Utilities;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Stock Cows;
        [Link] Supplement Feed;

        private double sale_age = 3.0;
        private int no_to_buy;
        private int group_count;
        private int g;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
                g = Cows.NoGroups + 1;
                no_to_buy = 30;
                
                StockBuy purchase = new StockBuy();
                purchase.Genotype = "Friesian";
                purchase.Number = no_to_buy;
                purchase.Sex = "heifers";
                purchase.Age = 24;
                purchase.Weight = 550.0;
                purchase.UseTag = g + 1;
                purchase.MatedTo = "Friesian";
                purchase.Pregnant = 0;  // days pregnant
                purchase.Lactating = 1;
                purchase.NumYoung = 2;
                purchase.YoungWt = 45;
                
                Cows.Buy(purchase);
                Cows.Move(g, "Paddock00");
        }
                                
        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            // purchase animals annually
            if (DateUtilities.DatesEqual("01 JAN", Clock.Today))
            {
            }

            if (Cows.NumberAll > 0)
                Feed.Feed("Silage", 20.0 * Cows.NumberAll, "Paddock00");
        }
    }
}
]]></Code>
    </Manager>
    <Supplement>
      <Name>Supplement</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <SpoilageTime>0</SpoilageTime>
      <stores>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>0.85</DMContent>
          <DMD>0</DMD>
          <MEContent>0</MEContent>
          <CPConc>0</CPConc>
          <ProtDg>0</ProtDg>
          <PConc>0</PConc>
          <SConc>0</SConc>
          <EEConc>0</EEConc>
          <ADIP2CP>0</ADIP2CP>
          <AshAlk>0</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>fodder</Name>
          <Stored>0</Stored>
        </StoreType>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>0.25</DMContent>
          <DMD>0.75</DMD>
          <MEContent>12</MEContent>
          <CPConc>0.18</CPConc>
          <ProtDg>0.8</ProtDg>
          <PConc>0.0032</PConc>
          <SConc>0.0024</SConc>
          <EEConc>0.02</EEConc>
          <ADIP2CP>0.06</ADIP2CP>
          <AshAlk>0.6</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>silage</Name>
          <Stored>200000</Stored>
        </StoreType>
      </stores>
      <PaddockList />
    </Supplement>
    <Zone>
      <Name>Paddock00</Name>
      <Folder>
        <Name>Managers</Name>
        <Manager>
          <Name>AutomaticFertiliser</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <AllowFertiliser>yes</AllowFertiliser>
            <Depth2SoilN>500</Depth2SoilN>
            <CriticalSoilN>5</CriticalSoilN>
            <FertNAmount>25</FertNAmount>
            <FertType>UreaN</FertType>
            <FertApplicationDepth>1</FertApplicationDepth>
            <FertMinimumDays>15</FertMinimumDays>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Fertiliser fertiliser;
        [Link] ISummary summary = null;
        [Link] Soil Soil;

        //User inputs from properties tab
        [Description("Turn ferliser applications on? ")]
        public yesnoType AllowFertiliser { get; set; }
        
        [Description("Depth to calculate available soil N (mm): ")]
        public double Depth2SoilN { get; set; }

        [Description("Minimum available N, triggers an application (kgN/ha): ")]
        public double CriticalSoilN { get; set; }

        [Description("Amount of N fertiliser for each application (kgN/ha): ")]
        public double FertNAmount { get; set; }

        [Description("Type of N fertiliser to apply: ")]
        public Fertiliser.Types FertType { get; set; }

        [Description("Depth at which to apply the fertiliser (mm): ")]
        public double FertApplicationDepth { get; set; }
       
        [Description("Minimum period between applications (days): ")]
        public double FertMinimumDays { get; set; }
       
        public enum yesnoType
        {
            /// <summary>a positive answer</summary>
            yes,
            /// <summary>a negative answer</summary>
            no
        }

        [XmlIgnore] public double TopMineralN { get; set; }
        
        private DateTime lastApplicationDate;
        private bool fertiliserIsAllowed;
        private int nLayers;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            fertiliserIsAllowed = (AllowFertiliser == yesnoType.yes);
            nLayers = Soil.Thickness.Length;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            double daysSinceLastApplication = (Clock.Today - lastApplicationDate).TotalDays;
            
            // get the N stored in the soil
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopMineralN = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (Depth2SoilN - depthFromSurface) / Soil.Thickness[layer]);
                TopMineralN += (Soil.SoilNitrogen.NO3[layer]
                + Soil.SoilNitrogen.NH4[layer]
                + Soil.SoilNitrogen.urea[layer])
                * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= Depth2SoilN)
                    layer = nLayers;
            }

            if (fertiliserIsAllowed && (daysSinceLastApplication >= FertMinimumDays) && (TopMineralN <= CriticalSoilN))
            {
                fertiliser.Apply(FertNAmount, FertType, FertApplicationDepth);
                lastApplicationDate = Clock.Today;
            }
        }
    }
}
]]></Code>
        </Manager>
        <Manager>
          <Name>AutomaticIrrigation</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <allowIrrigation>True</allowIrrigation>
            <seasonStart>15-Aug</seasonStart>
            <seasonEnd>30-May</seasonEnd>
            <seasonsAllocation>10000</seasonsAllocation>
            <triggerDeficit>75</triggerDeficit>
            <targetDeficit>99</targetDeficit>
            <returndays>1</returndays>
            <maximumAmount>30</maximumAmount>
            <depthPAWC>300</depthPAWC>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using System.Xml.Serialization;
using Models.PMF;
using APSIM.Shared.Utilities;

        
namespace Models
{
    [Serializable] 
    [System.Xml.Serialization.XmlInclude(typeof(Model))]
    public class Script : Model
    {
        //Communication to other modules
        [Link] ISummary summary = null;
        [Link] Irrigation Irrigation;
        [Link] Clock Clock;
        [Link] Soil Soil;
        [Link(IsOptional = true)] IPlant existingCrop;
       
        //User inputs from properties tab
        [Description("Turn irrigation on?")]
        public bool allowIrrigation { get; set; }
        [Description("Start of irrigation season (dd-MMM)")]
        public string seasonStart { get; set; }
        [Description("End of irrigation season (dd-MMM)")]
        public string seasonEnd { get; set; }
        [Description("Season allocation (mm)")]
        public double seasonsAllocation { get; set; }
        [Description("Deficit to trigger irrigation (% PAWC)")]
        public double triggerDeficit { get; set; }
        [Description("Deficit to stop irrigaton (% PAWC)")]
        public double targetDeficit { get; set; }
        [Description("Minimum days for irrigation to return")]
        public double returndays { get; set; }
        [Description("Maximum irrigation application (mm/day)")]
        public double maximumAmount { get; set; }
        [Description("Depth to calculate PAWC (mm)")]
        public double depthPAWC { get; set; }

        //Class members
        [XmlIgnore] public double TopSWdeficit { get; set; }
        [XmlIgnore] public double TopSWC { get; set; }
        [XmlIgnore] public double DaysSinceIrrigation { get; set; }
        [XmlIgnore] public double AmountToApply { get; set; }
        [XmlIgnore] public double SeasonAppliedAmount { get; set; }
        
        private bool IrrigationIsAllowed { get; set; }
        private bool SeasonIsOpen { get; set; }
        private bool CropIsActive { get; set; }
        private bool IrrigatorIsAvailable { get; set; }
        private bool SoilIsDry { get; set; }

        private DateTime StartDate;
        private DateTime EndDate;
        private double TopDUL;
        private double TopLL;
        private int nLayers;
    
        //Calculate static soil variables
        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {   
            //Set the season dates
            StartDate = DateTime.Parse(seasonStart + "-" + Clock.Today.Year.ToString());
            EndDate = DateTime.Parse(seasonEnd + "-" + Clock.Today.Year.ToString());
            
            //Can we irrigate at all?
            IrrigationIsAllowed = false; 
            if (allowIrrigation)
                IrrigationIsAllowed = true; 

            //Calculate soil water variables
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            nLayers = Soil.Thickness.Length;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopLL += Soil.LL15mm[layer] * fracLayer;
                TopDUL += Soil.DULmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
        }
             
        //Determine daily requirement for irrigation
        [EventSubscribe("StartOfDay")]
        private void OnStartOfDay(object sender, EventArgs e)
        {
            //Can we irrigate today?          
            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);

            //Is there a crop in the ground that needs irrigation?
            CropIsActive = false;
            if ((existingCrop != null) && (existingCrop.IsAlive))
                CropIsActive = true;
            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))
          
            //Is the irrigator available?
            IrrigatorIsAvailable = false;
            DaysSinceIrrigation += 1;
            if (DaysSinceIrrigation >= returndays)
                IrrigatorIsAvailable = true;
          
            //Is the soil dry enough to require irrigation?
            SoilIsDry = false;
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopSWC = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            //for (int layer = 0; depthFromSurface < depthPAWC + Soil.Thickness[layer]; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopSWC += Soil.SoilWater.SWmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
            
            TopSWdeficit = TopSWC - TopDUL;
            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)
                SoilIsDry = true;
                
            //Are all the conditions ratifying irrigation
            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)
            {
                //Lets bloody well irrigate then!!!!
                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;
                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));
                Irrigation.Apply(AmountToApply);
                DaysSinceIrrigation = 0;
                SeasonAppliedAmount += AmountToApply;
            }
        }
        
        ///Checks whether theDate is between iniDate and endDate (non-year specific)
        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)
        {
            bool result = false;
            if (iniDate.DayOfYear < endDate.DayOfYear)
            {
                // period is within one year, ex: summer in the northern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            else
            {
                // period goes over the end of the year, ex: summer in the southern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            
            return result;
        }
    }
}
]]></Code>
        </Manager>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ShowPageOfGraphs>true</ShowPageOfGraphs>
      </Folder>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <a_interception>0</a_interception>
        <b_interception>0</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.29366217672824863</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Fertiliser>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ReportAdditions>no</ReportAdditions>
        <ReportRemovals>no</ReportRemovals>
        <ResidueTypes>
          <Name>ResidueTypes</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <LoadFromResource>ResidueTypes</LoadFromResource>
        </ResidueTypes>
        <TillageTypes>
          <Name>TillageTypesList</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <TillageType />
        </TillageTypes>
        <Pools>
          <Pool>
            <PoolName>Sward</PoolName>
            <ResidueType>grass</ResidueType>
            <Mass>1000</Mass>
            <CNRatio>15</CNRatio>
            <CPRatio>NaN</CPRatio>
            <StandingFraction>0</StandingFraction>
          </Pool>
        </Pools>
        <PoolName>Sward</PoolName>
        <type>grass</type>
        <mass>1000</mass>
        <standing_fraction>0</standing_fraction>
        <cpr />
        <cnr>15</cnr>
        <CriticalResidueWeight>2000</CriticalResidueWeight>
        <OptimumDecompTemp>20</OptimumDecompTemp>
        <MaxCumulativeEOS>20</MaxCumulativeEOS>
        <CNRatioDecompCoeff>0.277</CNRatioDecompCoeff>
        <CNRatioDecompThreshold>25</CNRatioDecompThreshold>
        <TotalLeachRain>25</TotalLeachRain>
        <MinRainToLeach>10</MinRainToLeach>
        <CriticalMinimumOrganicC>0.004</CriticalMinimumOrganicC>
        <DefaultCPRatio>0</DefaultCPRatio>
        <DefaultStandingFraction>0</DefaultStandingFraction>
        <StandingExtinctCoeff>0.5</StandingExtinctCoeff>
        <FractionFaecesAdded>0.5</FractionFaecesAdded>
      </SurfaceOrganicMatter>
      <Soil>
        <Name>LismoreSoil</Name>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>10</double>
            <double>40</double>
            <double>60</double>
            <double>70</double>
            <double>70</double>
          </Rocks>
          <Texture />
          <MunsellColour />
          <PH>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
          </PH>
          <CEC>
            <double>12.5</double>
            <double>10</double>
            <double>9</double>
            <double>5</double>
            <double>4</double>
            <double>4</double>
            <double>4</double>
          </CEC>
          <ParticleSizeSand>
            <double>15</double>
            <double>20</double>
            <double>25</double>
            <double>35</double>
            <double>40</double>
            <double>40</double>
            <double>40</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>65</double>
            <double>65</double>
            <double>63</double>
            <double>57</double>
            <double>54</double>
            <double>55</double>
            <double>55</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>20</double>
            <double>15</double>
            <double>12</double>
            <double>8</double>
            <double>6</double>
            <double>5</double>
            <double>5</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>SwardSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>RyegrassSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>WhiteCloverSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.3</double>
            <double>1.35</double>
            <double>1</double>
            <double>0.53</double>
            <double>0.31</double>
            <double>0.3</double>
            <double>0.3</double>
          </BD>
          <AirDry>
            <double>0.05</double>
            <double>0.12</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </AirDry>
          <LL15>
            <double>0.15</double>
            <double>0.14</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </LL15>
          <DUL>
            <double>0.36</double>
            <double>0.34</double>
            <double>0.19</double>
            <double>0.065</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.03</double>
          </DUL>
          <SAT>
            <double>0.45</double>
            <double>0.43</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.11</double>
          </SAT>
          <KS>
            <double>5000</double>
            <double>2500</double>
            <double>3000</double>
            <double>10000</double>
            <double>17500</double>
            <double>20000</double>
            <double>20000</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>6</SummerU>
          <SummerCona>3.5</SummerCona>
          <WinterDate>1-apr</WinterDate>
          <WinterU>2</WinterU>
          <WinterCona>2</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.5</double>
            <double>0.52</double>
            <double>0.55</double>
            <double>0.6</double>
            <double>0.65</double>
            <double>0.65</double>
            <double>0.65</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <residueinterception>0</residueinterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-50</string>
            <string>50-65</string>
            <string>65-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3</double>
            <double>1</double>
            <double>0.6</double>
            <double>0.4</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.7</double>
            <double>0.83</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <InitialWater>
          <Name>Initial water</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>0.95</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Initial nitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2.5</double>
            <double>1</double>
            <double>0.75</double>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.5</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <RecordNumber>0</RecordNumber>
        <SoilType>NZ_Sedimentary</SoilType>
        <LocalName>Lismore</LocalName>
        <Site>Winchmore</Site>
        <NearestTown>Ashburton</NearestTown>
        <Region>Canterbury</Region>
        <Country>New Zealand</Country>
        <NaturalVegetation />
        <Latitude>-48.48</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <Sward>
        <Name>Sward</Name>
        <PastureSpecies>
          <Name>Ryegrass</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <MaximumNUptake>10</MaximumNUptake>
          <Albedo>0.26</Albedo>
          <Gsmax>0.011</Gsmax>
          <R50>200</R50>
          <SpeciesFamily>Grass</SpeciesFamily>
          <PhotosyntheticPathway>C3</PhotosyntheticPathway>
          <InitialShootDM>1500</InitialShootDM>
          <InitialRootDM>450</InitialRootDM>
          <InitialRootDepth>750</InitialRootDepth>
          <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
          <LightExtinctionCoefficient>0.5</LightExtinctionCoefficient>
          <GrowthTminimum>1</GrowthTminimum>
          <GrowthToptimum>20</GrowthToptimum>
          <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
          <UseHeatStressFactor>yes</UseHeatStressFactor>
          <HeatOnsetTemperature>28</HeatOnsetTemperature>
          <HeatFullTemperature>35</HeatFullTemperature>
          <HeatRecoverySumDD>30</HeatRecoverySumDD>
          <HeatRecoveryTReference>25</HeatRecoveryTReference>
          <UseColdStressFactor>yes</UseColdStressFactor>
          <ColdOnsetTemperature>1</ColdOnsetTemperature>
          <ColdFullTemperature>-5</ColdFullTemperature>
          <ColdRecoverySumDD>25</ColdRecoverySumDD>
          <ColdRecoveryTReference>0</ColdRecoveryTReference>
          <MaintenanceRespirationCoefficient>0.03</MaintenanceRespirationCoefficient>
          <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
          <RespirationTReference>20</RespirationTReference>
          <RespirationExponent>1.5</RespirationExponent>
          <NThresholdsForLeaves>
            <double>0.04</double>
            <double>0.012</double>
            <double>0.05</double>
          </NThresholdsForLeaves>
          <NThresholdsForStems>
            <double>0.02</double>
            <double>0.006</double>
            <double>0.025</double>
          </NThresholdsForStems>
          <NThresholdsForStolons>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NThresholdsForStolons>
          <NThresholdsForRoots>
            <double>0.02</double>
            <double>0.006</double>
            <double>0.025</double>
          </NThresholdsForRoots>
          <DegreesDayForGermination>125</DegreesDayForGermination>
          <TargetShootRootRatio>4</TargetShootRootRatio>
          <MaxRootAllocation>0.25</MaxRootAllocation>
          <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
          <UseReproSeasonFactor>yes</UseReproSeasonFactor>
          <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
          <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
          <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
          <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
          <FractionLeafMaximum>0.7</FractionLeafMaximum>
          <FractionLeafMinimum>0.7</FractionLeafMinimum>
          <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
          <FractionLeafDMFactor>2000</FractionLeafDMFactor>
          <FractionLeafExponent>3</FractionLeafExponent>
          <FractionToStolon>0</FractionToStolon>
          <SpecificLeafArea>25</SpecificLeafArea>
          <SpecificRootLength>100</SpecificRootLength>
          <StolonEffectOnLAI>0</StolonEffectOnLAI>
          <ShootMaxEffectOnLAI>1000</ShootMaxEffectOnLAI>
          <MaxStemEffectOnLAI>1</MaxStemEffectOnLAI>
          <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
          <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
          <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
          <DetachmentRateShoot>0.08</DetachmentRateShoot>
          <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
          <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
          <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
          <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
          <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
          <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
          <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
          <FractionNLuxuryRemobilisable>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </FractionNLuxuryRemobilisable>
          <MinimumNFixation>0</MinimumNFixation>
          <MaximumNFixation>0</MaximumNFixation>
          <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
          <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
          <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
          <NDillutionCoefficient>0.25</NDillutionCoefficient>
          <GlfGeneric>1</GlfGeneric>
          <GlfSoilFertility>1</GlfSoilFertility>
          <PlantHeightMinimum>25</PlantHeightMinimum>
          <PlantHeightMaximum>600</PlantHeightMaximum>
          <PlantHeightMassForMax>10000</PlantHeightMassForMax>
          <PlantHeightExponent>2.8</PlantHeightExponent>
          <RootDepthMinimum>50</RootDepthMinimum>
          <RootDepthMaximum>750</RootDepthMaximum>
          <RootElongationRate>25</RootElongationRate>
          <RootDistributionDepthParam>90</RootDistributionDepthParam>
          <RootDistributionExponent>3.2</RootDistributionExponent>
          <DigestibilitiesCellWall>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.2</double>
          </DigestibilitiesCellWall>
          <MinimumGreenWt>100</MinimumGreenWt>
          <FractionStolonStanding>0</FractionStolonStanding>
          <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
          <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
          <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
          <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
        </PastureSpecies>
        <PastureSpecies>
          <Name>WhiteClover</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <MaximumNUptake>10</MaximumNUptake>
          <Albedo>0.26</Albedo>
          <Gsmax>0.011</Gsmax>
          <R50>200</R50>
          <SpeciesFamily>Legume</SpeciesFamily>
          <PhotosyntheticPathway>C3</PhotosyntheticPathway>
          <InitialShootDM>500</InitialShootDM>
          <InitialRootDM>150</InitialRootDM>
          <InitialRootDepth>350</InitialRootDepth>
          <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
          <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
          <GrowthTminimum>2</GrowthTminimum>
          <GrowthToptimum>22</GrowthToptimum>
          <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
          <UseHeatStressFactor>yes</UseHeatStressFactor>
          <HeatOnsetTemperature>30</HeatOnsetTemperature>
          <HeatFullTemperature>36</HeatFullTemperature>
          <HeatRecoverySumDD>20</HeatRecoverySumDD>
          <HeatRecoveryTReference>25</HeatRecoveryTReference>
          <UseColdStressFactor>yes</UseColdStressFactor>
          <ColdOnsetTemperature>2</ColdOnsetTemperature>
          <ColdFullTemperature>-5</ColdFullTemperature>
          <ColdRecoverySumDD>30</ColdRecoverySumDD>
          <ColdRecoveryTReference>0</ColdRecoveryTReference>
          <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
          <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
          <RespirationTReference>20</RespirationTReference>
          <RespirationExponent>1.5</RespirationExponent>
          <NThresholdsForLeaves>
            <double>0.045</double>
            <double>0.02</double>
            <double>0.055</double>
          </NThresholdsForLeaves>
          <NThresholdsForStems>
            <double>0.0225</double>
            <double>0.01</double>
            <double>0.0275</double>
          </NThresholdsForStems>
          <NThresholdsForStolons>
            <double>0.0225</double>
            <double>0.01</double>
            <double>0.0275</double>
          </NThresholdsForStolons>
          <NThresholdsForRoots>
            <double>0.0225</double>
            <double>0.01</double>
            <double>0.0275</double>
          </NThresholdsForRoots>
          <DegreesDayForGermination>125</DegreesDayForGermination>
          <TargetShootRootRatio>4</TargetShootRootRatio>
          <MaxRootAllocation>0.25</MaxRootAllocation>
          <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
          <UseReproSeasonFactor>yes</UseReproSeasonFactor>
          <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
          <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
          <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
          <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
          <FractionLeafMaximum>0.56</FractionLeafMaximum>
          <FractionLeafMinimum>0.28</FractionLeafMinimum>
          <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
          <FractionLeafDMFactor>2000</FractionLeafDMFactor>
          <FractionLeafExponent>3</FractionLeafExponent>
          <FractionToStolon>0.2</FractionToStolon>
          <SpecificLeafArea>30</SpecificLeafArea>
          <SpecificRootLength>45</SpecificRootLength>
          <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
          <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
          <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
          <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
          <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
          <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
          <DetachmentRateShoot>0.11</DetachmentRateShoot>
          <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
          <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
          <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
          <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
          <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
          <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
          <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
          <FractionNLuxuryRemobilisable>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </FractionNLuxuryRemobilisable>
          <MinimumNFixation>0.2</MinimumNFixation>
          <MaximumNFixation>0.6</MaximumNFixation>
          <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
          <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
          <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
          <NDillutionCoefficient>1</NDillutionCoefficient>
          <GlfGeneric>1</GlfGeneric>
          <GlfSoilFertility>1</GlfSoilFertility>
          <PlantHeightMinimum>25</PlantHeightMinimum>
          <PlantHeightMaximum>350</PlantHeightMaximum>
          <PlantHeightMassForMax>7500</PlantHeightMassForMax>
          <PlantHeightExponent>2.5</PlantHeightExponent>
          <RootDepthMinimum>30</RootDepthMinimum>
          <RootDepthMaximum>350</RootDepthMaximum>
          <RootElongationRate>25</RootElongationRate>
          <RootDistributionDepthParam>70</RootDistributionDepthParam>
          <RootDistributionExponent>2.5</RootDistributionExponent>
          <DigestibilitiesCellWall>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.2</double>
          </DigestibilitiesCellWall>
          <MinimumGreenWt>50</MinimumGreenWt>
          <FractionStolonStanding>0</FractionStolonStanding>
          <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
          <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
          <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
          <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
        </PastureSpecies>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ControlledBySward>yes</ControlledBySward>
        <WaterUptakeSource>soilarbitrator</WaterUptakeSource>
        <NUptakeSource>soilarbitrator</NUptakeSource>
      </Sward>
      <Report>
        <Name>Results</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today as Date</string>
          <string>[Sward].Name as Sward.Name</string>
          <string>[Sward].TotalWt as Sward.TotalWt</string>
          <string>[Sward].AboveGroundWt as Sward.AboveGroundWt</string>
          <string>[Sward].BelowGroundWt as Sward.BelowGroundWt</string>
          <string>[Sward].StandingHerbageWt as Sward.StandingHerbageWt</string>
          <string>[Sward].HarvestableWt as Sward.HarvestableWt</string>
          <string>[Sward].HarvestedWt as Sward.HarvestedWt</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].EndOfDay</string>
        </EventNames>
      </Report>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </SoluteManager>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Area>1</Area>
      <Slope>0</Slope>
    </Zone>
    <Zone>
      <Name>Paddock01</Name>
      <Folder>
        <Name>Managers</Name>
        <Manager>
          <Name>AutomaticFertiliser</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <AllowFertiliser>yes</AllowFertiliser>
            <Depth2SoilN>500</Depth2SoilN>
            <CriticalSoilN>5</CriticalSoilN>
            <FertNAmount>25</FertNAmount>
            <FertType>UreaN</FertType>
            <FertApplicationDepth>1</FertApplicationDepth>
            <FertMinimumDays>15</FertMinimumDays>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Fertiliser fertiliser;
        [Link] ISummary summary = null;
        [Link] Soil Soil;

        //User inputs from properties tab
        [Description("Turn ferliser applications on? ")]
        public yesnoType AllowFertiliser { get; set; }
        
        [Description("Depth to calculate available soil N (mm): ")]
        public double Depth2SoilN { get; set; }

        [Description("Minimum available N, triggers an application (kgN/ha): ")]
        public double CriticalSoilN { get; set; }

        [Description("Amount of N fertiliser for each application (kgN/ha): ")]
        public double FertNAmount { get; set; }

        [Description("Type of N fertiliser to apply: ")]
        public Fertiliser.Types FertType { get; set; }

        [Description("Depth at which to apply the fertiliser (mm): ")]
        public double FertApplicationDepth { get; set; }
       
        [Description("Minimum period between applications (days): ")]
        public double FertMinimumDays { get; set; }
       
        public enum yesnoType
        {
            /// <summary>a positive answer</summary>
            yes,
            /// <summary>a negative answer</summary>
            no
        }

        [XmlIgnore] public double TopMineralN { get; set; }
        
        private DateTime lastApplicationDate;
        private bool fertiliserIsAllowed;
        private int nLayers;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            fertiliserIsAllowed = (AllowFertiliser == yesnoType.yes);
            nLayers = Soil.Thickness.Length;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            double daysSinceLastApplication = (Clock.Today - lastApplicationDate).TotalDays;
            
            // get the N stored in the soil
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopMineralN = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (Depth2SoilN - depthFromSurface) / Soil.Thickness[layer]);
                TopMineralN += (Soil.SoilNitrogen.NO3[layer]
                + Soil.SoilNitrogen.NH4[layer]
                + Soil.SoilNitrogen.urea[layer])
                * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= Depth2SoilN)
                    layer = nLayers;
            }

            if (fertiliserIsAllowed && (daysSinceLastApplication >= FertMinimumDays) && (TopMineralN <= CriticalSoilN))
            {
                fertiliser.Apply(FertNAmount, FertType, FertApplicationDepth);
                lastApplicationDate = Clock.Today;
            }
        }
    }
}
]]></Code>
        </Manager>
        <Manager>
          <Name>AutomaticIrrigation</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <allowIrrigation>True</allowIrrigation>
            <seasonStart>15-Aug</seasonStart>
            <seasonEnd>30-May</seasonEnd>
            <seasonsAllocation>10000</seasonsAllocation>
            <triggerDeficit>75</triggerDeficit>
            <targetDeficit>99</targetDeficit>
            <returndays>1</returndays>
            <maximumAmount>30</maximumAmount>
            <depthPAWC>300</depthPAWC>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using System.Xml.Serialization;
using Models.PMF;
using APSIM.Shared.Utilities;

        
namespace Models
{
    [Serializable] 
    [System.Xml.Serialization.XmlInclude(typeof(Model))]
    public class Script : Model
    {
        //Communication to other modules
        [Link] ISummary summary = null;
        [Link] Irrigation Irrigation;
        [Link] Clock Clock;
        [Link] Soil Soil;
        [Link(IsOptional = true)] IPlant existingCrop;
       
        //User inputs from properties tab
        [Description("Turn irrigation on?")]
        public bool allowIrrigation { get; set; }
        [Description("Start of irrigation season (dd-MMM)")]
        public string seasonStart { get; set; }
        [Description("End of irrigation season (dd-MMM)")]
        public string seasonEnd { get; set; }
        [Description("Season allocation (mm)")]
        public double seasonsAllocation { get; set; }
        [Description("Deficit to trigger irrigation (% PAWC)")]
        public double triggerDeficit { get; set; }
        [Description("Deficit to stop irrigaton (% PAWC)")]
        public double targetDeficit { get; set; }
        [Description("Minimum days for irrigation to return")]
        public double returndays { get; set; }
        [Description("Maximum irrigation application (mm/day)")]
        public double maximumAmount { get; set; }
        [Description("Depth to calculate PAWC (mm)")]
        public double depthPAWC { get; set; }

        //Class members
        [XmlIgnore] public double TopSWdeficit { get; set; }
        [XmlIgnore] public double TopSWC { get; set; }
        [XmlIgnore] public double DaysSinceIrrigation { get; set; }
        [XmlIgnore] public double AmountToApply { get; set; }
        [XmlIgnore] public double SeasonAppliedAmount { get; set; }
        
        private bool IrrigationIsAllowed { get; set; }
        private bool SeasonIsOpen { get; set; }
        private bool CropIsActive { get; set; }
        private bool IrrigatorIsAvailable { get; set; }
        private bool SoilIsDry { get; set; }

        private DateTime StartDate;
        private DateTime EndDate;
        private double TopDUL;
        private double TopLL;
        private int nLayers;
    
        //Calculate static soil variables
        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {   
            //Set the season dates
            StartDate = DateTime.Parse(seasonStart + "-" + Clock.Today.Year.ToString());
            EndDate = DateTime.Parse(seasonEnd + "-" + Clock.Today.Year.ToString());
            
            //Can we irrigate at all?
            IrrigationIsAllowed = false; 
            if (allowIrrigation)
                IrrigationIsAllowed = true; 

            //Calculate soil water variables
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            nLayers = Soil.Thickness.Length;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopLL += Soil.LL15mm[layer] * fracLayer;
                TopDUL += Soil.DULmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
        }
             
        //Determine daily requirement for irrigation
        [EventSubscribe("StartOfDay")]
        private void OnStartOfDay(object sender, EventArgs e)
        {
            //Can we irrigate today?          
            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);

            //Is there a crop in the ground that needs irrigation?
            CropIsActive = false;
            if ((existingCrop != null) && (existingCrop.IsAlive))
                CropIsActive = true;
            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))
          
            //Is the irrigator available?
            IrrigatorIsAvailable = false;
            DaysSinceIrrigation += 1;
            if (DaysSinceIrrigation >= returndays)
                IrrigatorIsAvailable = true;
          
            //Is the soil dry enough to require irrigation?
            SoilIsDry = false;
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopSWC = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            //for (int layer = 0; depthFromSurface < depthPAWC + Soil.Thickness[layer]; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopSWC += Soil.SoilWater.SWmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
            
            TopSWdeficit = TopSWC - TopDUL;
            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)
                SoilIsDry = true;
                
            //Are all the conditions ratifying irrigation
            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)
            {
                //Lets bloody well irrigate then!!!!
                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;
                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));
                Irrigation.Apply(AmountToApply);
                DaysSinceIrrigation = 0;
                SeasonAppliedAmount += AmountToApply;
            }
        }
        
        ///Checks whether theDate is between iniDate and endDate (non-year specific)
        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)
        {
            bool result = false;
            if (iniDate.DayOfYear < endDate.DayOfYear)
            {
                // period is within one year, ex: summer in the northern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            else
            {
                // period goes over the end of the year, ex: summer in the southern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            
            return result;
        }
    }
}
]]></Code>
        </Manager>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ShowPageOfGraphs>true</ShowPageOfGraphs>
      </Folder>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <a_interception>0</a_interception>
        <b_interception>0</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.29366217672824863</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Fertiliser>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ReportAdditions>no</ReportAdditions>
        <ReportRemovals>no</ReportRemovals>
        <ResidueTypes>
          <Name>ResidueTypes</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <LoadFromResource>ResidueTypes</LoadFromResource>
        </ResidueTypes>
        <TillageTypes>
          <Name>TillageTypesList</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <TillageType />
        </TillageTypes>
        <Pools>
          <Pool>
            <PoolName>Sward</PoolName>
            <ResidueType>grass</ResidueType>
            <Mass>1000</Mass>
            <CNRatio>15</CNRatio>
            <CPRatio>NaN</CPRatio>
            <StandingFraction>0</StandingFraction>
          </Pool>
        </Pools>
        <PoolName>Sward</PoolName>
        <type>grass</type>
        <mass>1000</mass>
        <standing_fraction>0</standing_fraction>
        <cpr />
        <cnr>15</cnr>
        <CriticalResidueWeight>2000</CriticalResidueWeight>
        <OptimumDecompTemp>20</OptimumDecompTemp>
        <MaxCumulativeEOS>20</MaxCumulativeEOS>
        <CNRatioDecompCoeff>0.277</CNRatioDecompCoeff>
        <CNRatioDecompThreshold>25</CNRatioDecompThreshold>
        <TotalLeachRain>25</TotalLeachRain>
        <MinRainToLeach>10</MinRainToLeach>
        <CriticalMinimumOrganicC>0.004</CriticalMinimumOrganicC>
        <DefaultCPRatio>0</DefaultCPRatio>
        <DefaultStandingFraction>0</DefaultStandingFraction>
        <StandingExtinctCoeff>0.5</StandingExtinctCoeff>
        <FractionFaecesAdded>0.5</FractionFaecesAdded>
      </SurfaceOrganicMatter>
      <Soil>
        <Name>LismoreSoil</Name>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>10</double>
            <double>40</double>
            <double>60</double>
            <double>70</double>
            <double>70</double>
          </Rocks>
          <Texture />
          <MunsellColour />
          <PH>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
          </PH>
          <CEC>
            <double>12.5</double>
            <double>10</double>
            <double>9</double>
            <double>5</double>
            <double>4</double>
            <double>4</double>
            <double>4</double>
          </CEC>
          <ParticleSizeSand>
            <double>15</double>
            <double>20</double>
            <double>25</double>
            <double>35</double>
            <double>40</double>
            <double>40</double>
            <double>40</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>65</double>
            <double>65</double>
            <double>63</double>
            <double>57</double>
            <double>54</double>
            <double>55</double>
            <double>55</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>20</double>
            <double>15</double>
            <double>12</double>
            <double>8</double>
            <double>6</double>
            <double>5</double>
            <double>5</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>SwardSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>RyegrassSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>WhiteCloverSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.3</double>
            <double>1.35</double>
            <double>1</double>
            <double>0.53</double>
            <double>0.31</double>
            <double>0.3</double>
            <double>0.3</double>
          </BD>
          <AirDry>
            <double>0.05</double>
            <double>0.12</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </AirDry>
          <LL15>
            <double>0.15</double>
            <double>0.14</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </LL15>
          <DUL>
            <double>0.36</double>
            <double>0.34</double>
            <double>0.19</double>
            <double>0.065</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.03</double>
          </DUL>
          <SAT>
            <double>0.45</double>
            <double>0.43</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.11</double>
          </SAT>
          <KS>
            <double>5000</double>
            <double>2500</double>
            <double>3000</double>
            <double>10000</double>
            <double>17500</double>
            <double>20000</double>
            <double>20000</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>6</SummerU>
          <SummerCona>3.5</SummerCona>
          <WinterDate>1-apr</WinterDate>
          <WinterU>2</WinterU>
          <WinterCona>2</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.5</double>
            <double>0.52</double>
            <double>0.55</double>
            <double>0.6</double>
            <double>0.65</double>
            <double>0.65</double>
            <double>0.65</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <residueinterception>0</residueinterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-50</string>
            <string>50-65</string>
            <string>65-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3</double>
            <double>1</double>
            <double>0.6</double>
            <double>0.4</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.7</double>
            <double>0.83</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <InitialWater>
          <Name>Initial water</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>0.95</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Initial nitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2.5</double>
            <double>1</double>
            <double>0.75</double>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.5</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <RecordNumber>0</RecordNumber>
        <SoilType>NZ_Sedimentary</SoilType>
        <LocalName>Lismore</LocalName>
        <Site>Winchmore</Site>
        <NearestTown>Ashburton</NearestTown>
        <Region>Canterbury</Region>
        <Country>New Zealand</Country>
        <NaturalVegetation />
        <Latitude>-48.48</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <Sward>
        <Name>Sward</Name>
        <PastureSpecies>
          <Name>Ryegrass</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <MaximumNUptake>10</MaximumNUptake>
          <Albedo>0.26</Albedo>
          <Gsmax>0.011</Gsmax>
          <R50>200</R50>
          <SpeciesFamily>Grass</SpeciesFamily>
          <PhotosyntheticPathway>C3</PhotosyntheticPathway>
          <InitialShootDM>1500</InitialShootDM>
          <InitialRootDM>450</InitialRootDM>
          <InitialRootDepth>750</InitialRootDepth>
          <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
          <LightExtinctionCoefficient>0.5</LightExtinctionCoefficient>
          <GrowthTminimum>1</GrowthTminimum>
          <GrowthToptimum>20</GrowthToptimum>
          <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
          <UseHeatStressFactor>yes</UseHeatStressFactor>
          <HeatOnsetTemperature>28</HeatOnsetTemperature>
          <HeatFullTemperature>35</HeatFullTemperature>
          <HeatRecoverySumDD>30</HeatRecoverySumDD>
          <HeatRecoveryTReference>25</HeatRecoveryTReference>
          <UseColdStressFactor>yes</UseColdStressFactor>
          <ColdOnsetTemperature>1</ColdOnsetTemperature>
          <ColdFullTemperature>-5</ColdFullTemperature>
          <ColdRecoverySumDD>25</ColdRecoverySumDD>
          <ColdRecoveryTReference>0</ColdRecoveryTReference>
          <MaintenanceRespirationCoefficient>0.03</MaintenanceRespirationCoefficient>
          <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
          <RespirationTReference>20</RespirationTReference>
          <RespirationExponent>1.5</RespirationExponent>
          <NThresholdsForLeaves>
            <double>0.04</double>
            <double>0.012</double>
            <double>0.05</double>
          </NThresholdsForLeaves>
          <NThresholdsForStems>
            <double>0.02</double>
            <double>0.006</double>
            <double>0.025</double>
          </NThresholdsForStems>
          <NThresholdsForStolons>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NThresholdsForStolons>
          <NThresholdsForRoots>
            <double>0.02</double>
            <double>0.006</double>
            <double>0.025</double>
          </NThresholdsForRoots>
          <DegreesDayForGermination>125</DegreesDayForGermination>
          <TargetShootRootRatio>4</TargetShootRootRatio>
          <MaxRootAllocation>0.25</MaxRootAllocation>
          <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
          <UseReproSeasonFactor>yes</UseReproSeasonFactor>
          <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
          <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
          <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
          <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
          <FractionLeafMaximum>0.7</FractionLeafMaximum>
          <FractionLeafMinimum>0.7</FractionLeafMinimum>
          <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
          <FractionLeafDMFactor>2000</FractionLeafDMFactor>
          <FractionLeafExponent>3</FractionLeafExponent>
          <FractionToStolon>0</FractionToStolon>
          <SpecificLeafArea>25</SpecificLeafArea>
          <SpecificRootLength>100</SpecificRootLength>
          <StolonEffectOnLAI>0</StolonEffectOnLAI>
          <ShootMaxEffectOnLAI>1000</ShootMaxEffectOnLAI>
          <MaxStemEffectOnLAI>1</MaxStemEffectOnLAI>
          <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
          <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
          <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
          <DetachmentRateShoot>0.08</DetachmentRateShoot>
          <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
          <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
          <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
          <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
          <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
          <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
          <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
          <FractionNLuxuryRemobilisable>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </FractionNLuxuryRemobilisable>
          <MinimumNFixation>0</MinimumNFixation>
          <MaximumNFixation>0</MaximumNFixation>
          <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
          <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
          <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
          <NDillutionCoefficient>0.25</NDillutionCoefficient>
          <GlfGeneric>1</GlfGeneric>
          <GlfSoilFertility>1</GlfSoilFertility>
          <PlantHeightMinimum>25</PlantHeightMinimum>
          <PlantHeightMaximum>600</PlantHeightMaximum>
          <PlantHeightMassForMax>10000</PlantHeightMassForMax>
          <PlantHeightExponent>2.8</PlantHeightExponent>
          <RootDepthMinimum>50</RootDepthMinimum>
          <RootDepthMaximum>750</RootDepthMaximum>
          <RootElongationRate>25</RootElongationRate>
          <RootDistributionDepthParam>90</RootDistributionDepthParam>
          <RootDistributionExponent>3.2</RootDistributionExponent>
          <DigestibilitiesCellWall>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.2</double>
          </DigestibilitiesCellWall>
          <MinimumGreenWt>100</MinimumGreenWt>
          <FractionStolonStanding>0</FractionStolonStanding>
          <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
          <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
          <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
          <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
        </PastureSpecies>
        <PastureSpecies>
          <Name>WhiteClover</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <MaximumNUptake>10</MaximumNUptake>
          <Albedo>0.26</Albedo>
          <Gsmax>0.011</Gsmax>
          <R50>200</R50>
          <SpeciesFamily>Legume</SpeciesFamily>
          <PhotosyntheticPathway>C3</PhotosyntheticPathway>
          <InitialShootDM>500</InitialShootDM>
          <InitialRootDM>150</InitialRootDM>
          <InitialRootDepth>350</InitialRootDepth>
          <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
          <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
          <GrowthTminimum>2</GrowthTminimum>
          <GrowthToptimum>22</GrowthToptimum>
          <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
          <UseHeatStressFactor>yes</UseHeatStressFactor>
          <HeatOnsetTemperature>30</HeatOnsetTemperature>
          <HeatFullTemperature>36</HeatFullTemperature>
          <HeatRecoverySumDD>20</HeatRecoverySumDD>
          <HeatRecoveryTReference>25</HeatRecoveryTReference>
          <UseColdStressFactor>yes</UseColdStressFactor>
          <ColdOnsetTemperature>2</ColdOnsetTemperature>
          <ColdFullTemperature>-5</ColdFullTemperature>
          <ColdRecoverySumDD>30</ColdRecoverySumDD>
          <ColdRecoveryTReference>0</ColdRecoveryTReference>
          <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
          <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
          <RespirationTReference>20</RespirationTReference>
          <RespirationExponent>1.5</RespirationExponent>
          <NThresholdsForLeaves>
            <double>0.045</double>
            <double>0.02</double>
            <double>0.055</double>
          </NThresholdsForLeaves>
          <NThresholdsForStems>
            <double>0.0225</double>
            <double>0.01</double>
            <double>0.0275</double>
          </NThresholdsForStems>
          <NThresholdsForStolons>
            <double>0.0225</double>
            <double>0.01</double>
            <double>0.0275</double>
          </NThresholdsForStolons>
          <NThresholdsForRoots>
            <double>0.0225</double>
            <double>0.01</double>
            <double>0.0275</double>
          </NThresholdsForRoots>
          <DegreesDayForGermination>125</DegreesDayForGermination>
          <TargetShootRootRatio>4</TargetShootRootRatio>
          <MaxRootAllocation>0.25</MaxRootAllocation>
          <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
          <UseReproSeasonFactor>yes</UseReproSeasonFactor>
          <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
          <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
          <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
          <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
          <FractionLeafMaximum>0.56</FractionLeafMaximum>
          <FractionLeafMinimum>0.28</FractionLeafMinimum>
          <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
          <FractionLeafDMFactor>2000</FractionLeafDMFactor>
          <FractionLeafExponent>3</FractionLeafExponent>
          <FractionToStolon>0.2</FractionToStolon>
          <SpecificLeafArea>30</SpecificLeafArea>
          <SpecificRootLength>45</SpecificRootLength>
          <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
          <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
          <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
          <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
          <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
          <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
          <DetachmentRateShoot>0.11</DetachmentRateShoot>
          <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
          <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
          <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
          <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
          <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
          <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
          <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
          <FractionNLuxuryRemobilisable>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </FractionNLuxuryRemobilisable>
          <MinimumNFixation>0.2</MinimumNFixation>
          <MaximumNFixation>0.6</MaximumNFixation>
          <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
          <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
          <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
          <NDillutionCoefficient>1</NDillutionCoefficient>
          <GlfGeneric>1</GlfGeneric>
          <GlfSoilFertility>1</GlfSoilFertility>
          <PlantHeightMinimum>25</PlantHeightMinimum>
          <PlantHeightMaximum>350</PlantHeightMaximum>
          <PlantHeightMassForMax>7500</PlantHeightMassForMax>
          <PlantHeightExponent>2.5</PlantHeightExponent>
          <RootDepthMinimum>30</RootDepthMinimum>
          <RootDepthMaximum>350</RootDepthMaximum>
          <RootElongationRate>25</RootElongationRate>
          <RootDistributionDepthParam>70</RootDistributionDepthParam>
          <RootDistributionExponent>2.5</RootDistributionExponent>
          <DigestibilitiesCellWall>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.2</double>
          </DigestibilitiesCellWall>
          <MinimumGreenWt>50</MinimumGreenWt>
          <FractionStolonStanding>0</FractionStolonStanding>
          <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
          <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
          <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
          <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
        </PastureSpecies>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ControlledBySward>yes</ControlledBySward>
        <WaterUptakeSource>soilarbitrator</WaterUptakeSource>
        <NUptakeSource>soilarbitrator</NUptakeSource>
      </Sward>
      <Report>
        <Name>Results</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today as Date</string>
          <string>[Sward].Name as Sward.Name</string>
          <string>[Sward].TotalWt as Sward.TotalWt</string>
          <string>[Sward].AboveGroundWt as Sward.AboveGroundWt</string>
          <string>[Sward].BelowGroundWt as Sward.BelowGroundWt</string>
          <string>[Sward].StandingHerbageWt as Sward.StandingHerbageWt</string>
          <string>[Sward].HarvestableWt as Sward.HarvestableWt</string>
          <string>[Sward].HarvestedWt as Sward.HarvestedWt</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].EndOfDay</string>
        </EventNames>
      </Report>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </SoluteManager>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Area>1</Area>
      <Slope>0</Slope>
    </Zone>
    <Report>
      <Name>Report1</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <ExperimentFactorNames />
      <ExperimentFactorValues />
      <VariableNames>
        <string>[Clock].Today</string>
        <string>[Stock].NumberAll</string>
        <string>[Stock].WeightAll</string>
        <string>[Stock].CondScoreAll</string>
        <string>[Stock].IntakeAll.Weight</string>
        <string>[Stock].IntakeAll.N</string>
        <string>[Stock].UrineNAll</string>
        <string>[Stock].FaecesAll.N</string>
        <string>[Stock].MilkWtAll</string>
        <string>[Supplement].stores[2].Name</string>
        <string>[Supplement].stores[2].Stored</string>
      </VariableNames>
      <EventNames>
        <string>[Clock].EndOfDay</string>
      </EventNames>
    </Report>
    <Folder>
      <Name>Folder</Name>
      <Graph>
        <Name>Live Cows</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.NumberAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>BodyWt and Milk Production</Name>
        <Series>
          <Name>BodyWeight</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Right</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.WeightAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>MilkProduction</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16736653</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.MilkWtAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Right</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>Condition Score</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.CondScoreAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>Supplement Stores</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Supplement.stores2.Stored</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <ShowPageOfGraphs>true</ShowPageOfGraphs>
    </Folder>
    <IncludeInDocumentation>true</IncludeInDocumentation>
  </Simulation>
  <Simulation>
    <Name>SimpleRotation</Name>
    <Clock>
      <Name>Clock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <StartDate>2000-08-01T00:00:00</StartDate>
      <EndDate>2000-08-20T00:00:00</EndDate>
    </Clock>
    <Summary>
      <Name>SummaryFile</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
    </Summary>
    <SoilArbitrator>
      <Name>SoilArbitrator</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
    </SoilArbitrator>
    <Weather>
      <Name>Weather</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <FileName>%root%\Examples\WeatherFiles\lincoln.met</FileName>
      <ExcelWorkSheetName />
    </Weather>
    <Stock>
      <Name>Stock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <RandSeed>9999</RandSeed>
      <GenoTypes />
      <Sheep />
      <Cattle />
      <PaddockList>
        <PaddockInit>
          <Forages />
          <Name />
          <Area>1</Area>
          <Slope>0</Slope>
        </PaddockInit>
      </PaddockList>
      <EnterpriseList />
      <GrazingPeriods />
    </Stock>
    <Manager>
      <Name>Ex_TargetRotationLength</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Script>
        <DoVerbose>False</DoVerbose>
        <StockingRate>3</StockingRate>
        <InitLocation>Paddock01</InitLocation>
        <TargetRotationLength>2</TargetRotationLength>
        <HarvestExcessHerbage>False</HarvestExcessHerbage>
        <NumCows>3</NumCows>
        <CurrentLocation>
        </CurrentLocation>
        <CurrentLocationNum>0</CurrentLocationNum>
        <NumPaddocks>0</NumPaddocks>
        <FarmArea>0</FarmArea>
      </Script>
      <Code><![CDATA[using System;
using Models.Core;
using Models.Utilities;
using Models.GrazPlan;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;
using Models.PMF;
using Models.Soils;
using System.Collections;
using System.Collections.Generic;
using Models.AgPasture;
using System.Diagnostics;

namespace Models
{

    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Stock Cows;
        [Link] Supplement Feed;
        [Link] Zone[] Paddocks;
        [Link] ISummary summary = null;

        //List<AgPasture.PastureSpecies> Pasture = new List<AgPasture.PastureSpecies>();

        [Serializable]
        public class PaddockInfo
        {
            public string paddockName;
            public double harvestableBiomass;
            public int paddockNum;
            public double paddockArea;
        }

        [Description("Do verbose reporting from this script (tick for yes): ")] public bool DoVerbose { get; set; }

        [Description("Whole-farm stocking rate (head/ha): ")] public double StockingRate { get; set; }
        [Description("Initial location of the cows (paddock name): ")] public string InitLocation { get; set; }
        // move more cow stuff to the interface

        [Description("Target rotation length (days/paddock): ")] public int TargetRotationLength { get; set; }
        //[Description("Target grazing residual (kgDM/ha): ")] public double TargetGrazingResidual { get; set; }
        [Description("Harvest excess herbage? (days): ")] public bool HarvestExcessHerbage { get; set; }


        public int NumCows { get; set; } // number of cows on the whole farm
        public string CurrentLocation { get; set; }  // name of the paddock that the cows are currently in
        public int CurrentLocationNum { get; set; }  // name of the paddock that the cows are currently in
        public int NumPaddocks { get; set; }
        public double FarmArea { get; set; }

        private int group_count; // how many groups are there in the simulation
        private int g = 1;      // index to the groups of animals

        //private int DaysPerPaddock;
        private int DaysInThisPaddock;

        public event BiomassRemovedDelegate BiomassRemoved;
        List<PaddockInfo> listOfPaddockInfo = new List<PaddockInfo>();


        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            summary.WriteMessage(this, "Initialising the paddock information");

            GetFarmAreaAndOtherInfo();

            NumCows = (int)(Math.Round(StockingRate * FarmArea, 0));

            SetInitialCowStuff();

            Cows.Move(g, InitLocation);

            summary.WriteMessage(this, "     The number of animals has been rounded to " + NumCows + " from " + (StockingRate * FarmArea));
            summary.WriteMessage(this, "     The animals will begin in " + CurrentLocation + " which is paddock number " + CurrentLocationNum + " in the simulation");
            summary.WriteMessage(this, "     The area of the whole farm is " + FarmArea + " ha");

            DaysInThisPaddock = -1;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            // how many days in this paddock?  Ready to move?
            DaysInThisPaddock += 1;
            int newPaddockLocationNum = CurrentLocationNum + 1;
            if (newPaddockLocationNum >= NumPaddocks)
                newPaddockLocationNum = 0;
            if (DaysInThisPaddock >= TargetRotationLength)
            {
                Cows.Move(g, listOfPaddockInfo[newPaddockLocationNum].paddockName);  // "0" is because the list is sorted in descending order (but don't ask me to explain why!)
                CurrentLocation = listOfPaddockInfo[newPaddockLocationNum].paddockName;
                CurrentLocationNum = listOfPaddockInfo[newPaddockLocationNum].paddockNum;
                if (DoVerbose)
                    summary.WriteMessage(this, "moving to " + listOfPaddockInfo[newPaddockLocationNum].paddockName);
                DaysInThisPaddock = 0;
            }


            // total harvested is equal total defoliated, for now
            //HarvestedWt = DefoliatedWt;
            //HarvestedN = DefoliatedN;  


            /*// get the type of amount given
			if (RemoveAmountType == removeAmountTypes.ResidualDM)
                amountType = "SetResidueAmount";
            else
                amountType = "SetRemoveAmount"; */


            if (Cows.NumberAll > 0)
            {
                Feed.Feed("Silage", 15.0 * Cows.NumberAll, CurrentLocation);
                // remove some biomass
                UpdatePaddockInfo();

                foreach (Zone paddock in Paddocks)
                {
                    if (paddock.Name == CurrentLocation)
                    {
                        foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                        {
                            //Debugger.Break();
                            double totalAmountToRemove = 15.0 * Cows.NumberAll;
                            double amountToRemove = (15.0 * Cows.NumberAll) * (plant.HarvestableWt / listOfPaddockInfo[CurrentLocationNum].harvestableBiomass);
                            if (amountToRemove >= plant.HarvestableWt)
                            {
                                if (DoVerbose)
                                    summary.WriteMessage(this, "not enough plant for the animal demand");
                                amountToRemove = plant.HarvestableWt;
                            }
                            else
                            {
                                //double propToRemove = plant.AboveGroundWt /  plantWeights[0].totalWt;
                                plant.Graze(amount: amountToRemove, type: "SetRemoveAmount");
                                //DefoliatedWt += species.HarvestedWt;
                                //DefoliatedN += species.HarvestedN;
                            }
                        }
                    }
                }
            }
        }


        public void SetInitialCowStuff()
        {
            g = Cows.NoGroups + 1;

            StockBuy purchase = new StockBuy();
            purchase.Genotype = "Friesian";
            purchase.Number = NumCows;
            purchase.Sex = "heifers";
            purchase.Age = 24;       // age in months
            purchase.Weight = 550.0;  // live weight in kg
            purchase.UseTag = g + 1;
            purchase.MatedTo = "Friesian";
            purchase.Pregnant = 0;  // days pregnant, 0 = non pregnant, 1 = pregnant
            purchase.Lactating = 1;  // 0 for dry, 1 for lactating
            purchase.NumYoung = 2;
            purchase.YoungWt = 45;

            Cows.Buy(purchase);
        }

        public void GetFarmAreaAndOtherInfo()
        {
            NumPaddocks = 0;
            FarmArea = 0.0;
            CurrentLocation = InitLocation;
            CurrentLocationNum = 0;

            foreach (Zone paddock in Paddocks)
            {
                NumPaddocks += 1;

                PaddockInfo paddockInfo = new PaddockInfo();

                paddockInfo.paddockName = paddock.Name;
                paddockInfo.paddockNum = NumPaddocks - 1;
                paddockInfo.paddockArea = paddock.Area;

                foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                    paddockInfo.harvestableBiomass += plant.HarvestableWt;

                listOfPaddockInfo.Add(paddockInfo);

                FarmArea += paddock.Area;
                if (paddock.Name == InitLocation)
                    CurrentLocationNum = paddockInfo.paddockNum;

                summary.WriteMessage(this, "     Paddock " + NumPaddocks + " is called " + paddock.Name + ", has an area of " + paddock.Area + " ha and an initial harvestable biomass of " + paddockInfo.harvestableBiomass + " kg DM / ha");

            }

        }

        public void UpdatePaddockInfo()
        {
            int ii = -1;

            foreach (Zone paddock in Paddocks)
            {
                ii += 1;
                listOfPaddockInfo[ii].harvestableBiomass = 0.0;
                foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                    listOfPaddockInfo[ii].harvestableBiomass += plant.HarvestableWt;

            }

        }


    }
}
]]></Code>
    </Manager>
    <Supplement>
      <Name>Supplement</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <SpoilageTime>0</SpoilageTime>
      <stores>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>0.85</DMContent>
          <DMD>0</DMD>
          <MEContent>0</MEContent>
          <CPConc>0</CPConc>
          <ProtDg>0</ProtDg>
          <PConc>0</PConc>
          <SConc>0</SConc>
          <EEConc>0</EEConc>
          <ADIP2CP>0</ADIP2CP>
          <AshAlk>0</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>fodder</Name>
          <Stored>0</Stored>
        </StoreType>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>0.25</DMContent>
          <DMD>0.75</DMD>
          <MEContent>12</MEContent>
          <CPConc>0.18</CPConc>
          <ProtDg>0.8</ProtDg>
          <PConc>0.0032</PConc>
          <SConc>0.0024</SConc>
          <EEConc>0.02</EEConc>
          <ADIP2CP>0.06</ADIP2CP>
          <AshAlk>0.6</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>silage</Name>
          <Stored>200000</Stored>
        </StoreType>
      </stores>
      <PaddockList />
    </Supplement>
    <Report>
      <Name>ReportTop</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <ExperimentFactorNames />
      <ExperimentFactorValues />
      <VariableNames>
        <string>[Clock].Today</string>
        <string>[Ex_TargetRotationLength].Script.CurrentLocation as CurrentLoc</string>
        <string>[Ex_TargetRotationLength].Script.CurrentLocationNum as CurrentLocNum</string>
        <string>[Ex_TargetRotationLength].Script.InitLocation as InitLoc</string>
      </VariableNames>
      <EventNames>
        <string>[Clock].EndOfDay</string>
      </EventNames>
    </Report>
    <Folder>
      <Name>Folder</Name>
      <Graph>
        <Name>Live Cows</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.NumberAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>BodyWt and Milk Production</Name>
        <Series>
          <Name>BodyWeight</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Right</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.WeightAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>MilkProduction</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16736653</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.MilkWtAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Right</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>Condition Score</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.CondScoreAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>Supplement Stores</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorIndexToVaryColours>-1</FactorIndexToVaryColours>
          <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
          <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report1</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Supplement.stores2.Stored</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <ShowPageOfGraphs>true</ShowPageOfGraphs>
    </Folder>
    <Zone>
      <Name>Paddock00</Name>
      <Folder>
        <Name>Managers</Name>
        <Manager>
          <Name>AutomaticFertiliser</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <AllowFertiliser>yes</AllowFertiliser>
            <Depth2SoilN>500</Depth2SoilN>
            <CriticalSoilN>5</CriticalSoilN>
            <FertNAmount>25</FertNAmount>
            <FertType>UreaN</FertType>
            <FertApplicationDepth>1</FertApplicationDepth>
            <FertMinimumDays>15</FertMinimumDays>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Fertiliser fertiliser;
        [Link] ISummary summary = null;
        [Link] Soil Soil;

        //User inputs from properties tab
        [Description("Turn ferliser applications on? ")]
        public yesnoType AllowFertiliser { get; set; }
        
        [Description("Depth to calculate available soil N (mm): ")]
        public double Depth2SoilN { get; set; }

        [Description("Minimum available N, triggers an application (kgN/ha): ")]
        public double CriticalSoilN { get; set; }

        [Description("Amount of N fertiliser for each application (kgN/ha): ")]
        public double FertNAmount { get; set; }

        [Description("Type of N fertiliser to apply: ")]
        public Fertiliser.Types FertType { get; set; }

        [Description("Depth at which to apply the fertiliser (mm): ")]
        public double FertApplicationDepth { get; set; }
       
        [Description("Minimum period between applications (days): ")]
        public double FertMinimumDays { get; set; }
       
        public enum yesnoType
        {
            /// <summary>a positive answer</summary>
            yes,
            /// <summary>a negative answer</summary>
            no
        }

        [XmlIgnore] public double TopMineralN { get; set; }
        
        private DateTime lastApplicationDate;
        private bool fertiliserIsAllowed;
        private int nLayers;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            fertiliserIsAllowed = (AllowFertiliser == yesnoType.yes);
            nLayers = Soil.Thickness.Length;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            double daysSinceLastApplication = (Clock.Today - lastApplicationDate).TotalDays;
            
            // get the N stored in the soil
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopMineralN = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (Depth2SoilN - depthFromSurface) / Soil.Thickness[layer]);
                TopMineralN += (Soil.SoilNitrogen.NO3[layer]
                + Soil.SoilNitrogen.NH4[layer]
                + Soil.SoilNitrogen.urea[layer])
                * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= Depth2SoilN)
                    layer = nLayers;
            }

            if (fertiliserIsAllowed && (daysSinceLastApplication >= FertMinimumDays) && (TopMineralN <= CriticalSoilN))
            {
                fertiliser.Apply(FertNAmount, FertType, FertApplicationDepth);
                lastApplicationDate = Clock.Today;
            }
        }
    }
}
]]></Code>
        </Manager>
        <Manager>
          <Name>AutomaticIrrigation</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <allowIrrigation>True</allowIrrigation>
            <seasonStart>15-Aug</seasonStart>
            <seasonEnd>30-May</seasonEnd>
            <seasonsAllocation>10000</seasonsAllocation>
            <triggerDeficit>75</triggerDeficit>
            <targetDeficit>99</targetDeficit>
            <returndays>1</returndays>
            <maximumAmount>30</maximumAmount>
            <depthPAWC>300</depthPAWC>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using System.Xml.Serialization;
using Models.PMF;
using APSIM.Shared.Utilities;

        
namespace Models
{
    [Serializable] 
    [System.Xml.Serialization.XmlInclude(typeof(Model))]
    public class Script : Model
    {
        //Communication to other modules
        [Link] ISummary summary = null;
        [Link] Irrigation Irrigation;
        [Link] Clock Clock;
        [Link] Soil Soil;
        [Link(IsOptional = true)] IPlant existingCrop;
       
        //User inputs from properties tab
        [Description("Turn irrigation on?")]
        public bool allowIrrigation { get; set; }
        [Description("Start of irrigation season (dd-MMM)")]
        public string seasonStart { get; set; }
        [Description("End of irrigation season (dd-MMM)")]
        public string seasonEnd { get; set; }
        [Description("Season allocation (mm)")]
        public double seasonsAllocation { get; set; }
        [Description("Deficit to trigger irrigation (% PAWC)")]
        public double triggerDeficit { get; set; }
        [Description("Deficit to stop irrigaton (% PAWC)")]
        public double targetDeficit { get; set; }
        [Description("Minimum days for irrigation to return")]
        public double returndays { get; set; }
        [Description("Maximum irrigation application (mm/day)")]
        public double maximumAmount { get; set; }
        [Description("Depth to calculate PAWC (mm)")]
        public double depthPAWC { get; set; }

        //Class members
        [XmlIgnore] public double TopSWdeficit { get; set; }
        [XmlIgnore] public double TopSWC { get; set; }
        [XmlIgnore] public double DaysSinceIrrigation { get; set; }
        [XmlIgnore] public double AmountToApply { get; set; }
        [XmlIgnore] public double SeasonAppliedAmount { get; set; }
        
        private bool IrrigationIsAllowed { get; set; }
        private bool SeasonIsOpen { get; set; }
        private bool CropIsActive { get; set; }
        private bool IrrigatorIsAvailable { get; set; }
        private bool SoilIsDry { get; set; }

        private DateTime StartDate;
        private DateTime EndDate;
        private double TopDUL;
        private double TopLL;
        private int nLayers;
    
        //Calculate static soil variables
        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {   
            //Set the season dates
            StartDate = DateTime.Parse(seasonStart + "-" + Clock.Today.Year.ToString());
            EndDate = DateTime.Parse(seasonEnd + "-" + Clock.Today.Year.ToString());
            
            //Can we irrigate at all?
            IrrigationIsAllowed = false; 
            if (allowIrrigation)
                IrrigationIsAllowed = true; 

            //Calculate soil water variables
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            nLayers = Soil.Thickness.Length;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopLL += Soil.LL15mm[layer] * fracLayer;
                TopDUL += Soil.DULmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
        }
             
        //Determine daily requirement for irrigation
        [EventSubscribe("StartOfDay")]
        private void OnStartOfDay(object sender, EventArgs e)
        {
            //Can we irrigate today?          
            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);

            //Is there a crop in the ground that needs irrigation?
            CropIsActive = false;
            if ((existingCrop != null) && (existingCrop.IsAlive))
                CropIsActive = true;
            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))
          
            //Is the irrigator available?
            IrrigatorIsAvailable = false;
            DaysSinceIrrigation += 1;
            if (DaysSinceIrrigation >= returndays)
                IrrigatorIsAvailable = true;
          
            //Is the soil dry enough to require irrigation?
            SoilIsDry = false;
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopSWC = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            //for (int layer = 0; depthFromSurface < depthPAWC + Soil.Thickness[layer]; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopSWC += Soil.SoilWater.SWmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
            
            TopSWdeficit = TopSWC - TopDUL;
            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)
                SoilIsDry = true;
                
            //Are all the conditions ratifying irrigation
            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)
            {
                //Lets bloody well irrigate then!!!!
                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;
                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));
                Irrigation.Apply(AmountToApply);
                DaysSinceIrrigation = 0;
                SeasonAppliedAmount += AmountToApply;
            }
        }
        
        ///Checks whether theDate is between iniDate and endDate (non-year specific)
        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)
        {
            bool result = false;
            if (iniDate.DayOfYear < endDate.DayOfYear)
            {
                // period is within one year, ex: summer in the northern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            else
            {
                // period goes over the end of the year, ex: summer in the southern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            
            return result;
        }
    }
}
]]></Code>
        </Manager>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ShowPageOfGraphs>true</ShowPageOfGraphs>
      </Folder>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <a_interception>0</a_interception>
        <b_interception>0</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.29366217672824863</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Fertiliser>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ReportAdditions>no</ReportAdditions>
        <ReportRemovals>no</ReportRemovals>
        <ResidueTypes>
          <Name>ResidueTypes</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <LoadFromResource>ResidueTypes</LoadFromResource>
        </ResidueTypes>
        <TillageTypes>
          <Name>TillageTypesList</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <TillageType />
        </TillageTypes>
        <Pools>
          <Pool>
            <PoolName>Sward</PoolName>
            <ResidueType>grass</ResidueType>
            <Mass>1000</Mass>
            <CNRatio>15</CNRatio>
            <CPRatio>NaN</CPRatio>
            <StandingFraction>0</StandingFraction>
          </Pool>
        </Pools>
        <PoolName>Sward</PoolName>
        <type>grass</type>
        <mass>1000</mass>
        <standing_fraction>0</standing_fraction>
        <cpr />
        <cnr>15</cnr>
        <CriticalResidueWeight>2000</CriticalResidueWeight>
        <OptimumDecompTemp>20</OptimumDecompTemp>
        <MaxCumulativeEOS>20</MaxCumulativeEOS>
        <CNRatioDecompCoeff>0.277</CNRatioDecompCoeff>
        <CNRatioDecompThreshold>25</CNRatioDecompThreshold>
        <TotalLeachRain>25</TotalLeachRain>
        <MinRainToLeach>10</MinRainToLeach>
        <CriticalMinimumOrganicC>0.004</CriticalMinimumOrganicC>
        <DefaultCPRatio>0</DefaultCPRatio>
        <DefaultStandingFraction>0</DefaultStandingFraction>
        <StandingExtinctCoeff>0.5</StandingExtinctCoeff>
        <FractionFaecesAdded>0.5</FractionFaecesAdded>
      </SurfaceOrganicMatter>
      <PastureSpecies>
        <Name>Ryegrass</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Grass</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>2500</InitialShootDM>
        <InitialRootDM>450</InitialRootDM>
        <InitialRootDepth>750</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.5</LightExtinctionCoefficient>
        <GrowthTminimum>1</GrowthTminimum>
        <GrowthToptimum>20</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>28</HeatOnsetTemperature>
        <HeatFullTemperature>35</HeatFullTemperature>
        <HeatRecoverySumDD>30</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>1</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>25</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.03</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.04</double>
          <double>0.012</double>
          <double>0.05</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.7</FractionLeafMaximum>
        <FractionLeafMinimum>0.7</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0</FractionToStolon>
        <SpecificLeafArea>25</SpecificLeafArea>
        <SpecificRootLength>100</SpecificRootLength>
        <StolonEffectOnLAI>0</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>1000</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>1</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.08</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0</MinimumNFixation>
        <MaximumNFixation>0</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>0.25</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>600</PlantHeightMaximum>
        <PlantHeightMassForMax>10000</PlantHeightMassForMax>
        <PlantHeightExponent>2.8</PlantHeightExponent>
        <RootDepthMinimum>50</RootDepthMinimum>
        <RootDepthMaximum>750</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>90</RootDistributionDepthParam>
        <RootDistributionExponent>3.2</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>100</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <PastureSpecies>
        <Name>WhiteClover</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Legume</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>500</InitialShootDM>
        <InitialRootDM>150</InitialRootDM>
        <InitialRootDepth>350</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
        <GrowthTminimum>2</GrowthTminimum>
        <GrowthToptimum>22</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>30</HeatOnsetTemperature>
        <HeatFullTemperature>36</HeatFullTemperature>
        <HeatRecoverySumDD>20</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>2</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>30</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.045</double>
          <double>0.02</double>
          <double>0.055</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.56</FractionLeafMaximum>
        <FractionLeafMinimum>0.28</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0.2</FractionToStolon>
        <SpecificLeafArea>30</SpecificLeafArea>
        <SpecificRootLength>45</SpecificRootLength>
        <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.11</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0.2</MinimumNFixation>
        <MaximumNFixation>0.6</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>1</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>350</PlantHeightMaximum>
        <PlantHeightMassForMax>7500</PlantHeightMassForMax>
        <PlantHeightExponent>2.5</PlantHeightExponent>
        <RootDepthMinimum>30</RootDepthMinimum>
        <RootDepthMaximum>350</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>70</RootDistributionDepthParam>
        <RootDistributionExponent>2.5</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>50</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <Soil>
        <Name>LismoreSoil</Name>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>10</double>
            <double>40</double>
            <double>60</double>
            <double>70</double>
            <double>70</double>
          </Rocks>
          <Texture />
          <MunsellColour />
          <PH>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
          </PH>
          <CEC>
            <double>12.5</double>
            <double>10</double>
            <double>9</double>
            <double>5</double>
            <double>4</double>
            <double>4</double>
            <double>4</double>
          </CEC>
          <ParticleSizeSand>
            <double>15</double>
            <double>20</double>
            <double>25</double>
            <double>35</double>
            <double>40</double>
            <double>40</double>
            <double>40</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>65</double>
            <double>65</double>
            <double>63</double>
            <double>57</double>
            <double>54</double>
            <double>55</double>
            <double>55</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>20</double>
            <double>15</double>
            <double>12</double>
            <double>8</double>
            <double>6</double>
            <double>5</double>
            <double>5</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>SwardSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>RyegrassSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>WhiteCloverSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>Ryegrass1Soil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.3</double>
            <double>1.35</double>
            <double>1</double>
            <double>0.53</double>
            <double>0.31</double>
            <double>0.3</double>
            <double>0.3</double>
          </BD>
          <AirDry>
            <double>0.05</double>
            <double>0.12</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </AirDry>
          <LL15>
            <double>0.15</double>
            <double>0.14</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </LL15>
          <DUL>
            <double>0.36</double>
            <double>0.34</double>
            <double>0.19</double>
            <double>0.065</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.03</double>
          </DUL>
          <SAT>
            <double>0.45</double>
            <double>0.43</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.11</double>
          </SAT>
          <KS>
            <double>5000</double>
            <double>2500</double>
            <double>3000</double>
            <double>10000</double>
            <double>17500</double>
            <double>20000</double>
            <double>20000</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>6</SummerU>
          <SummerCona>3.5</SummerCona>
          <WinterDate>1-apr</WinterDate>
          <WinterU>2</WinterU>
          <WinterCona>2</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.5</double>
            <double>0.52</double>
            <double>0.55</double>
            <double>0.6</double>
            <double>0.65</double>
            <double>0.65</double>
            <double>0.65</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <residueinterception>0</residueinterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-50</string>
            <string>50-65</string>
            <string>65-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3</double>
            <double>1</double>
            <double>0.6</double>
            <double>0.4</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.7</double>
            <double>0.83</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <InitialWater>
          <Name>Initial water</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>0.95</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Initial nitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2.5</double>
            <double>1</double>
            <double>0.75</double>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.5</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <RecordNumber>0</RecordNumber>
        <SoilType>NZ_Sedimentary</SoilType>
        <LocalName>Lismore</LocalName>
        <Site>Winchmore</Site>
        <NearestTown>Ashburton</NearestTown>
        <Region>Canterbury</Region>
        <Country>New Zealand</Country>
        <NaturalVegetation />
        <Latitude>-48.48</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </SoluteManager>
      <Report>
        <Name>Report</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today</string>
          <string>[Ryegrass].AboveGroundWt</string>
          <string>[Ryegrass].HarvestableWt</string>
          <string>[WhiteClover].AboveGroundWt</string>
          <string>[WhiteClover].HarvestableWt</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].EndOfDay</string>
        </EventNames>
      </Report>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Area>1.5</Area>
      <Slope>0</Slope>
    </Zone>
    <Zone>
      <Name>Paddock01</Name>
      <Folder>
        <Name>Managers</Name>
        <Manager>
          <Name>AutomaticFertiliser</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <AllowFertiliser>yes</AllowFertiliser>
            <Depth2SoilN>500</Depth2SoilN>
            <CriticalSoilN>5</CriticalSoilN>
            <FertNAmount>25</FertNAmount>
            <FertType>UreaN</FertType>
            <FertApplicationDepth>1</FertApplicationDepth>
            <FertMinimumDays>15</FertMinimumDays>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Fertiliser fertiliser;
        [Link] ISummary summary = null;
        [Link] Soil Soil;

        //User inputs from properties tab
        [Description("Turn ferliser applications on? ")]
        public yesnoType AllowFertiliser { get; set; }
        
        [Description("Depth to calculate available soil N (mm): ")]
        public double Depth2SoilN { get; set; }

        [Description("Minimum available N, triggers an application (kgN/ha): ")]
        public double CriticalSoilN { get; set; }

        [Description("Amount of N fertiliser for each application (kgN/ha): ")]
        public double FertNAmount { get; set; }

        [Description("Type of N fertiliser to apply: ")]
        public Fertiliser.Types FertType { get; set; }

        [Description("Depth at which to apply the fertiliser (mm): ")]
        public double FertApplicationDepth { get; set; }
       
        [Description("Minimum period between applications (days): ")]
        public double FertMinimumDays { get; set; }
       
        public enum yesnoType
        {
            /// <summary>a positive answer</summary>
            yes,
            /// <summary>a negative answer</summary>
            no
        }

        [XmlIgnore] public double TopMineralN { get; set; }
        
        private DateTime lastApplicationDate;
        private bool fertiliserIsAllowed;
        private int nLayers;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            fertiliserIsAllowed = (AllowFertiliser == yesnoType.yes);
            nLayers = Soil.Thickness.Length;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            double daysSinceLastApplication = (Clock.Today - lastApplicationDate).TotalDays;
            
            // get the N stored in the soil
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopMineralN = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (Depth2SoilN - depthFromSurface) / Soil.Thickness[layer]);
                TopMineralN += (Soil.SoilNitrogen.NO3[layer]
                + Soil.SoilNitrogen.NH4[layer]
                + Soil.SoilNitrogen.urea[layer])
                * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= Depth2SoilN)
                    layer = nLayers;
            }

            if (fertiliserIsAllowed && (daysSinceLastApplication >= FertMinimumDays) && (TopMineralN <= CriticalSoilN))
            {
                fertiliser.Apply(FertNAmount, FertType, FertApplicationDepth);
                lastApplicationDate = Clock.Today;
            }
        }
    }
}
]]></Code>
        </Manager>
        <Manager>
          <Name>AutomaticIrrigation</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <allowIrrigation>True</allowIrrigation>
            <seasonStart>15-Aug</seasonStart>
            <seasonEnd>30-May</seasonEnd>
            <seasonsAllocation>10000</seasonsAllocation>
            <triggerDeficit>75</triggerDeficit>
            <targetDeficit>99</targetDeficit>
            <returndays>1</returndays>
            <maximumAmount>30</maximumAmount>
            <depthPAWC>300</depthPAWC>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using System.Xml.Serialization;
using Models.PMF;
using APSIM.Shared.Utilities;

        
namespace Models
{
    [Serializable] 
    [System.Xml.Serialization.XmlInclude(typeof(Model))]
    public class Script : Model
    {
        //Communication to other modules
        [Link] ISummary summary = null;
        [Link] Irrigation Irrigation;
        [Link] Clock Clock;
        [Link] Soil Soil;
        [Link(IsOptional = true)] IPlant existingCrop;
       
        //User inputs from properties tab
        [Description("Turn irrigation on?")]
        public bool allowIrrigation { get; set; }
        [Description("Start of irrigation season (dd-MMM)")]
        public string seasonStart { get; set; }
        [Description("End of irrigation season (dd-MMM)")]
        public string seasonEnd { get; set; }
        [Description("Season allocation (mm)")]
        public double seasonsAllocation { get; set; }
        [Description("Deficit to trigger irrigation (% PAWC)")]
        public double triggerDeficit { get; set; }
        [Description("Deficit to stop irrigaton (% PAWC)")]
        public double targetDeficit { get; set; }
        [Description("Minimum days for irrigation to return")]
        public double returndays { get; set; }
        [Description("Maximum irrigation application (mm/day)")]
        public double maximumAmount { get; set; }
        [Description("Depth to calculate PAWC (mm)")]
        public double depthPAWC { get; set; }

        //Class members
        [XmlIgnore] public double TopSWdeficit { get; set; }
        [XmlIgnore] public double TopSWC { get; set; }
        [XmlIgnore] public double DaysSinceIrrigation { get; set; }
        [XmlIgnore] public double AmountToApply { get; set; }
        [XmlIgnore] public double SeasonAppliedAmount { get; set; }
        
        private bool IrrigationIsAllowed { get; set; }
        private bool SeasonIsOpen { get; set; }
        private bool CropIsActive { get; set; }
        private bool IrrigatorIsAvailable { get; set; }
        private bool SoilIsDry { get; set; }

        private DateTime StartDate;
        private DateTime EndDate;
        private double TopDUL;
        private double TopLL;
        private int nLayers;
    
        //Calculate static soil variables
        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {   
            //Set the season dates
            StartDate = DateTime.Parse(seasonStart + "-" + Clock.Today.Year.ToString());
            EndDate = DateTime.Parse(seasonEnd + "-" + Clock.Today.Year.ToString());
            
            //Can we irrigate at all?
            IrrigationIsAllowed = false; 
            if (allowIrrigation)
                IrrigationIsAllowed = true; 

            //Calculate soil water variables
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            nLayers = Soil.Thickness.Length;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopLL += Soil.LL15mm[layer] * fracLayer;
                TopDUL += Soil.DULmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
        }
             
        //Determine daily requirement for irrigation
        [EventSubscribe("StartOfDay")]
        private void OnStartOfDay(object sender, EventArgs e)
        {
            //Can we irrigate today?          
            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);

            //Is there a crop in the ground that needs irrigation?
            CropIsActive = false;
            if ((existingCrop != null) && (existingCrop.IsAlive))
                CropIsActive = true;
            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))
          
            //Is the irrigator available?
            IrrigatorIsAvailable = false;
            DaysSinceIrrigation += 1;
            if (DaysSinceIrrigation >= returndays)
                IrrigatorIsAvailable = true;
          
            //Is the soil dry enough to require irrigation?
            SoilIsDry = false;
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopSWC = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            //for (int layer = 0; depthFromSurface < depthPAWC + Soil.Thickness[layer]; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopSWC += Soil.SoilWater.SWmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
            
            TopSWdeficit = TopSWC - TopDUL;
            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)
                SoilIsDry = true;
                
            //Are all the conditions ratifying irrigation
            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)
            {
                //Lets bloody well irrigate then!!!!
                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;
                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));
                Irrigation.Apply(AmountToApply);
                DaysSinceIrrigation = 0;
                SeasonAppliedAmount += AmountToApply;
            }
        }
        
        ///Checks whether theDate is between iniDate and endDate (non-year specific)
        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)
        {
            bool result = false;
            if (iniDate.DayOfYear < endDate.DayOfYear)
            {
                // period is within one year, ex: summer in the northern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            else
            {
                // period goes over the end of the year, ex: summer in the southern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            
            return result;
        }
    }
}
]]></Code>
        </Manager>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ShowPageOfGraphs>true</ShowPageOfGraphs>
      </Folder>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <a_interception>0</a_interception>
        <b_interception>0</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.29366217672824863</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Fertiliser>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ReportAdditions>no</ReportAdditions>
        <ReportRemovals>no</ReportRemovals>
        <ResidueTypes>
          <Name>ResidueTypes</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <LoadFromResource>ResidueTypes</LoadFromResource>
        </ResidueTypes>
        <TillageTypes>
          <Name>TillageTypesList</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <TillageType />
        </TillageTypes>
        <Pools>
          <Pool>
            <PoolName>Sward</PoolName>
            <ResidueType>grass</ResidueType>
            <Mass>1000</Mass>
            <CNRatio>15</CNRatio>
            <CPRatio>NaN</CPRatio>
            <StandingFraction>0</StandingFraction>
          </Pool>
        </Pools>
        <PoolName>Sward</PoolName>
        <type>grass</type>
        <mass>1000</mass>
        <standing_fraction>0</standing_fraction>
        <cpr />
        <cnr>15</cnr>
        <CriticalResidueWeight>2000</CriticalResidueWeight>
        <OptimumDecompTemp>20</OptimumDecompTemp>
        <MaxCumulativeEOS>20</MaxCumulativeEOS>
        <CNRatioDecompCoeff>0.277</CNRatioDecompCoeff>
        <CNRatioDecompThreshold>25</CNRatioDecompThreshold>
        <TotalLeachRain>25</TotalLeachRain>
        <MinRainToLeach>10</MinRainToLeach>
        <CriticalMinimumOrganicC>0.004</CriticalMinimumOrganicC>
        <DefaultCPRatio>0</DefaultCPRatio>
        <DefaultStandingFraction>0</DefaultStandingFraction>
        <StandingExtinctCoeff>0.5</StandingExtinctCoeff>
        <FractionFaecesAdded>0.5</FractionFaecesAdded>
      </SurfaceOrganicMatter>
      <PastureSpecies>
        <Name>Ryegrass</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Grass</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>2500</InitialShootDM>
        <InitialRootDM>450</InitialRootDM>
        <InitialRootDepth>750</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.5</LightExtinctionCoefficient>
        <GrowthTminimum>1</GrowthTminimum>
        <GrowthToptimum>20</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>28</HeatOnsetTemperature>
        <HeatFullTemperature>35</HeatFullTemperature>
        <HeatRecoverySumDD>30</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>1</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>25</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.03</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.04</double>
          <double>0.012</double>
          <double>0.05</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.7</FractionLeafMaximum>
        <FractionLeafMinimum>0.7</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0</FractionToStolon>
        <SpecificLeafArea>25</SpecificLeafArea>
        <SpecificRootLength>100</SpecificRootLength>
        <StolonEffectOnLAI>0</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>1000</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>1</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.08</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0</MinimumNFixation>
        <MaximumNFixation>0</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>0.25</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>600</PlantHeightMaximum>
        <PlantHeightMassForMax>10000</PlantHeightMassForMax>
        <PlantHeightExponent>2.8</PlantHeightExponent>
        <RootDepthMinimum>50</RootDepthMinimum>
        <RootDepthMaximum>750</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>90</RootDistributionDepthParam>
        <RootDistributionExponent>3.2</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>100</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <PastureSpecies>
        <Name>WhiteClover</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Legume</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>500</InitialShootDM>
        <InitialRootDM>150</InitialRootDM>
        <InitialRootDepth>350</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
        <GrowthTminimum>2</GrowthTminimum>
        <GrowthToptimum>22</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>30</HeatOnsetTemperature>
        <HeatFullTemperature>36</HeatFullTemperature>
        <HeatRecoverySumDD>20</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>2</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>30</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.045</double>
          <double>0.02</double>
          <double>0.055</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.56</FractionLeafMaximum>
        <FractionLeafMinimum>0.28</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0.2</FractionToStolon>
        <SpecificLeafArea>30</SpecificLeafArea>
        <SpecificRootLength>45</SpecificRootLength>
        <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.11</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0.2</MinimumNFixation>
        <MaximumNFixation>0.6</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>1</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>350</PlantHeightMaximum>
        <PlantHeightMassForMax>7500</PlantHeightMassForMax>
        <PlantHeightExponent>2.5</PlantHeightExponent>
        <RootDepthMinimum>30</RootDepthMinimum>
        <RootDepthMaximum>350</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>70</RootDistributionDepthParam>
        <RootDistributionExponent>2.5</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>50</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <Soil>
        <Name>LismoreSoil</Name>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>10</double>
            <double>40</double>
            <double>60</double>
            <double>70</double>
            <double>70</double>
          </Rocks>
          <Texture />
          <MunsellColour />
          <PH>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
          </PH>
          <CEC>
            <double>12.5</double>
            <double>10</double>
            <double>9</double>
            <double>5</double>
            <double>4</double>
            <double>4</double>
            <double>4</double>
          </CEC>
          <ParticleSizeSand>
            <double>15</double>
            <double>20</double>
            <double>25</double>
            <double>35</double>
            <double>40</double>
            <double>40</double>
            <double>40</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>65</double>
            <double>65</double>
            <double>63</double>
            <double>57</double>
            <double>54</double>
            <double>55</double>
            <double>55</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>20</double>
            <double>15</double>
            <double>12</double>
            <double>8</double>
            <double>6</double>
            <double>5</double>
            <double>5</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>SwardSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>RyegrassSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>WhiteCloverSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>Ryegrass1Soil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.3</double>
            <double>1.35</double>
            <double>1</double>
            <double>0.53</double>
            <double>0.31</double>
            <double>0.3</double>
            <double>0.3</double>
          </BD>
          <AirDry>
            <double>0.05</double>
            <double>0.12</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </AirDry>
          <LL15>
            <double>0.15</double>
            <double>0.14</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </LL15>
          <DUL>
            <double>0.36</double>
            <double>0.34</double>
            <double>0.19</double>
            <double>0.065</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.03</double>
          </DUL>
          <SAT>
            <double>0.45</double>
            <double>0.43</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.11</double>
          </SAT>
          <KS>
            <double>5000</double>
            <double>2500</double>
            <double>3000</double>
            <double>10000</double>
            <double>17500</double>
            <double>20000</double>
            <double>20000</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>6</SummerU>
          <SummerCona>3.5</SummerCona>
          <WinterDate>1-apr</WinterDate>
          <WinterU>2</WinterU>
          <WinterCona>2</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.5</double>
            <double>0.52</double>
            <double>0.55</double>
            <double>0.6</double>
            <double>0.65</double>
            <double>0.65</double>
            <double>0.65</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <residueinterception>0</residueinterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-50</string>
            <string>50-65</string>
            <string>65-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3</double>
            <double>1</double>
            <double>0.6</double>
            <double>0.4</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.7</double>
            <double>0.83</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <InitialWater>
          <Name>Initial water</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>0.95</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Initial nitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2.5</double>
            <double>1</double>
            <double>0.75</double>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.5</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <RecordNumber>0</RecordNumber>
        <SoilType>NZ_Sedimentary</SoilType>
        <LocalName>Lismore</LocalName>
        <Site>Winchmore</Site>
        <NearestTown>Ashburton</NearestTown>
        <Region>Canterbury</Region>
        <Country>New Zealand</Country>
        <NaturalVegetation />
        <Latitude>-48.48</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </SoluteManager>
      <Report>
        <Name>Report</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today</string>
          <string>[Ryegrass].AboveGroundWt</string>
          <string>[Ryegrass].HarvestableWt</string>
          <string>[WhiteClover].AboveGroundWt</string>
          <string>[WhiteClover].HarvestableWt</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].EndOfDay</string>
        </EventNames>
      </Report>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Area>1</Area>
      <Slope>0</Slope>
    </Zone>
    <Zone>
      <Name>Paddock02</Name>
      <Folder>
        <Name>Managers</Name>
        <Manager>
          <Name>AutomaticFertiliser</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <AllowFertiliser>yes</AllowFertiliser>
            <Depth2SoilN>500</Depth2SoilN>
            <CriticalSoilN>5</CriticalSoilN>
            <FertNAmount>25</FertNAmount>
            <FertType>UreaN</FertType>
            <FertApplicationDepth>1</FertApplicationDepth>
            <FertMinimumDays>15</FertMinimumDays>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Fertiliser fertiliser;
        [Link] ISummary summary = null;
        [Link] Soil Soil;

        //User inputs from properties tab
        [Description("Turn ferliser applications on? ")]
        public yesnoType AllowFertiliser { get; set; }
        
        [Description("Depth to calculate available soil N (mm): ")]
        public double Depth2SoilN { get; set; }

        [Description("Minimum available N, triggers an application (kgN/ha): ")]
        public double CriticalSoilN { get; set; }

        [Description("Amount of N fertiliser for each application (kgN/ha): ")]
        public double FertNAmount { get; set; }

        [Description("Type of N fertiliser to apply: ")]
        public Fertiliser.Types FertType { get; set; }

        [Description("Depth at which to apply the fertiliser (mm): ")]
        public double FertApplicationDepth { get; set; }
       
        [Description("Minimum period between applications (days): ")]
        public double FertMinimumDays { get; set; }
       
        public enum yesnoType
        {
            /// <summary>a positive answer</summary>
            yes,
            /// <summary>a negative answer</summary>
            no
        }

        [XmlIgnore] public double TopMineralN { get; set; }
        
        private DateTime lastApplicationDate;
        private bool fertiliserIsAllowed;
        private int nLayers;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            fertiliserIsAllowed = (AllowFertiliser == yesnoType.yes);
            nLayers = Soil.Thickness.Length;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            double daysSinceLastApplication = (Clock.Today - lastApplicationDate).TotalDays;
            
            // get the N stored in the soil
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopMineralN = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (Depth2SoilN - depthFromSurface) / Soil.Thickness[layer]);
                TopMineralN += (Soil.SoilNitrogen.NO3[layer]
                + Soil.SoilNitrogen.NH4[layer]
                + Soil.SoilNitrogen.urea[layer])
                * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= Depth2SoilN)
                    layer = nLayers;
            }

            if (fertiliserIsAllowed && (daysSinceLastApplication >= FertMinimumDays) && (TopMineralN <= CriticalSoilN))
            {
                fertiliser.Apply(FertNAmount, FertType, FertApplicationDepth);
                lastApplicationDate = Clock.Today;
            }
        }
    }
}
]]></Code>
        </Manager>
        <Manager>
          <Name>AutomaticIrrigation</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Script>
            <allowIrrigation>True</allowIrrigation>
            <seasonStart>15-Aug</seasonStart>
            <seasonEnd>30-May</seasonEnd>
            <seasonsAllocation>10000</seasonsAllocation>
            <triggerDeficit>75</triggerDeficit>
            <targetDeficit>99</targetDeficit>
            <returndays>1</returndays>
            <maximumAmount>30</maximumAmount>
            <depthPAWC>300</depthPAWC>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using System.Xml.Serialization;
using Models.PMF;
using APSIM.Shared.Utilities;

        
namespace Models
{
    [Serializable] 
    [System.Xml.Serialization.XmlInclude(typeof(Model))]
    public class Script : Model
    {
        //Communication to other modules
        [Link] ISummary summary = null;
        [Link] Irrigation Irrigation;
        [Link] Clock Clock;
        [Link] Soil Soil;
        [Link(IsOptional = true)] IPlant existingCrop;
       
        //User inputs from properties tab
        [Description("Turn irrigation on?")]
        public bool allowIrrigation { get; set; }
        [Description("Start of irrigation season (dd-MMM)")]
        public string seasonStart { get; set; }
        [Description("End of irrigation season (dd-MMM)")]
        public string seasonEnd { get; set; }
        [Description("Season allocation (mm)")]
        public double seasonsAllocation { get; set; }
        [Description("Deficit to trigger irrigation (% PAWC)")]
        public double triggerDeficit { get; set; }
        [Description("Deficit to stop irrigaton (% PAWC)")]
        public double targetDeficit { get; set; }
        [Description("Minimum days for irrigation to return")]
        public double returndays { get; set; }
        [Description("Maximum irrigation application (mm/day)")]
        public double maximumAmount { get; set; }
        [Description("Depth to calculate PAWC (mm)")]
        public double depthPAWC { get; set; }

        //Class members
        [XmlIgnore] public double TopSWdeficit { get; set; }
        [XmlIgnore] public double TopSWC { get; set; }
        [XmlIgnore] public double DaysSinceIrrigation { get; set; }
        [XmlIgnore] public double AmountToApply { get; set; }
        [XmlIgnore] public double SeasonAppliedAmount { get; set; }
        
        private bool IrrigationIsAllowed { get; set; }
        private bool SeasonIsOpen { get; set; }
        private bool CropIsActive { get; set; }
        private bool IrrigatorIsAvailable { get; set; }
        private bool SoilIsDry { get; set; }

        private DateTime StartDate;
        private DateTime EndDate;
        private double TopDUL;
        private double TopLL;
        private int nLayers;
    
        //Calculate static soil variables
        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {   
            //Set the season dates
            StartDate = DateTime.Parse(seasonStart + "-" + Clock.Today.Year.ToString());
            EndDate = DateTime.Parse(seasonEnd + "-" + Clock.Today.Year.ToString());
            
            //Can we irrigate at all?
            IrrigationIsAllowed = false; 
            if (allowIrrigation)
                IrrigationIsAllowed = true; 

            //Calculate soil water variables
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            nLayers = Soil.Thickness.Length;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopLL += Soil.LL15mm[layer] * fracLayer;
                TopDUL += Soil.DULmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
        }
             
        //Determine daily requirement for irrigation
        [EventSubscribe("StartOfDay")]
        private void OnStartOfDay(object sender, EventArgs e)
        {
            //Can we irrigate today?          
            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);

            //Is there a crop in the ground that needs irrigation?
            CropIsActive = false;
            if ((existingCrop != null) && (existingCrop.IsAlive))
                CropIsActive = true;
            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))
          
            //Is the irrigator available?
            IrrigatorIsAvailable = false;
            DaysSinceIrrigation += 1;
            if (DaysSinceIrrigation >= returndays)
                IrrigatorIsAvailable = true;
          
            //Is the soil dry enough to require irrigation?
            SoilIsDry = false;
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopSWC = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            //for (int layer = 0; depthFromSurface < depthPAWC + Soil.Thickness[layer]; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopSWC += Soil.SoilWater.SWmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
            
            TopSWdeficit = TopSWC - TopDUL;
            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)
                SoilIsDry = true;
                
            //Are all the conditions ratifying irrigation
            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)
            {
                //Lets bloody well irrigate then!!!!
                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;
                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));
                Irrigation.Apply(AmountToApply);
                DaysSinceIrrigation = 0;
                SeasonAppliedAmount += AmountToApply;
            }
        }
        
        ///Checks whether theDate is between iniDate and endDate (non-year specific)
        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)
        {
            bool result = false;
            if (iniDate.DayOfYear < endDate.DayOfYear)
            {
                // period is within one year, ex: summer in the northern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            else
            {
                // period goes over the end of the year, ex: summer in the southern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            
            return result;
        }
    }
}
]]></Code>
        </Manager>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ShowPageOfGraphs>true</ShowPageOfGraphs>
      </Folder>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <a_interception>0</a_interception>
        <b_interception>0</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.29366217672824863</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </Fertiliser>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ReportAdditions>no</ReportAdditions>
        <ReportRemovals>no</ReportRemovals>
        <ResidueTypes>
          <Name>ResidueTypes</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <LoadFromResource>ResidueTypes</LoadFromResource>
        </ResidueTypes>
        <TillageTypes>
          <Name>TillageTypesList</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <TillageType />
        </TillageTypes>
        <Pools>
          <Pool>
            <PoolName>Sward</PoolName>
            <ResidueType>grass</ResidueType>
            <Mass>1000</Mass>
            <CNRatio>15</CNRatio>
            <CPRatio>NaN</CPRatio>
            <StandingFraction>0</StandingFraction>
          </Pool>
        </Pools>
        <PoolName>Sward</PoolName>
        <type>grass</type>
        <mass>1000</mass>
        <standing_fraction>0</standing_fraction>
        <cpr />
        <cnr>15</cnr>
        <CriticalResidueWeight>2000</CriticalResidueWeight>
        <OptimumDecompTemp>20</OptimumDecompTemp>
        <MaxCumulativeEOS>20</MaxCumulativeEOS>
        <CNRatioDecompCoeff>0.277</CNRatioDecompCoeff>
        <CNRatioDecompThreshold>25</CNRatioDecompThreshold>
        <TotalLeachRain>25</TotalLeachRain>
        <MinRainToLeach>10</MinRainToLeach>
        <CriticalMinimumOrganicC>0.004</CriticalMinimumOrganicC>
        <DefaultCPRatio>0</DefaultCPRatio>
        <DefaultStandingFraction>0</DefaultStandingFraction>
        <StandingExtinctCoeff>0.5</StandingExtinctCoeff>
        <FractionFaecesAdded>0.5</FractionFaecesAdded>
      </SurfaceOrganicMatter>
      <PastureSpecies>
        <Name>Ryegrass</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Grass</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>2500</InitialShootDM>
        <InitialRootDM>450</InitialRootDM>
        <InitialRootDepth>750</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.5</LightExtinctionCoefficient>
        <GrowthTminimum>1</GrowthTminimum>
        <GrowthToptimum>20</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>28</HeatOnsetTemperature>
        <HeatFullTemperature>35</HeatFullTemperature>
        <HeatRecoverySumDD>30</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>1</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>25</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.03</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.04</double>
          <double>0.012</double>
          <double>0.05</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.7</FractionLeafMaximum>
        <FractionLeafMinimum>0.7</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0</FractionToStolon>
        <SpecificLeafArea>25</SpecificLeafArea>
        <SpecificRootLength>100</SpecificRootLength>
        <StolonEffectOnLAI>0</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>1000</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>1</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.08</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0</MinimumNFixation>
        <MaximumNFixation>0</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>0.25</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>600</PlantHeightMaximum>
        <PlantHeightMassForMax>10000</PlantHeightMassForMax>
        <PlantHeightExponent>2.8</PlantHeightExponent>
        <RootDepthMinimum>50</RootDepthMinimum>
        <RootDepthMaximum>750</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>90</RootDistributionDepthParam>
        <RootDistributionExponent>3.2</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>100</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <PastureSpecies>
        <Name>WhiteClover</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Legume</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>500</InitialShootDM>
        <InitialRootDM>150</InitialRootDM>
        <InitialRootDepth>350</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
        <GrowthTminimum>2</GrowthTminimum>
        <GrowthToptimum>22</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>30</HeatOnsetTemperature>
        <HeatFullTemperature>36</HeatFullTemperature>
        <HeatRecoverySumDD>20</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>2</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>30</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.045</double>
          <double>0.02</double>
          <double>0.055</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.56</FractionLeafMaximum>
        <FractionLeafMinimum>0.28</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0.2</FractionToStolon>
        <SpecificLeafArea>30</SpecificLeafArea>
        <SpecificRootLength>45</SpecificRootLength>
        <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.11</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0.2</MinimumNFixation>
        <MaximumNFixation>0.6</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>1</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>350</PlantHeightMaximum>
        <PlantHeightMassForMax>7500</PlantHeightMassForMax>
        <PlantHeightExponent>2.5</PlantHeightExponent>
        <RootDepthMinimum>30</RootDepthMinimum>
        <RootDepthMaximum>350</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>70</RootDistributionDepthParam>
        <RootDistributionExponent>2.5</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>50</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <Soil>
        <Name>LismoreSoil</Name>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>10</double>
            <double>40</double>
            <double>60</double>
            <double>70</double>
            <double>70</double>
          </Rocks>
          <Texture />
          <MunsellColour />
          <PH>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
          </PH>
          <CEC>
            <double>12.5</double>
            <double>10</double>
            <double>9</double>
            <double>5</double>
            <double>4</double>
            <double>4</double>
            <double>4</double>
          </CEC>
          <ParticleSizeSand>
            <double>15</double>
            <double>20</double>
            <double>25</double>
            <double>35</double>
            <double>40</double>
            <double>40</double>
            <double>40</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>65</double>
            <double>65</double>
            <double>63</double>
            <double>57</double>
            <double>54</double>
            <double>55</double>
            <double>55</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>20</double>
            <double>15</double>
            <double>12</double>
            <double>8</double>
            <double>6</double>
            <double>5</double>
            <double>5</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>SwardSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>RyegrassSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>WhiteCloverSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>Ryegrass1Soil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.3</double>
            <double>1.35</double>
            <double>1</double>
            <double>0.53</double>
            <double>0.31</double>
            <double>0.3</double>
            <double>0.3</double>
          </BD>
          <AirDry>
            <double>0.05</double>
            <double>0.12</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </AirDry>
          <LL15>
            <double>0.15</double>
            <double>0.14</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </LL15>
          <DUL>
            <double>0.36</double>
            <double>0.34</double>
            <double>0.19</double>
            <double>0.065</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.03</double>
          </DUL>
          <SAT>
            <double>0.45</double>
            <double>0.43</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.11</double>
          </SAT>
          <KS>
            <double>5000</double>
            <double>2500</double>
            <double>3000</double>
            <double>10000</double>
            <double>17500</double>
            <double>20000</double>
            <double>20000</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>6</SummerU>
          <SummerCona>3.5</SummerCona>
          <WinterDate>1-apr</WinterDate>
          <WinterU>2</WinterU>
          <WinterCona>2</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.5</double>
            <double>0.52</double>
            <double>0.55</double>
            <double>0.6</double>
            <double>0.65</double>
            <double>0.65</double>
            <double>0.65</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <residueinterception>0</residueinterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-50</string>
            <string>50-65</string>
            <string>65-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3</double>
            <double>1</double>
            <double>0.6</double>
            <double>0.4</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.7</double>
            <double>0.83</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <InitialWater>
          <Name>Initial water</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>0.95</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Initial nitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2.5</double>
            <double>1</double>
            <double>0.75</double>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.5</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <RecordNumber>0</RecordNumber>
        <SoilType>NZ_Sedimentary</SoilType>
        <LocalName>Lismore</LocalName>
        <Site>Winchmore</Site>
        <NearestTown>Ashburton</NearestTown>
        <Region>Canterbury</Region>
        <Country>New Zealand</Country>
        <NaturalVegetation />
        <Latitude>-48.48</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
      </SoluteManager>
      <Report>
        <Name>Report</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today</string>
          <string>[Ryegrass].AboveGroundWt</string>
          <string>[Ryegrass].HarvestableWt</string>
          <string>[WhiteClover].AboveGroundWt</string>
          <string>[WhiteClover].HarvestableWt</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].EndOfDay</string>
        </EventNames>
      </Report>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Area>1</Area>
      <Slope>0</Slope>
    </Zone>
    <Graph>
      <Name>Biomass</Name>
      <Series>
        <Name>Series1</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Type>Scatter</Type>
        <XAxis>Bottom</XAxis>
        <YAxis>Left</YAxis>
        <ColourArgb>-16777216</ColourArgb>
        <FactorIndexToVaryColours>0</FactorIndexToVaryColours>
        <FactorIndexToVaryMarkers>-1</FactorIndexToVaryMarkers>
        <FactorIndexToVaryLines>-1</FactorIndexToVaryLines>
        <Marker>None</Marker>
        <MarkerSize>Normal</MarkerSize>
        <Line>Solid</Line>
        <LineThickness>Normal</LineThickness>
        <Checkpoint>Current</Checkpoint>
        <TableName>Report</TableName>
        <XFieldName>Clock.Today</XFieldName>
        <YFieldName>Ryegrass.AboveGroundWt</YFieldName>
        <ShowInLegend>true</ShowInLegend>
        <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
        <Cumulative>false</Cumulative>
        <CumulativeX>false</CumulativeX>
      </Series>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Axis>
        <Type>Bottom</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <Axis>
        <Type>Left</Type>
        <Title />
        <Inverted>false</Inverted>
        <Minimum>NaN</Minimum>
        <Maximum>NaN</Maximum>
        <Interval>NaN</Interval>
      </Axis>
      <LegendPosition>TopLeft</LegendPosition>
      <DisabledSeries />
    </Graph>
    <IncludeInDocumentation>true</IncludeInDocumentation>
  </Simulation>
  <Folder>
    <Name>Folder</Name>
    <PastureSpecies>
      <Name>WhiteClover</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <MaximumNUptake>10</MaximumNUptake>
      <Albedo>0.26</Albedo>
      <Gsmax>0.011</Gsmax>
      <R50>200</R50>
      <SpeciesFamily>Legume</SpeciesFamily>
      <PhotosyntheticPathway>C3</PhotosyntheticPathway>
      <InitialShootDM>500</InitialShootDM>
      <InitialRootDM>150</InitialRootDM>
      <InitialRootDepth>350</InitialRootDepth>
      <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
      <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
      <GrowthTminimum>2</GrowthTminimum>
      <GrowthToptimum>22</GrowthToptimum>
      <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
      <UseHeatStressFactor>yes</UseHeatStressFactor>
      <HeatOnsetTemperature>30</HeatOnsetTemperature>
      <HeatFullTemperature>36</HeatFullTemperature>
      <HeatRecoverySumDD>20</HeatRecoverySumDD>
      <HeatRecoveryTReference>25</HeatRecoveryTReference>
      <UseColdStressFactor>yes</UseColdStressFactor>
      <ColdOnsetTemperature>2</ColdOnsetTemperature>
      <ColdFullTemperature>-5</ColdFullTemperature>
      <ColdRecoverySumDD>30</ColdRecoverySumDD>
      <ColdRecoveryTReference>0</ColdRecoveryTReference>
      <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
      <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
      <RespirationTReference>20</RespirationTReference>
      <RespirationExponent>1.5</RespirationExponent>
      <NThresholdsForLeaves>
        <double>0.045</double>
        <double>0.02</double>
        <double>0.055</double>
      </NThresholdsForLeaves>
      <NThresholdsForStems>
        <double>0.0225</double>
        <double>0.01</double>
        <double>0.0275</double>
      </NThresholdsForStems>
      <NThresholdsForStolons>
        <double>0.0225</double>
        <double>0.01</double>
        <double>0.0275</double>
      </NThresholdsForStolons>
      <NThresholdsForRoots>
        <double>0.0225</double>
        <double>0.01</double>
        <double>0.0275</double>
      </NThresholdsForRoots>
      <DegreesDayForGermination>125</DegreesDayForGermination>
      <TargetShootRootRatio>4</TargetShootRootRatio>
      <MaxRootAllocation>0.25</MaxRootAllocation>
      <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
      <UseReproSeasonFactor>yes</UseReproSeasonFactor>
      <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
      <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
      <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
      <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
      <FractionLeafMaximum>0.56</FractionLeafMaximum>
      <FractionLeafMinimum>0.28</FractionLeafMinimum>
      <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
      <FractionLeafDMFactor>2000</FractionLeafDMFactor>
      <FractionLeafExponent>3</FractionLeafExponent>
      <FractionToStolon>0.2</FractionToStolon>
      <SpecificLeafArea>30</SpecificLeafArea>
      <SpecificRootLength>45</SpecificRootLength>
      <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
      <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
      <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
      <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
      <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
      <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
      <DetachmentRateShoot>0.11</DetachmentRateShoot>
      <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
      <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
      <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
      <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
      <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
      <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
      <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
      <FractionNLuxuryRemobilisable>
        <double>0.1</double>
        <double>0.1</double>
        <double>0.1</double>
      </FractionNLuxuryRemobilisable>
      <MinimumNFixation>0.2</MinimumNFixation>
      <MaximumNFixation>0.6</MaximumNFixation>
      <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
      <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
      <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
      <NDillutionCoefficient>1</NDillutionCoefficient>
      <GlfGeneric>1</GlfGeneric>
      <GlfSoilFertility>1</GlfSoilFertility>
      <PlantHeightMinimum>25</PlantHeightMinimum>
      <PlantHeightMaximum>350</PlantHeightMaximum>
      <PlantHeightMassForMax>7500</PlantHeightMassForMax>
      <PlantHeightExponent>2.5</PlantHeightExponent>
      <RootDepthMinimum>30</RootDepthMinimum>
      <RootDepthMaximum>350</RootDepthMaximum>
      <RootElongationRate>25</RootElongationRate>
      <RootDistributionDepthParam>70</RootDistributionDepthParam>
      <RootDistributionExponent>2.5</RootDistributionExponent>
      <DigestibilitiesCellWall>
        <double>0.6</double>
        <double>0.6</double>
        <double>0.6</double>
        <double>0.2</double>
      </DigestibilitiesCellWall>
      <MinimumGreenWt>50</MinimumGreenWt>
      <FractionStolonStanding>0</FractionStolonStanding>
      <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
      <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
      <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
      <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
    </PastureSpecies>
    <Manager>
      <Name>Ex_TargetRotationLength_store</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Script>
        <DoVerbose>False</DoVerbose>
        <StockingRate>4</StockingRate>
        <InitLocation>Paddock00</InitLocation>
        <TargetRotationLength>6</TargetRotationLength>
        <HarvestExcessHerbage>True</HarvestExcessHerbage>
        <NumCows>3</NumCows>
        <CurrentLocation>
        </CurrentLocation>
        <CurrentLocationNum>0</CurrentLocationNum>
        <NumPaddocks>0</NumPaddocks>
        <FarmArea>0</FarmArea>
      </Script>
      <Code><![CDATA[using System;
using Models.Core;
using Models.Utilities;
using Models.GrazPlan;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;
using Models.PMF;
using Models.Soils;
using System.Collections;
using System.Collections.Generic;
using Models.AgPasture;
using System.Diagnostics;

namespace Models
{

	[Serializable]
	public class Script : Model
	{
		[Link] Clock Clock;
		[Link] Stock Cows;
		[Link] Supplement Feed;
		[Link] Zone[] Paddocks;
		[Link] ISummary summary = null;

		//List<AgPasture.PastureSpecies> Pasture = new List<AgPasture.PastureSpecies>();

		class PlantWeight
		{
			public string paddockName;
			public double totalWt;
		}

		[Description("Do verbose reporting from this script (tick for yes): ")] public bool DoVerbose { get; set; }

		[Description("Whole-farm stocking rate (head/ha): ")] public double StockingRate { get; set; }
		[Description("Initial location of the cows (paddock name): ")] public string InitLocation { get; set; }
		// move more cow stuff to the interface

		[Description("Target rotation length (days/paddock): ")] public int TargetRotationLength { get; set; }
		//[Description("Target grazing residual (kgDM/ha): ")] public double TargetGrazingResidual { get; set; }
		[Description("Harvest excess herbage? (days): ")] public bool HarvestExcessHerbage { get; set; }


		public int NumCows { get; set; } // number of cows on the whole farm
		public string CurrentLocation { get; set; }  // name of the paddock that the cows are currently in
		public int CurrentLocationNum { get; set; }  // name of the paddock that the cows are currently in
		public int NumPaddocks { get; set; }
		public double FarmArea { get; set; }

		private int group_count; // how many groups are there in the simulation
		private int g = 1;		// index to the groups of animals

		//private int DaysPerPaddock;
		private int DaysInThisPaddock;

		public event BiomassRemovedDelegate BiomassRemoved;


		[EventSubscribe("StartOfSimulation")]
		private void OnStartOfSimulation(object sender, EventArgs e)
		{
			SetInitialCowStuff();
			Cows.Move(g, InitLocation);
			CurrentLocation = InitLocation;

			summary.WriteMessage(this, "Initialising the paddocks information");
			NumPaddocks = 0;
			FarmArea = 0.0;
			foreach (Zone paddock in Paddocks)
			{
				NumPaddocks += 1;
				FarmArea += paddock.Area;
   				summary.WriteMessage(this, "     Paddock " + NumPaddocks + " has an area of " + paddock.Area);
			}
			//DaysPerPaddock = (int) (Math.Round((float) TargetRotationLength / (float) NumPaddocks, 0));
			DaysInThisPaddock = -1;

			NumCows = (int) (Math.Round((float) StockingRate * (float) FarmArea, 0));
			summary.WriteMessage(this, "     The number of animals has been rounded to " + NumCows + " from " + (StockingRate * FarmArea));
			summary.WriteMessage(this, "The area of the whole farm is " + FarmArea);


		}
                                
		[EventSubscribe("DoManagement")]
		private void OnDoManagement(object sender, EventArgs e)
		{
		    // how many days in this paddock?  Ready to move?

		    DaysInThisPaddock += 1;
			List<PlantWeight> plantWeights = new List<PlantWeight>();

		    			// get a list of the paddocks and sort into order of decreasing Sward.HarvestableWt
				foreach (Zone paddock in Paddocks)
				{
					PlantWeight weight = new PlantWeight();
					weight.paddockName = paddock.Name;
					foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
					{
						weight.totalWt += plant.AboveGroundWt;
						if (DoVerbose)
							summary.WriteMessage(this, "In " + paddock.Name + " there is " + weight.totalWt + " kg DM /ha of " + plant.Name);
					}
					plantWeights.Add(weight);
		    }

		    if (DaysInThisPaddock >= TargetRotationLength)
		    {
				/*plantWeights.Sort((y, x) => x.totalWt.CompareTo(y.totalWt));
				for (int ii = 0; ii < NumPaddocks; ii++)
				{
				   if (DoVerbose)
				   	summary.WriteMessage(this, ii + " " + plantWeights[ii].paddockName + " " + plantWeights[ii].totalWt);
				}*/

				//Debugger.Break();
				Cows.Move(g, plantWeights[0].paddockName);  // "0" is because the list is sorted in descending order (but don't ask me to explain why!)
				CurrentLocation = plantWeights[0].paddockName;
				summary.WriteMessage(this, "moving to " + plantWeights[0].paddockName);
				//double CurrentTotalWt = plantWeights[0].totalWt;

		       // move to the next paddock
				DaysInThisPaddock = 0;
		    				}

                        /*
            // total harvested is equal total defoliated, for now
            HarvestedWt = DefoliatedWt;
            HarvestedN = DefoliatedN;  */

        	     	     	     	 
			// get the type of amount given
			/*if (RemoveAmountType == removeAmountTypes.ResidualDM)
                amountType = "SetResidueAmount";
            else
                amountType = "SetRemoveAmount"; */


			if (Cows.NumberAll > 0)
			{
				Feed.Feed("Silage", 15.0 * Cows.NumberAll, CurrentLocation);
				// remove some biomass

			    foreach (Zone paddock in Paddocks)
	    		{
		        	if (paddock.Name == CurrentLocation)
					{
						foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
						{
							//Debugger.Break();
							double amountToRemove = (15.0 * Cows.NumberAll) * (plant.AboveGroundWt /  plantWeights[0].totalWt);
							if (amountToRemove >= plant.HarvestableWt)
							{
								if (DoVerbose)
									summary.WriteMessage(this, "not enough plant for the animal demand");
								amountToRemove = plant.HarvestableWt;
							}
							else
							{
							//double propToRemove = plant.AboveGroundWt /  plantWeights[0].totalWt;
							plant.Graze(amount: amountToRemove, type: "SetRemoveAmount");
							//DefoliatedWt += species.HarvestedWt;
							//DefoliatedN += species.HarvestedN;
							}
						}
					}
				}
			}
		}


		public void SetInitialCowStuff()
		{
			g = Cows.NoGroups + 1;

			StockBuy purchase = new StockBuy();
			purchase.Genotype = "Friesian";
			purchase.Number = NumCows;
			purchase.Sex = "heifers"; 
			purchase.Age = 24;       // age in months
			purchase.Weight = 550.0;  // live weight in kg
			purchase.UseTag = g + 1;
			purchase.MatedTo = "Friesian";
			purchase.Pregnant = 0;  // days pregnant, 0 = non pregnant, 1 = pregnant
			purchase.Lactating = 1;  // 0 for dry, 1 for lactating
			purchase.NumYoung = 2;
			purchase.YoungWt = 45;
                
			Cows.Buy(purchase);
		}

	}
}
]]></Code>
    </Manager>
    <Manager>
      <Name>Ex_TargetRotationLength</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Script>
        <DoVerbose>False</DoVerbose>
        <StockingRate>4</StockingRate>
        <InitLocation>Paddock00</InitLocation>
        <TargetRotationLength>6</TargetRotationLength>
        <HarvestExcessHerbage>True</HarvestExcessHerbage>
        <NumCows>3</NumCows>
        <CurrentLocation>
        </CurrentLocation>
        <CurrentLocationNum>0</CurrentLocationNum>
        <NumPaddocks>0</NumPaddocks>
        <FarmArea>0</FarmArea>
      </Script>
      <Code><![CDATA[using System;
using Models.Core;
using Models.Utilities;
using Models.GrazPlan;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;
using Models.PMF;
using Models.Soils;
using System.Collections;
using System.Collections.Generic;
using Models.AgPasture;
using System.Diagnostics;

namespace Models
{

	[Serializable]
	public class Script : Model
	{
		[Link] Clock Clock;
		[Link] Stock Cows;
		[Link] Supplement Feed;
		[Link] Zone[] Paddocks;
		[Link] ISummary summary = null;

		//List<AgPasture.PastureSpecies> Pasture = new List<AgPasture.PastureSpecies>();

		[Serializable]
		public class PaddockInfo
		{
			public string paddockName;
			public double totalWt;
			public int paddockNum;
		}

		[Description("Do verbose reporting from this script (tick for yes): ")] public bool DoVerbose { get; set; }

		[Description("Whole-farm stocking rate (head/ha): ")] public double StockingRate { get; set; }
		[Description("Initial location of the cows (paddock name): ")] public string InitLocation { get; set; }
		// move more cow stuff to the interface

		[Description("Target rotation length (days/paddock): ")] public int TargetRotationLength { get; set; }
		//[Description("Target grazing residual (kgDM/ha): ")] public double TargetGrazingResidual { get; set; }
		[Description("Harvest excess herbage? (days): ")] public bool HarvestExcessHerbage { get; set; }


		public int NumCows { get; set; } // number of cows on the whole farm
		public string CurrentLocation { get; set; }  // name of the paddock that the cows are currently in
		public int CurrentLocationNum { get; set; }  // name of the paddock that the cows are currently in
		public int NumPaddocks { get; set; }
		public double FarmArea { get; set; }

		private int group_count; // how many groups are there in the simulation
		private int g = 1;		// index to the groups of animals

		//private int DaysPerPaddock;
		private int DaysInThisPaddock;

		public event BiomassRemovedDelegate BiomassRemoved;
		List<PaddockInfo> listOfPaddockInfo = new List<PaddockInfo>();


		[EventSubscribe("StartOfSimulation")]
		private void OnStartOfSimulation(object sender, EventArgs e)
		{
			//SetInitialCowStuff();
			//Cows.Move(g, InitLocation);
			//CurrentLocation = InitLocation;
			//CurrentLocationNum = 0;

			/*summary.WriteMessage(this, "Initialising the paddocks information");
			NumPaddocks = 0;
			FarmArea = 0.0;
			foreach (Zone paddock in Paddocks)
			{
				NumPaddocks += 1;
				FarmArea += paddock.Area;
				if (paddock.Name == "InitLocation")
					CurrentLocationNum = NumPaddocks;
   				summary.WriteMessage(this, "     Paddock " + NumPaddocks + " has an area of " + paddock.Area);
			}
			DaysInThisPaddock = -1;

			NumCows = (int) (Math.Round((float) StockingRate * (float) FarmArea, 0));
			summary.WriteMessage(this, "     The number of animals has been rounded to " + NumCows + " from " + (StockingRate * FarmArea));
			summary.WriteMessage(this, "The area of the whole farm is " + FarmArea);

			*/

		    /*// get a list of information about the paddocks 
				foreach (Zone paddock in Paddocks)
				{
					PaddockInfo paddockInfo = new PaddockInfo();
					paddockInfo.paddockName = paddock.Name;
					foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
					{
						paddockInfo.totalWt += plant.AboveGroundWt;
						if (DoVerbose)
							summary.WriteMessage(this, "In " + paddock.Name + " there is " + paddockInfo.totalWt + " kg DM /ha of " + plant.Name);
					}
				listOfPaddockInfo.Add(paddockInfo);
		    }*/


		}
                                
		[EventSubscribe("DoManagement")]
		private void OnDoManagement(object sender, EventArgs e)
		{
		   /* // how many days in this paddock?  Ready to move?
		    DaysInThisPaddock += 1;
		    if (DaysInThisPaddock >= TargetRotationLength)
		    {
				Cows.Move(g, listOfPaddockInfo[0].paddockName);  // "0" is because the list is sorted in descending order (but don't ask me to explain why!)
				CurrentLocation = listOfPaddockInfo[0].paddockName;
				summary.WriteMessage(this, "moving to " + listOfPaddockInfo[0].paddockName);
				DaysInThisPaddock = 0;
		    }*/

                        /*
            // total harvested is equal total defoliated, for now
            HarvestedWt = DefoliatedWt;
            HarvestedN = DefoliatedN;  */

        	     	     	     	 
			// get the type of amount given
			/*if (RemoveAmountType == removeAmountTypes.ResidualDM)
                amountType = "SetResidueAmount";
            else
                amountType = "SetRemoveAmount"; */


			/*if (Cows.NumberAll > 0)
			{
				Feed.Feed("Silage", 15.0 * Cows.NumberAll, CurrentLocation);
				// remove some biomass

			    foreach (Zone paddock in Paddocks)
	    		{
		        	if (paddock.Name == CurrentLocation)
					{
						foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
						{
							//Debugger.Break();
							double amountToRemove = (15.0 * Cows.NumberAll) * (plant.AboveGroundWt /  plantWeights[0].totalWt);
							if (amountToRemove >= plant.HarvestableWt)
							{
								if (DoVerbose)
									summary.WriteMessage(this, "not enough plant for the animal demand");
								amountToRemove = plant.HarvestableWt;
							}
							else
							{
							//double propToRemove = plant.AboveGroundWt /  plantWeights[0].totalWt;
							plant.Graze(amount: amountToRemove, type: "SetRemoveAmount");
							//DefoliatedWt += species.HarvestedWt;
							//DefoliatedN += species.HarvestedN;
							}
						}
					}
				}
			} */
		}


		public void SetInitialCowStuff()
		{
			/*g = Cows.NoGroups + 1;

			StockBuy purchase = new StockBuy();
			purchase.Genotype = "Friesian";
			purchase.Number = NumCows;
			purchase.Sex = "heifers"; 
			purchase.Age = 24;       // age in months
			purchase.Weight = 550.0;  // live weight in kg
			purchase.UseTag = g + 1;
			purchase.MatedTo = "Friesian";
			purchase.Pregnant = 0;  // days pregnant, 0 = non pregnant, 1 = pregnant
			purchase.Lactating = 1;  // 0 for dry, 1 for lactating
			purchase.NumYoung = 2;
			purchase.YoungWt = 45;
                
			Cows.Buy(purchase); */
		}

	}
}
]]></Code>
    </Manager>
    <Report>
      <Name>ReportTop</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <ExperimentFactorNames />
      <ExperimentFactorValues />
      <VariableNames>
        <string>[Clock].Today</string>
        <string>[Ex_TargetRotationLength].Script.CurrentLocation</string>
        <string>[Ex_TargetRotationLength].Script.CurrentLocation</string>
        <string />
        <string>//[Stock].NumberAll</string>
        <string>[Stock].WeightAll</string>
        <string>[Stock].CondScoreAll</string>
        <string>[Stock].IntakeAll.Weight</string>
        <string>[Stock].IntakeAll.N</string>
        <string>[Stock].UrineNAll</string>
        <string>[Stock].FaecesAll.N</string>
        <string>[Stock].MilkWtAll</string>
        <string>[Supplement].stores[2].Name</string>
        <string>[Supplement].stores[2].Stored</string>
      </VariableNames>
      <EventNames>
        <string>[Clock].EndOfDay</string>
      </EventNames>
    </Report>
    <IncludeInDocumentation>true</IncludeInDocumentation>
    <ShowPageOfGraphs>true</ShowPageOfGraphs>
  </Folder>
  <DataStore>
    <Name>DataStore</Name>
    <IncludeInDocumentation>true</IncludeInDocumentation>
  </DataStore>
  <IncludeInDocumentation>true</IncludeInDocumentation>
  <ExplorerWidth>300</ExplorerWidth>
</Simulations>